"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4995],{34995:(e,o,s)=>{s.r(o),s.d(o,{CoreCoursesDashboardLazyModule:()=>E});var a=s(67643),n=s(13386),r=s(94283),t=s(49671),i=s(92974),l=s(98370),c=s(53564),d=s(62693),u=s(13010),b=s(10217),_=s(43555),h=s(58540),p=s(88817),C=s(43468),g=s(10727),f=s(75803),m=s(19212),k=s(96814),D=s(55126),y=s(66931),B=s(78308),I=s(86700),v=s(29657),x=s(22068),w=s(31903),T=s(44202),S=s(89515);function CoreCoursesDashboardPage_ion_button_1_Template(e,o){if(1&e){const e=m.EpF();m.TgZ(0,"ion-button",8),m.NdJ("click",(function CoreCoursesDashboardPage_ion_button_1_Template_ion_button_click_0_listener(){m.CHM(e);const o=m.oxw();return m.KtG(o.openSearch())})),m.ALo(1,"translate"),m._UZ(2,"ion-icon",9),m.qZA()}2&e&&m.uIk("aria-label",m.lcZ(1,1,"core.courses.searchcourses"))}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template(e,o){if(1&e&&m._UZ(0,"core-block",13),2&e){const e=m.oxw().$implicit,o=m.oxw(2);m.Q6J("block",e)("instanceId",o.userId)}}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template(e,o){if(1&e&&(m.ynx(0),m.YNc(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template,1,2,"core-block",12),m.BQk()),2&e){const e=o.$implicit;m.xp6(),m.Q6J("ngIf",e.visible)}}function CoreCoursesDashboardPage_ion_list_7_Template(e,o){if(1&e&&(m.TgZ(0,"ion-list",10),m.YNc(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template,2,1,"ng-container",11),m.qZA()),2&e){const e=m.oxw();m.xp6(),m.Q6J("ngForOf",e.blocks)}}function CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template(e,o){if(1&e&&m._UZ(0,"core-block-side-blocks-button",14),2&e){const e=m.oxw();m.Q6J("instanceId",e.userId)}}function CoreCoursesDashboardPage_core_empty_box_9_Template(e,o){1&e&&(m._UZ(0,"core-empty-box",15),m.ALo(1,"translate")),2&e&&m.Q6J("message",m.lcZ(1,1,"core.course.nocontentavailable"))}let P=(()=>{var e;class CoreCoursesDashboardPage{constructor(){this.hasMainBlocks=!1,this.hasSideBlocks=!1,this.searchEnabled=!1,this.downloadCourseEnabled=!1,this.downloadCoursesEnabled=!1,this.blocks=[],this.loaded=!1,this.updateSiteObserver=l.R.on(l.R.SITE_UPDATED,(()=>{this.searchEnabled=!i.B.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.B.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.B.isDownloadCoursesDisabledInSite()}),c.m9.getCurrentSiteId()),this.logView=p.V.once((0,t.Z)((function*(){yield f.Tr.ignoreErrors(i.B.logView("dashboard")),C.ke.logEvent({type:C.gM.VIEW_ITEM,ws:"core_my_view_page",name:g.vN.instant("core.courses.mymoodle"),data:{category:"course",page:"dashboard"},url:"/my/"})})))}ngOnInit(){this.searchEnabled=!i.B.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.B.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.B.isDownloadCoursesDisabledInSite(),this.loadContent()}loadContent(){var e=this;return(0,t.Z)((function*(){const o=yield d.s.isAvailable(),s=yield d.s.isDisabled();if(o&&!s){e.userId=c.m9.getCurrentSiteUserId();try{const o=yield d.s.getDashboardBlocks();e.blocks=o.mainBlocks,e.hasMainBlocks=h.a.hasSupportedBlock(o.mainBlocks),e.hasSideBlocks=h.a.hasSupportedBlock(o.sideBlocks)}catch(o){u.OQ.showErrorModal(o),e.loadFallbackBlocks()}}else o?e.blocks=[]:e.loadFallbackBlocks();e.loaded=!0,e.logView()}))()}loadFallbackBlocks(){this.blocks=[{name:"myoverview",visible:!0},{name:"timeline",visible:!0}],this.hasMainBlocks=h.a.isBlockSupported("myoverview")||h.a.isBlockSupported("timeline")}refreshDashboard(e){var o;const s=[];s.push(d.s.invalidateDashboardBlocks()),null===(o=this.blocksComponents)||void 0===o||o.forEach((e=>{s.push(e.invalidate().catch((()=>{})))})),Promise.all(s).finally((()=>{this.loadContent().finally((()=>{null==e||e.complete()}))}))}openSearch(){return(0,t.Z)((function*(){_.b.navigateToSitePath("/courses/list",{params:{mode:"search"}})}))()}ngOnDestroy(){this.updateSiteObserver.off()}}return(e=CoreCoursesDashboardPage).ɵfac=function CoreCoursesDashboardPage_Factory(o){return new(o||e)},e.ɵcmp=m.Xpm({type:e,selectors:[["page-core-courses-dashboard"]],viewQuery:function CoreCoursesDashboardPage_Query(e,o){if(1&e&&m.Gf(b.x,5),2&e){let e;m.iGM(e=m.CRH())&&(o.blocksComponents=e)}},decls:10,vars:9,consts:[["slot","end","prepend",""],[3,"click",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","list-item-limited-width",4,"ngIf"],["slot","fixed","contextLevel","user",3,"instanceId",4,"ngIf"],["icon","fas-cubes",3,"message",4,"ngIf"],[3,"click"],["name","fas-magnifying-glass","slot","icon-only","aria-hidden","true"],[1,"list-item-limited-width"],[4,"ngFor","ngForOf"],["contextLevel","user",3,"block","instanceId",4,"ngIf"],["contextLevel","user",3,"block","instanceId"],["slot","fixed","contextLevel","user",3,"instanceId"],["icon","fas-cubes",3,"message"]],template:function CoreCoursesDashboardPage_Template(e,o){1&e&&(m.TgZ(0,"core-navbar-buttons",0),m.YNc(1,CoreCoursesDashboardPage_ion_button_1_Template,3,3,"ion-button",1),m.qZA(),m.TgZ(2,"ion-content")(3,"ion-refresher",2),m.NdJ("ionRefresh",(function CoreCoursesDashboardPage_Template_ion_refresher_ionRefresh_3_listener(e){return o.refreshDashboard(e.target)})),m._UZ(4,"ion-refresher-content",3),m.ALo(5,"translate"),m.qZA(),m.TgZ(6,"core-loading",4),m.YNc(7,CoreCoursesDashboardPage_ion_list_7_Template,2,1,"ion-list",5)(8,CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template,1,1,"core-block-side-blocks-button",6)(9,CoreCoursesDashboardPage_core_empty_box_9_Template,2,3,"core-empty-box",7),m.qZA()()),2&e&&(m.xp6(),m.Q6J("ngIf",o.searchEnabled),m.xp6(2),m.Q6J("disabled",!o.loaded),m.xp6(),m.s9C("pullingText",m.lcZ(5,7,"core.pulltorefresh")),m.xp6(2),m.Q6J("hideUntil",o.loaded),m.xp6(),m.Q6J("ngIf",o.hasMainBlocks),m.xp6(),m.Q6J("ngIf",o.hasSideBlocks),m.xp6(),m.Q6J("ngIf",!o.hasMainBlocks))},dependencies:[k.sg,k.O5,D.z,y.r,B.J,I.I,v.t,x.O,w.YG,w.W2,w.gu,w.q_,w.nJ,w.Wo,b.x,T.R,S.X$],encapsulation:2}),CoreCoursesDashboardPage})();const Z=[{path:"",component:P}];let E=(()=>{var e;class CoreCoursesDashboardLazyModule{}return(e=CoreCoursesDashboardLazyModule).ɵfac=function CoreCoursesDashboardLazyModule_Factory(o){return new(o||e)},e.ɵmod=m.oAB({type:e}),e.ɵinj=m.cJS({imports:[a.Bz.forChild(Z),n.L,r.X,a.Bz]}),CoreCoursesDashboardLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&m.kYT(E,{declarations:[P],imports:[a.Bz,n.L,r.X],exports:[a.Bz]}))}}]);