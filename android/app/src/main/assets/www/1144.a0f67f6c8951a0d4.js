"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1144],{71144:(e,o,t)=>{t.r(o),t.d(o,{CoreCoursesMyLazyModule:()=>L});var r=t(67643),s=t(13386),a=t(94283),n=t(56283),i=t(49671),l=t(98500),c=t(90284),d=t(10217),u=t(58540),g=t(62693),_=t(52467),m=t(53564),y=t(13010),p=t(75803),b=t(98370),v=t(92974),C=t(88817),h=t(43468),f=t(10727),k=t(19212),x=t(96814),M=t(55126),w=t(66931),B=t(86700),P=t(8947),T=t(29657),Z=t(22068),I=t(31903),O=t(44202),S=t(83431),A=t(89515);function CoreCoursesMyPage_div_22_ion_button_1_Template(e,o){if(1&e){const e=k.EpF();k.TgZ(0,"ion-button",19),k.NdJ("click",(function CoreCoursesMyPage_div_22_ion_button_1_Template_ion_button_click_0_listener(){k.CHM(e);const o=k.oxw(2);return k.KtG(o.myOverviewBlock.prefetchCourses())})),k.ALo(1,"translate"),k._UZ(2,"ion-icon",20),k.qZA()}if(2&e){const e=k.oxw(2);k.uIk("aria-label",k.lcZ(1,2,e.myOverviewBlock.prefetchCoursesData.statusTranslatable)),k.xp6(2),k.Q6J("name",e.myOverviewBlock.prefetchCoursesData.icon)}}function CoreCoursesMyPage_div_22_ion_badge_2_Template(e,o){if(1&e&&(k.TgZ(0,"ion-badge",21),k._uU(1),k.qZA()),2&e){const e=k.oxw(2);k.uIk("aria-valuemax",e.myOverviewBlock.prefetchCoursesData.total)("aria-valuenow",e.myOverviewBlock.prefetchCoursesData.count)("aria-valuetext",e.myOverviewBlock.prefetchCoursesData.badgeA11yText),k.xp6(),k.hij(" ",e.myOverviewBlock.prefetchCoursesData.badge," ")}}function CoreCoursesMyPage_div_22_ion_spinner_3_Template(e,o){1&e&&(k._UZ(0,"ion-spinner"),k.ALo(1,"translate")),2&e&&k.uIk("aria-label",k.lcZ(1,1,"core.loading"))}function CoreCoursesMyPage_div_22_Template(e,o){if(1&e&&(k.TgZ(0,"div",15),k.YNc(1,CoreCoursesMyPage_div_22_ion_button_1_Template,3,4,"ion-button",16)(2,CoreCoursesMyPage_div_22_ion_badge_2_Template,2,4,"ion-badge",17)(3,CoreCoursesMyPage_div_22_ion_spinner_3_Template,2,3,"ion-spinner",18),k.qZA()),2&e){const e=k.oxw();k.xp6(),k.Q6J("ngIf",!e.myOverviewBlock.prefetchCoursesData.loading),k.xp6(),k.Q6J("ngIf",e.myOverviewBlock.prefetchCoursesData.badge),k.xp6(),k.Q6J("ngIf",e.myOverviewBlock.prefetchCoursesData.loading)}}function CoreCoursesMyPage_core_block_24_Template(e,o){if(1&e&&k._UZ(0,"core-block",22),2&e){const e=k.oxw();k.Q6J("block",e.loadedBlock)("instanceId",e.userId)}}function CoreCoursesMyPage_core_block_side_blocks_button_25_Template(e,o){if(1&e&&k._UZ(0,"core-block-side-blocks-button",23),2&e){const e=k.oxw();k.Q6J("instanceId",e.userId)("myDashboardPage",e.myPageCourses)}}function CoreCoursesMyPage_core_empty_box_26_Template(e,o){1&e&&(k._UZ(0,"core-empty-box",24),k.ALo(1,"translate")),2&e&&k.Q6J("message",k.lcZ(1,1,"core.course.nocontentavailable"))}let D=(()=>{var e;class CoreCoursesMyPage{constructor(e){var o=this;this.loadsManager=e,this.siteName="",this.downloadCoursesEnabled=!1,this.loaded=!1,this.myPageCourses=g.W.MY_PAGE_COURSES,this.hasSideBlocks=!1,this.onReadyPromise=new c.b,this.updateSiteObserver=b.R.on(b.R.SITE_UPDATED,(0,i.Z)((function*(){o.downloadCoursesEnabled=!v.B.isDownloadCoursesDisabledInSite(),yield o.loadSiteName()})),m.m9.getCurrentSiteId()),this.userId=m.m9.getCurrentSiteUserId(),this.loadsManagerSubscription=this.loadsManager.onRefreshPage.subscribe((()=>{this.loaded=!1,this.loadContent()})),this.logView=C.V.once((0,i.Z)((function*(){yield p.Tr.ignoreErrors(v.B.logView("my")),h.ke.logEvent({type:h.gM.VIEW_ITEM,ws:"core_my_view_page",name:f.vN.instant("core.courses.mycourses"),data:{category:"course",page:"my"},url:"/my/courses.php"})})))}ngOnInit(){var e=this;return(0,i.Z)((function*(){e.downloadCoursesEnabled=!v.B.isDownloadCoursesDisabledInSite();(new _.L).treatLink(),yield e.loadSiteName(),e.loadContent(!0)}))()}loadContent(e=!1){var o=this;return(0,i.Z)((function*(){var t;const r=o.loadsManager.startPageLoad(o,!!e),s=yield g.s.isAvailable(),a=yield v.B.isMyCoursesDisabled(),n=!(null===(t=m.m9.getCurrentSite())||void 0===t||!t.isVersionGreaterEqualThan("4.0"));if(s&&!a)try{var i;const e=yield r.watchRequest(g.s.getDashboardBlocksObservable({myPage:n?o.myPageCourses:void 0,readingStrategy:r.getReadingStrategy()}));o.loadedBlock=e.mainBlocks.concat(e.sideBlocks).find((e=>"myoverview"==e.name)),o.hasSideBlocks=n&&u.a.hasSupportedBlock(e.sideBlocks),yield p.Tr.nextTicks(2),o.myOverviewBlock=null===(i=o.block)||void 0===i||null===(i=i.dynamicComponent)||void 0===i?void 0:i.instance,o.loadedBlock||n||o.loadFallbackBlock()}catch(e){y.OQ.showErrorModal(e),o.loadFallbackBlock()}else s?o.loadedBlock=void 0:o.loadFallbackBlock();o.loaded=!0,o.onReadyPromise.resolve(),o.logView()}))()}loadSiteName(){var e=this;return(0,i.Z)((function*(){const o=m.m9.getRequiredCurrentSite();e.siteName=(yield o.getSiteName())||""}))()}loadFallbackBlock(){this.loadedBlock={name:"myoverview",visible:!0}}refresh(e){var o=this;return(0,i.Z)((function*(){const t=[];t.push(g.s.invalidateDashboardBlocks(g.W.MY_PAGE_COURSES)),o.myOverviewBlock&&t.push(p.Tr.ignoreErrors(o.myOverviewBlock.invalidateContent())),Promise.all(t).finally((()=>{o.loadContent().finally((()=>{null==e||e.complete()}))}))}))()}ngOnDestroy(){var e;null===(e=this.updateSiteObserver)||void 0===e||e.off(),this.loadsManagerSubscription.unsubscribe()}ready(){var e=this;return(0,i.Z)((function*(){return yield e.onReadyPromise}))()}}return(e=CoreCoursesMyPage).ɵfac=function CoreCoursesMyPage_Factory(o){return new(o||e)(k.Y36(l.T))},e.ɵcmp=k.Xpm({type:e,selectors:[["page-core-courses-my"]],viewQuery:function CoreCoursesMyPage_Query(e,o){if(1&e&&k.Gf(d.x,5),2&e){let e;k.iGM(e=k.CRH())&&(o.block=e.first)}},features:[k._Bn([{provide:l.T,useClass:l.T}])],decls:27,vars:18,consts:[["slot","start"],[3,"text"],["contextLevel","system",1,"core-header-sitename",3,"text","contextInstanceId"],["src","assets/img/top_logo.png",1,"core-header-logo",3,"alt"],["slot","end"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-text-wrap","divider"],["id","core-courses-my-title",1,"big"],["slot","end",1,"flex-row"],["class","core-button-spinner",4,"ngIf"],["contextLevel","user","labelledBy","core-courses-my-title",3,"block","instanceId",4,"ngIf"],["slot","fixed","contextLevel","user",3,"instanceId","myDashboardPage",4,"ngIf"],["icon","fas-cubes",3,"message",4,"ngIf"],[1,"core-button-spinner"],["fill","clear",3,"click",4,"ngIf"],["class","core-course-download-courses-progress","role","progressbar",4,"ngIf"],[4,"ngIf"],["fill","clear",3,"click"],["slot","icon-only","aria-hidden","true",3,"name"],["role","progressbar",1,"core-course-download-courses-progress"],["contextLevel","user","labelledBy","core-courses-my-title",3,"block","instanceId"],["slot","fixed","contextLevel","user",3,"instanceId","myDashboardPage"],["icon","fas-cubes",3,"message"]],template:function CoreCoursesMyPage_Template(e,o){1&e&&(k.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),k._UZ(3,"ion-back-button",1),k.ALo(4,"translate"),k.qZA(),k.TgZ(5,"ion-title")(6,"h1"),k._UZ(7,"core-format-text",2)(8,"img",3),k.qZA()(),k.TgZ(9,"ion-buttons",4),k._UZ(10,"core-user-menu-button"),k.qZA()()(),k.TgZ(11,"ion-content")(12,"ion-refresher",5),k.NdJ("ionRefresh",(function CoreCoursesMyPage_Template_ion_refresher_ionRefresh_12_listener(e){return o.refresh(e.target)})),k._UZ(13,"ion-refresher-content",6),k.ALo(14,"translate"),k.qZA(),k.TgZ(15,"core-loading",7)(16,"ion-item",8)(17,"ion-label")(18,"h2",9),k._uU(19),k.ALo(20,"translate"),k.qZA()(),k.TgZ(21,"div",10),k.YNc(22,CoreCoursesMyPage_div_22_Template,4,3,"div",11),k.qZA()(),k.TgZ(23,"ion-list"),k.YNc(24,CoreCoursesMyPage_core_block_24_Template,1,2,"core-block",12),k.qZA(),k.YNc(25,CoreCoursesMyPage_core_block_side_blocks_button_25_Template,1,2,"core-block-side-blocks-button",13)(26,CoreCoursesMyPage_core_empty_box_26_Template,2,3,"core-empty-box",14),k.qZA()()),2&e&&(k.xp6(3),k.Q6J("text",k.lcZ(4,12,"core.back")),k.xp6(4),k.Q6J("text",o.siteName)("contextInstanceId",0),k.xp6(),k.Q6J("alt",o.siteName),k.xp6(4),k.Q6J("disabled",!o.loaded),k.xp6(),k.s9C("pullingText",k.lcZ(14,14,"core.pulltorefresh")),k.xp6(2),k.Q6J("hideUntil",o.loaded),k.xp6(4),k.Oqu(k.lcZ(20,16,"core.courses.mycourses")),k.xp6(3),k.Q6J("ngIf",o.downloadCoursesEnabled&&o.myOverviewBlock&&o.myOverviewBlock.filteredCourses.length>0),k.xp6(2),k.Q6J("ngIf",null==o.loadedBlock?null:o.loadedBlock.visible),k.xp6(),k.Q6J("ngIf",o.hasSideBlocks),k.xp6(),k.Q6J("ngIf",!o.loadedBlock))},dependencies:[x.O5,M.z,w.r,B.I,P.r,T.t,Z.O,I.yp,I.YG,I.Sm,I.W2,I.Gu,I.gu,I.Ie,I.Q$,I.q_,I.nJ,I.Wo,I.PQ,I.wd,I.sr,I.oU,d.x,O.R,S.o,A.X$],styles:["[_nghost-%COMP%]     ion-item-divider{display:none!important}[_nghost-%COMP%]     core-loading{--internal-loading-inline-min-height: calc(100vh - var(--core-header-toolbar-height))}ion-tabs.placement-bottom[_nghost-%COMP%]     core-loading, ion-tabs.placement-bottom   [_nghost-%COMP%]     core-loading{--internal-loading-inline-min-height: calc(100vh - var(--core-header-toolbar-height) - var(--bottom-tabs-size) - 2px)}core-block[_ngcontent-%COMP%]     ion-card.addon-block-myoverview{--border-width: 0;--background: transparent;margin:0}"]}),CoreCoursesMyPage})();const J=[{path:"",component:D}];let L=(()=>{var e;class CoreCoursesMyLazyModule{}return(e=CoreCoursesMyLazyModule).ɵfac=function CoreCoursesMyLazyModule_Factory(o){return new(o||e)},e.ɵmod=k.oAB({type:e}),e.ɵinj=k.cJS({imports:[r.Bz.forChild(J),s.L,a.X,n.g,r.Bz]}),CoreCoursesMyLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&k.kYT(L,{declarations:[D],imports:[r.Bz,s.L,a.X,n.g],exports:[r.Bz]}))}}]);