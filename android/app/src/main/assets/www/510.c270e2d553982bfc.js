"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[510],{90510:(t,n,e)=>{e.r(n),e.d(n,{AddonModDataLazyModule:()=>ot});var o=e(13386),d=e(67643),a=e(24672),i=e(6274),r=e(71068),s=e(84095),c=e(90923),l=e(94379),g=e(49671),u=e(56223),p=e(31381),m=e(90030),_=e(76777),h=e(31903),f=e(95800),v=e(43555),M=e(53564),P=e(13010),C=e(40067),O=e(75803),y=e(10727),b=e(98370),I=e(3611),x=e(26027),E=e(93988),A=e(34749),w=e(88817),D=e(43468),T=e(19212),Z=e(96814),G=e(72526),L=e(66931),R=e(84631),k=e(8947),N=e(29657),F=e(22068),J=e(81782),Q=e(89515);const q=["editFormEl"];function AddonModDataEditPage_ion_button_9_Template(t,n){if(1&t){const t=T.EpF();T.TgZ(0,"ion-button",8),T.NdJ("click",(function AddonModDataEditPage_ion_button_9_Template_ion_button_click_0_listener(n){T.CHM(t);const e=T.oxw();return T.KtG(e.save(n))})),T._uU(1),T.ALo(2,"translate"),T.qZA()}2&t&&(T.xp6(),T.hij(" ",T.lcZ(2,1,"core.save")," "))}function AddonModDataEditPage_div_13_Template(t,n){if(1&t){const t=T.EpF();T.TgZ(0,"div"),T._UZ(1,"core-style",9),T.TgZ(2,"form",10,11),T.NdJ("ngSubmit",(function AddonModDataEditPage_div_13_Template_form_ngSubmit_2_listener(n){T.CHM(t);const e=T.oxw();return T.KtG(e.save(n))})),T._UZ(4,"core-compile-html",12),T.qZA()()}if(2&t){const t=T.oxw();T.Gre("addon-data-contents ",t.cssClass,""),T.xp6(),T.MGl("prefix",".",t.cssClass,""),T.Q6J("css",t.database.csstemplate),T.xp6(),T.Q6J("formGroup",t.editForm),T.xp6(2),T.Q6J("text",t.editFormRender)("jsData",t.jsData)("extraImports",t.extraImports)}}let U=(()=>{var t;class AddonModDataEditPage{constructor(){this.fieldsArray=[],this.offline=!1,this.forceLeave=!1,this.isEditing=!1,this.originalData={},this.fields={},this.moduleId=0,this.title="",this.component=I.BO.COMPONENT,this.loaded=!1,this.selectedGroup=0,this.cssClass="",this.editFormRender="",this.extraImports=[c.b],this.errors={},this.siteId=M.m9.getCurrentSiteId(),this.editForm=new u.cw({}),this.logView=w.V.once((()=>{this.database&&D.ke.logEvent({type:D.gM.VIEW_ITEM,ws:this.isEditing?"mod_data_update_entry":"mod_data_add_entry",name:this.title,data:{databaseid:this.database.id,category:"data"},url:"/mod/data/edit.php?"+(this.isEditing?`d=${this.database.id}&rid=${this.entryId}`:`id=${this.moduleId}`)})}))}ngOnInit(){try{this.moduleId=v.b.getRequiredRouteNumberParam("cmId"),this.courseId=v.b.getRequiredRouteNumberParam("courseId"),this.title=v.b.getRouteParam("title")||"",this.entryId=v.b.getRouteNumberParam("entryId")||void 0,this.selectedGroup=v.b.getRouteNumberParam("group")||0}catch(t){return P.OQ.showErrorModal(t),v.b.back(),void 0}this.isEditing=void 0!==this.entryId&&this.entryId>0,this.fetchEntryData(!0)}canLeave(){var t=this;return(0,g.Z)((function*(){if(t.forceLeave||!t.entry)return!0;const n=t.editForm.value;let e=x.a.hasEditDataChanged(n,t.fieldsArray,t.originalData);e=e||!t.isEditing&&t.initialSelectedGroup!=t.selectedGroup,e&&(yield P.OQ.showConfirm(y.vN.instant("core.confirmcanceledit")));const o=yield x.a.getEditTmpFiles(n,t.fieldsArray,t.entry.contents);return m.b.clearTmpFiles(o),C.o.triggerFormCancelledEvent(t.formElement,t.siteId),!0}))()}fetchEntryData(t=!1){var n=this;return(0,g.Z)((function*(){try{n.database=yield I.rE.getDatabase(n.courseId,n.moduleId),n.title=n.database.name||n.title,n.cssClass="addon-data-entries-"+n.database.id,n.fieldsArray=yield I.rE.getFields(n.database.id,{cmId:n.moduleId}),n.fields=O.Tr.arrayToObject(n.fieldsArray,"id");const d=yield x.a.fetchEntry(n.database,n.fieldsArray,n.entryId||0);if(n.entry=d.entry,n.originalData=O.Tr.clone(n.entry.contents),n.entryId&&(n.selectedGroup=n.entry.groupid),!n.isEditing){var e,o;let d=!1,a=n.groupInfo;if(t&&(a=yield f.t.getActivityGroupInfo(n.database.coursemodule),a.visibleGroups&&a.groups.length&&(a.groups=a.groups.filter((t=>0!==t.id)),a.defaultGroupId=a.groups[0].id),n.selectedGroup=f.t.validateGroupId(n.selectedGroup,a),n.initialSelectedGroup=n.selectedGroup),null!==(e=a)&&void 0!==e&&e.groups&&(null===(o=a)||void 0===o?void 0:o.groups.length)>0)if(t){const t={};yield Promise.all(a.groups.map(function(){var e=(0,g.Z)((function*(e){const o=yield I.rE.getDatabaseAccessInformation(n.database.id,{cmId:n.moduleId,groupId:e.id});t[e.id]=o.canaddentry}));return function(t){return e.apply(this,arguments)}}())),a.groups=a.groups.filter((n=>!!t[n.id])),d=t[n.selectedGroup]}else d=!0;else{d=(yield I.rE.getDatabaseAccessInformation(n.database.id,{cmId:n.moduleId})).canaddentry}if(n.groupInfo=a,!d)return P.OQ.showErrorModal("addon.mod_data.noaccess",!0),n.forceLeave=!0,v.b.back(),void 0}n.editFormRender=n.displayEditFields(),n.logView()}catch(t){P.OQ.showErrorModalDefault(t,"core.course.errorgetmodule",!0)}n.loaded=!0}))()}save(t){var n=this;return(0,g.Z)((function*(){t.preventDefault(),t.stopPropagation();const e=n.editForm.value;try{var o;let t=x.a.hasEditDataChanged(e,n.fieldsArray,(null===(o=n.entry)||void 0===o?void 0:o.contents)||{});if(t=t||!n.isEditing&&n.initialSelectedGroup!=n.selectedGroup,!t){if(n.entryId)return yield n.returnToEntryList(),void 0;throw new p.G(y.vN.instant("addon.mod_data.emptyaddform"))}const r=yield P.OQ.showModalLoading("core.sending",!0),s=n.entryId?n.entryId:-Date.now();let c=[];try{try{var d;c=yield x.a.getEditDataFromForm(e,n.fieldsArray,n.database.id,s,(null===(d=n.entry)||void 0===d?void 0:d.contents)||{},n.offline)}catch(t){var a;if(n.offline||O.Tr.isWebServiceError(t))throw t;n.offline=!0,c=yield x.a.getEditDataFromForm(e,n.fieldsArray,n.database.id,s,(null===(a=n.entry)||void 0===a?void 0:a.contents)||{},n.offline)}if(c.length<=0)throw new p.G(y.vN.instant("addon.mod_data.emptyaddform"));let t;if(t=n.isEditing?yield I.rE.editEntry(n.database.id,n.entryId,n.courseId,c,n.fieldsArray,n.siteId,n.offline):yield I.rE.addEntry(n.database.id,s,n.courseId,c,n.selectedGroup,n.fieldsArray,n.siteId,n.offline),n.isEditing&&"updated"in t&&t.updated||!n.isEditing&&"newentryid"in t&&t.newentryid){C.o.triggerFormSubmittedEvent(n.formElement,t.sent,n.siteId);const e=[];t.sent&&(b.R.trigger(b.R.ACTIVITY_DATA_SENT,{module:"data"}),n.isEditing&&e.push(I.rE.invalidateEntryData(n.database.id,n.entryId,n.siteId)),e.push(I.rE.invalidateEntriesData(n.database.id,n.siteId)));try{yield Promise.all(e),b.R.trigger(I.BO.ENTRY_CHANGED,{dataId:n.database.id,entryId:n.entryId},n.siteId)}finally{n.returnToEntryList()}}else{var i;n.errors={},t.fieldnotifications&&t.fieldnotifications.forEach((t=>{const e=n.fieldsArray.find((n=>n.name==t.fieldname));e&&(n.errors[e.id]=t.notification)})),n.jsData.errors=n.errors,n.scrollToFirstError(),null!==(i=t.generalnotifications)&&void 0!==i&&i.length&&P.OQ.showAlertWithOptions({header:y.vN.instant("core.notice"),message:A._1.buildMessage(t.generalnotifications),buttons:[y.vN.instant("core.ok")]})}}finally{r.dismiss()}}catch(t){P.OQ.showErrorModalDefault(t,"Cannot edit entry",!0)}}))()}setGroup(t){return this.selectedGroup=t,this.loaded=!1,this.fetchEntryData()}displayEditFields(){var t;this.jsData={fields:this.fields,contents:O.Tr.clone(null===(t=this.entry)||void 0===t?void 0:t.contents)||{},form:this.editForm,database:this.database,errors:this.errors,onFieldInit:t=>this.onFieldInit(t)};let n=x.a.getTemplate(this.database,I.$m.ADD,this.fieldsArray);this.fieldsArray.forEach((t=>{let e="[["+t.name+"]]";e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");let o=new RegExp(e,"gi");n=n.replace(o,'<addon-mod-data-field-plugin [class.has-errors]="!!errors['+t.id+']" mode="edit"                 [field]="fields['+t.id+']" [value]="contents['+t.id+']" [form]="form" [database]="database"                 [error]="errors['+t.id+']" (onFieldInit)="onFieldInit($event)"></addon-mod-data-field-plugin>'),e="[["+t.name+"#id]]",e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"),o=new RegExp(e,"gi"),n=n.replace(o,"field_"+t.id),e="[["+t.name+"#name]]",e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"),o=new RegExp(e,"gi"),n=n.replace(o,t.name),e="[["+t.name+"#description]]",e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"),o=new RegExp(e,"gi"),n=n.replace(o,t.description)}));const e=new RegExp("##otherfields##","gi");if(n.match(e)){const t=this.fieldsArray.filter((t=>!n.includes(`[field]="fields[${t.id}]`))).map((t=>`<p><strong>${t.name}</strong></p><p><addon-mod-data-field-plugin [class.has-errors]="!!errors[`+t.id+']" mode="edit"                 [field]="fields['+t.id+']" [value]="contents['+t.id+']" [form]="form" [database]="database"                 [error]="errors['+t.id+']" (onFieldInit)="onFieldInit($event)"></addon-mod-data-field-plugin><p>'));n=n.replace(e,t.join(""))}const o=new RegExp("##tags##","gi"),d=_.e.areTagsAvailableInSite()?"<p class=\"item-dimmed\">{{ 'addon.mod_data.edittagsnotsupported' | translate }}</p>":"";return n=n.replace(o,d),n}onFieldInit(t){var n,e,o,d,a,i,r;this.originalData[t.fieldid]||(this.originalData[t.fieldid]={id:0,recordid:null!==(n=null===(e=this.entry)||void 0===e?void 0:e.id)&&void 0!==n?n:0,fieldid:t.fieldid,content:t.content,content1:null!==(o=t.content1)&&void 0!==o?o:null,content2:null!==(d=t.content2)&&void 0!==d?d:null,content3:null!==(a=t.content3)&&void 0!==a?a:null,content4:null!==(i=t.content4)&&void 0!==i?i:null,files:null!==(r=t.files)&&void 0!==r?r:[]})}returnToEntryList(){var t=this;return(0,g.Z)((function*(){const n=t.editForm.value;try{var e;const o=yield x.a.getEditTmpFiles(n,t.fieldsArray,(null===(e=t.entry)||void 0===e?void 0:e.contents)||{});m.b.clearTmpFiles(o)}finally{t.forceLeave=!0,v.b.back()}}))()}scrollToFirstError(){var t=this;return(0,g.Z)((function*(){var n;(yield E.V.scrollToElement(t.formElement.nativeElement,".addon-data-error"))||(null===(n=t.content)||void 0===n||n.scrollToTop())}))()}}return(t=AddonModDataEditPage).ɵfac=function AddonModDataEditPage_Factory(n){return new(n||t)},t.ɵcmp=T.Xpm({type:t,selectors:[["page-addon-mod-data-edit"]],viewQuery:function AddonModDataEditPage_Query(t,n){if(1&t&&(T.Gf(h.W2,5),T.Gf(q,5)),2&t){let t;T.iGM(t=T.CRH())&&(n.content=t.first),T.iGM(t=T.CRH())&&(n.formElement=t.first)}},decls:14,vars:12,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[3,"hideUntil"],[3,"groupInfo","selected","courseId","selectedChange"],[3,"class",4,"ngIf"],["fill","clear",3,"click"],[3,"css","prefix"],[3,"formGroup","ngSubmit"],["editFormEl",""],[3,"text","jsData","extraImports"]],template:function AddonModDataEditPage_Template(t,n){1&t&&(T.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),T._UZ(3,"ion-back-button",1),T.ALo(4,"translate"),T.qZA(),T.TgZ(5,"ion-title")(6,"h1"),T._UZ(7,"core-format-text",2),T.qZA()(),T.TgZ(8,"ion-buttons",3),T.YNc(9,AddonModDataEditPage_ion_button_9_Template,3,3,"ion-button",4),T.qZA()()(),T.TgZ(10,"ion-content")(11,"core-loading",5)(12,"core-group-selector",6),T.NdJ("selectedChange",(function AddonModDataEditPage_Template_core_group_selector_selectedChange_12_listener(t){return n.selectedGroup=t}))("selectedChange",(function AddonModDataEditPage_Template_core_group_selector_selectedChange_12_listener(){return n.setGroup(n.selectedGroup)})),T.qZA(),T.YNc(13,AddonModDataEditPage_div_13_Template,5,9,"div",7),T.qZA()()),2&t&&(T.xp6(3),T.Q6J("text",T.lcZ(4,10,"core.back")),T.xp6(4),T.Q6J("text",n.title)("contextInstanceId",n.moduleId)("courseId",n.courseId),T.xp6(2),T.Q6J("ngIf",n.entry),T.xp6(2),T.Q6J("hideUntil",n.loaded),T.xp6(),T.Q6J("groupInfo",n.groupInfo)("selected",n.selectedGroup)("courseId",null==n.database?null:n.database.course),T.xp6(),T.Q6J("ngIf",n.database))},dependencies:[Z.O5,G.Q,L.r,R.r,k.r,N.t,F.O,u._Y,u.JL,h.YG,h.Sm,h.W2,h.Gu,h.wd,h.sr,h.oU,u.sg,J.L,Q.X$],styles:["[_nghost-%COMP%]{--border-color: var(--stroke)}.addon-data-contents[_ngcontent-%COMP%]{overflow:visible;white-space:normal;word-break:break-word;padding:16px;background-color:var(--ion-item-background);border-bottom:1px solid var(--border-color)}.addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tbody{display:block}.addon-data-contents[_ngcontent-%COMP%]     tr{display:flex;flex-wrap:wrap;padding:0}@media (max-width: 575.98px){.addon-data-contents[_ngcontent-%COMP%]     tr{flex-direction:column}}.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));margin:0;box-sizing:border-box;position:relative;flex-basis:0;flex-grow:1;width:100%;max-width:100%;min-height:auto}@media (min-width: 576px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px))}}@media (min-width: 768px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px))}}@media (min-width: 992px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px))}}@media (min-width: 1200px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px))}}.addon-data-contents[_ngcontent-%COMP%]     address, .addon-data-contents[_ngcontent-%COMP%]     article, .addon-data-contents[_ngcontent-%COMP%]     aside, .addon-data-contents[_ngcontent-%COMP%]     blockquote, .addon-data-contents[_ngcontent-%COMP%]     canvas, .addon-data-contents[_ngcontent-%COMP%]     dd, .addon-data-contents[_ngcontent-%COMP%]     div, .addon-data-contents[_ngcontent-%COMP%]     dl, .addon-data-contents[_ngcontent-%COMP%]     dt, .addon-data-contents[_ngcontent-%COMP%]     fieldset, .addon-data-contents[_ngcontent-%COMP%]     figcaption, .addon-data-contents[_ngcontent-%COMP%]     figure, .addon-data-contents[_ngcontent-%COMP%]     footer, .addon-data-contents[_ngcontent-%COMP%]     form, .addon-data-contents[_ngcontent-%COMP%]     h1, .addon-data-contents[_ngcontent-%COMP%]     h2, .addon-data-contents[_ngcontent-%COMP%]     h3, .addon-data-contents[_ngcontent-%COMP%]     h4, .addon-data-contents[_ngcontent-%COMP%]     h5, .addon-data-contents[_ngcontent-%COMP%]     h6, .addon-data-contents[_ngcontent-%COMP%]     header, .addon-data-contents[_ngcontent-%COMP%]     li, .addon-data-contents[_ngcontent-%COMP%]     main, .addon-data-contents[_ngcontent-%COMP%]     nav, .addon-data-contents[_ngcontent-%COMP%]     noscript, .addon-data-contents[_ngcontent-%COMP%]     ol, .addon-data-contents[_ngcontent-%COMP%]     p, .addon-data-contents[_ngcontent-%COMP%]     pre, .addon-data-contents[_ngcontent-%COMP%]     section, .addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tfoot, .addon-data-contents[_ngcontent-%COMP%]     ul, .addon-data-contents[_ngcontent-%COMP%]     video{width:auto!important;height:auto!important;min-width:auto!important;min-height:auto!important;max-height:none!important}.addon-data-contents[_ngcontent-%COMP%]     hr{border-top:1px solid var(--stroke)}","[_nghost-%COMP%]{--input-border-color: var(--stroke);--input-border-width: 1px;--select-border-width: 0px}[_nghost-%COMP%]     table{width:100%}[_nghost-%COMP%]     td{vertical-align:top}[_nghost-%COMP%]     .addon-data-latlong{display:flex}[_nghost-%COMP%]     .addon-data-latlong .input-units{flex-grow:1;white-space:nowrap;align-self:center}[_nghost-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]{padding:16px;width:100%}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]{background-color:var(--ion-item-background)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input{border-bottom:var(--input-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid{--input-border-width: 2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus{--input-border-color: var(--primary)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid{--input-border-color: var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid{--input-border-color: var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor{border-bottom:var(--select-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid{--select-border-width: 2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid{--input-border-color: var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid{--input-border-color: var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select{border-bottom:var(--select-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid{--select-border-width: 2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid{--input-border-color: var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid{--input-border-color: var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors ion-input.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors ion-input.ion-invalid{--input-border-width: 2px;--input-border-color: var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors ion-select.ion-invalid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors core-rich-text-editor.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors ion-select.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors core-rich-text-editor.ng-invalid{--select-border-width: 2px;--input-border-color: var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required{float:right}[dir=rtl][_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl]   [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl][_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl]   [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required{float:left}@supports selector(:dir(rtl)){[_nghost-%COMP%]:dir(rtl)   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [_nghost-%COMP%]:dir(rtl)   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required{float:left}}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-select{padding-inline-end:20px}"]}),AddonModDataEditPage})();var S=e(81856),$=e(7739),H=e(73180),B=e(3772),V=e(86700),j=e(19289),Y=e(88533),W=e(37176);const entry_c0=t=>({$a:t});function AddonModDataEntryPage_ion_card_13_Template(t,n){if(1&t&&(T.TgZ(0,"ion-card",14)(1,"ion-item"),T._UZ(2,"ion-icon",15),T.TgZ(3,"ion-label"),T._uU(4),T.ALo(5,"translate"),T.qZA()()()),2&t){const t=T.oxw();T.xp6(4),T.Oqu(T.xi3(5,1,"core.hasdatatosync",T.VKq(4,entry_c0,t.moduleName)))}}function AddonModDataEntryPage_div_15_Template(t,n){if(1&t){const t=T.EpF();T.TgZ(0,"div"),T._UZ(1,"core-style",16),T.TgZ(2,"core-compile-html",17),T.NdJ("compiling",(function AddonModDataEntryPage_div_15_Template_core_compile_html_compiling_2_listener(n){T.CHM(t);const e=T.oxw();return T.KtG(e.setRenderingEntry(n))})),T.qZA()()}if(2&t){const t=T.oxw();T.Gre("addon-data-contents addon-data-entry addon-data-entries-",t.database.id,""),T.xp6(),T.MGl("prefix",".addon-data-entries-",t.database.id,""),T.Q6J("css",t.database.csstemplate),T.xp6(),T.Q6J("text",t.entryHtml)("jsData",t.jsData)("extraImports",t.extraImports)}}function AddonModDataEntryPage_core_rating_rate_16_Template(t,n){if(1&t){const t=T.EpF();T.TgZ(0,"core-rating-rate",18),T.NdJ("onLoading",(function AddonModDataEntryPage_core_rating_rate_16_Template_core_rating_rate_onLoading_0_listener(n){T.CHM(t);const e=T.oxw();return T.KtG(e.setLoadingRating(n))}))("onUpdate",(function AddonModDataEntryPage_core_rating_rate_16_Template_core_rating_rate_onUpdate_0_listener(){T.CHM(t);const n=T.oxw();return T.KtG(n.ratingUpdated())})),T.qZA()}if(2&t){const t=T.oxw();T.Q6J("ratingInfo",t.ratingInfo)("instanceId",t.database.coursemodule)("itemId",t.entry.id)("itemSetId",0)("courseId",t.courseId)("aggregateMethod",t.database.assessed)("scaleId",t.database.scale)("userId",t.entry.userid)}}function AddonModDataEntryPage_core_rating_aggregate_17_Template(t,n){if(1&t&&T._UZ(0,"core-rating-aggregate",19),2&t){const t=T.oxw();T.Q6J("ratingInfo",t.ratingInfo)("instanceId",t.database.coursemodule)("itemId",t.entry.id)("courseId",t.courseId)("aggregateMethod",t.database.assessed)("scaleId",t.database.scale)}}function AddonModDataEntryPage_core_comments_18_Template(t,n){if(1&t){const t=T.EpF();T.TgZ(0,"core-comments",20),T.NdJ("onLoading",(function AddonModDataEntryPage_core_comments_18_Template_core_comments_onLoading_0_listener(n){T.CHM(t);const e=T.oxw();return T.KtG(e.setLoadingComments(n))})),T.qZA()}if(2&t){const t=T.oxw();T.Q6J("instanceId",t.database.coursemodule)("itemId",t.entry.id)("courseId",t.courseId)("showItem",!0)}}function AddonModDataEntryPage_div_19_Template(t,n){if(1&t){const t=T.EpF();T.TgZ(0,"div",21)(1,"ion-row",22)(2,"ion-col",23)(3,"ion-button",24),T.NdJ("click",(function AddonModDataEntryPage_div_19_Template_ion_button_click_3_listener(){T.CHM(t);const n=T.oxw();return T.KtG(n.gotoEntry(n.offset-1))})),T.ALo(4,"translate"),T._UZ(5,"ion-icon",25),T.qZA()(),T._UZ(6,"ion-col",26),T.TgZ(7,"ion-col",27)(8,"ion-button",24),T.NdJ("click",(function AddonModDataEntryPage_div_19_Template_ion_button_click_8_listener(){T.CHM(t);const n=T.oxw();return T.KtG(n.gotoEntry(n.offset+1))})),T.ALo(9,"translate"),T._UZ(10,"ion-icon",28),T.qZA()()()()}if(2&t){const t=T.oxw();T.xp6(3),T.Q6J("disabled",!t.hasPrevious),T.uIk("aria-label",T.lcZ(4,4,"core.previous")),T.xp6(5),T.Q6J("disabled",!t.hasNext),T.uIk("aria-label",T.lcZ(9,6,"core.next"))}}let z=(()=>{var t;class AddonModDataEntryPage{constructor(t){this.cdr=t,this.fields={},this.fieldsArray=[],this.sortBy=0,this.sortDirection="DESC",this.moduleId=0,this.title="",this.moduleName="data",this.component=I.BO.COMPONENT,this.entryLoaded=!1,this.renderingEntry=!1,this.loadingComments=!1,this.loadingRating=!1,this.selectedGroup=0,this.hasPrevious=!1,this.hasNext=!1,this.showComments=!1,this.entryHtml="",this.extraImports=[c.b],this.isPullingToRefresh=!1,this.commentsEnabled=!1,this.moduleName=H.FO.translateModuleName("data"),this.siteId=M.m9.getCurrentSiteId(),this.syncObserver=b.R.on(B.U.AUTO_SYNCED,(t=>{var n;void 0!==t.entryId&&(t.entryId!=this.entryId&&t.offlineEntryId!=this.entryId||(null===(n=this.database)||void 0===n?void 0:n.id)!=t.dataId||(t.deleted?v.b.back():(this.entryId=t.entryId,this.entryLoaded=!1,this.fetchEntryData(!0))))}),this.siteId),this.entryChangedObserver=b.R.on(I.BO.ENTRY_CHANGED,(t=>{var n;t.entryId==this.entryId&&(null===(n=this.database)||void 0===n?void 0:n.id)==t.dataId&&(t.deleted?v.b.back():(this.entryLoaded=!1,this.fetchEntryData(!0)))}),this.siteId),this.logView=w.V.once((()=>this.performLogView()))}ngOnInit(){var t=this;return(0,g.Z)((function*(){try{var n;t.moduleId=v.b.getRequiredRouteNumberParam("cmId"),t.courseId=v.b.getRequiredRouteNumberParam("courseId"),t.entryId=v.b.getRouteNumberParam("entryId")||void 0,t.title=v.b.getRouteParam("title")||"",t.selectedGroup=v.b.getRouteNumberParam("group")||0,t.offset=v.b.getRouteNumberParam("offset"),t.sortDirection=null!==(n=v.b.getRouteParam("sortDirection"))&&void 0!==n?n:t.sortDirection;const e=Number(v.b.getRouteParam("sortBy"));t.sortBy=isNaN(e)?t.sortBy:e}catch(t){return P.OQ.showErrorModal(t),v.b.back(),void 0}t.commentsEnabled=!$.N.areCommentsDisabledInSite(),yield t.fetchEntryData()}))()}fetchEntryData(t=!1,n=!1){var e=this;return(0,g.Z)((function*(){e.isPullingToRefresh=n;try{e.database=yield I.rE.getDatabase(e.courseId,e.moduleId),e.title=e.database.name||e.title,e.fieldsArray=yield I.rE.getFields(e.database.id,{cmId:e.moduleId}),e.fields=O.Tr.arrayToObject(e.fieldsArray,"id"),yield e.setEntryFromOffset(),e.access=yield I.rE.getDatabaseAccessInformation(e.database.id,{cmId:e.moduleId}),e.groupInfo=yield f.t.getActivityGroupInfo(e.database.coursemodule),e.groupInfo.visibleGroups&&e.groupInfo.groups.length&&(e.groupInfo.groups=e.groupInfo.groups.filter((t=>0!==t.id)),e.groupInfo.defaultGroupId=e.groupInfo.groups[0].id),e.selectedGroup=f.t.validateGroupId(e.selectedGroup,e.groupInfo);const t=x.a.getActions(e.database,e.access,e.entry,I.yx.SHOW),n=x.a.getTemplate(e.database,I.$m.SINGLE,e.fieldsArray);e.entryHtml=x.a.displayShowFields(n,e.fieldsArray,e.entry,I.yx.SHOW,t,{offset:e.offset,sortBy:e.sortBy,sortDirection:e.sortDirection}),e.showComments=t.comments;const o={};o[e.entryId]=e.entry,e.jsData={fields:e.fields,entries:o,database:e.database,title:e.title,group:e.selectedGroup,access:e.access},e.logView()}catch(o){if(!t)return e.refreshAllData(n);P.OQ.showErrorModalDefault(o,"core.course.errorgetmodule",!0)}finally{var o;null===(o=e.content)||void 0===o||o.scrollToTop(),e.entryLoaded=!0}}))()}gotoEntry(t){var n=this;return(0,g.Z)((function*(){n.offset=t,n.entryId=void 0,n.entry=void 0,n.entryLoaded=!1,n.logView=w.V.once((()=>n.performLogView())),yield n.fetchEntryData()}))()}refreshAllData(t){var n=this;return(0,g.Z)((function*(){const e=[];e.push(I.rE.invalidateDatabaseData(n.courseId)),n.database&&(e.push(I.rE.invalidateEntryData(n.database.id,n.entryId)),e.push(f.t.invalidateActivityGroupInfo(n.database.coursemodule)),e.push(I.rE.invalidateEntriesData(n.database.id)),e.push(I.rE.invalidateFieldsData(n.database.id)),n.database.comments&&n.entry&&n.entry.id>0&&n.commentsEnabled&&n.comments&&n.comments.doRefresh().catch((()=>{}))),yield Promise.all(e).finally((()=>n.fetchEntryData(!0,t)))}))()}refreshDatabase(t){this.entryLoaded&&this.refreshAllData(!0).finally((()=>{null==t||t.complete()}))}setGroup(t){var n=this;return(0,g.Z)((function*(){n.selectedGroup=t,n.offset=void 0,n.entry=void 0,n.entryId=void 0,n.entryLoaded=!1,yield n.fetchEntryData()}))()}setEntryFromOffset(){var t=this;return(0,g.Z)((function*(){if(void 0===t.offset&&void 0!==t.entryId){t.hasNext=!1,t.hasPrevious=!1;const n=yield x.a.fetchEntry(t.database,t.fieldsArray,t.entryId);return t.entry=n.entry,t.ratingInfo=n.ratinginfo,void 0}const n=I.BO.PER_PAGE,e=void 0!==t.offset&&t.offset>=0?Math.floor(t.offset/n):0,o=yield x.a.fetchEntries(t.database,t.fieldsArray,{groupId:t.selectedGroup,sort:t.sortBy,order:t.sortDirection,page:e,perPage:n}),d=(o.offlineEntries||[]).concat(o.entries);let a=0;if(void 0===t.offset)a=0,t.offset=0;else if(t.offset>0){var i;a=t.offset%n+((null===(i=o.offlineEntries)||void 0===i?void 0:i.length)||0)}else{var r;a=t.offset+((null===(r=o.offlineEntries)||void 0===r?void 0:r.length)||0)}if(t.entry=d[a],t.entryId=t.entry.id,t.hasPrevious=e>0||a>0,a+1<d.length)t.hasNext=!0;else if(d.length<n)t.hasNext=!1;else{var s;const o=yield I.rE.getEntries(t.database.id,{groupId:t.selectedGroup,page:e+1,perPage:n});t.hasNext=(null==o||null===(s=o.entries)||void 0===s?void 0:s.length)>0}if(t.entryId>0){const n=yield I.rE.getEntry(t.database.id,t.entryId,{cmId:t.moduleId});t.ratingInfo=n.ratinginfo}}))()}setRenderingEntry(t){this.renderingEntry=t,this.cdr.detectChanges()}setLoadingComments(t){this.loadingComments=t,this.cdr.detectChanges()}setLoadingRating(t){this.loadingRating=t,this.cdr.detectChanges()}ratingUpdated(){I.rE.invalidateEntryData(this.database.id,this.entryId)}performLogView(){var t=this;return(0,g.Z)((function*(){t.database&&(yield O.Tr.ignoreErrors(I.rE.logView(t.database.id)),H.FO.storeModuleViewed(t.courseId,t.moduleId),D.ke.logEvent({type:D.gM.VIEW_ITEM,ws:"mod_data_view_database",name:t.database.name,data:{id:t.entryId,databaseid:t.database.id,category:"data"},url:`/mod/data/view.php?d=${t.database.id}&rid=${t.entryId}`}))}))()}ngOnDestroy(){var t,n;null===(t=this.syncObserver)||void 0===t||t.off(),null===(n=this.entryChangedObserver)||void 0===n||n.off()}}return(t=AddonModDataEntryPage).ɵfac=function AddonModDataEntryPage_Factory(n){return new(n||t)(T.Y36(T.sBO))},t.ɵcmp=T.Xpm({type:t,selectors:[["page-addon-mod-data-entry"]],viewQuery:function AddonModDataEntryPage_Query(t,n){if(1&t&&(T.Gf(h.W2,5),T.Gf(S.H,5)),2&t){let t;T.iGM(t=T.CRH())&&(n.content=t.first),T.iGM(t=T.CRH())&&(n.comments=t.first)}},decls:20,vars:20,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","core-warning-card",4,"ngIf"],[3,"groupInfo","selected","courseId","selectedChange"],[3,"class",4,"ngIf"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","itemSetId","courseId","aggregateMethod","scaleId","userId","onLoading","onUpdate",4,"ngIf"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","courseId","aggregateMethod","scaleId",4,"ngIf"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId","showItem","onLoading",4,"ngIf"],["collapsible-footer","","slot","fixed","appearOnBottom","",4,"ngIf"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"css","prefix"],[3,"text","jsData","extraImports","compiling"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","itemSetId","courseId","aggregateMethod","scaleId","userId","onLoading","onUpdate"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","courseId","aggregateMethod","scaleId"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId","showItem","onLoading"],["collapsible-footer","","slot","fixed","appearOnBottom",""],[1,"ion-justify-content-between","ion-align-items-center","ion-no-padding","ion-wrap"],["size","auto",1,"ion-text-start","ion-no-padding","core-navigation-arrow"],["fill","clear",3,"disabled","click"],["name","fas-chevron-left","slot","icon-only","aria-hidden","true"],[1,"ion-text-center"],["size","auto",1,"ion-text-end","ion-no-padding","core-navigation-arrow"],["name","fas-chevron-right","slot","icon-only","aria-hidden","true"]],template:function AddonModDataEntryPage_Template(t,n){1&t&&(T.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),T._UZ(3,"ion-back-button",1),T.ALo(4,"translate"),T.qZA(),T.TgZ(5,"ion-title")(6,"h1"),T._UZ(7,"core-format-text",2),T.qZA()()()(),T.TgZ(8,"ion-content",3)(9,"ion-refresher",4),T.NdJ("ionRefresh",(function AddonModDataEntryPage_Template_ion_refresher_ionRefresh_9_listener(t){return n.refreshDatabase(t.target)})),T._UZ(10,"ion-refresher-content",5),T.ALo(11,"translate"),T.qZA(),T.TgZ(12,"core-loading",6),T.YNc(13,AddonModDataEntryPage_ion_card_13_Template,6,6,"ion-card",7),T.TgZ(14,"core-group-selector",8),T.NdJ("selectedChange",(function AddonModDataEntryPage_Template_core_group_selector_selectedChange_14_listener(t){return n.selectedGroup=t}))("selectedChange",(function AddonModDataEntryPage_Template_core_group_selector_selectedChange_14_listener(){return n.setGroup(n.selectedGroup)})),T.qZA(),T.YNc(15,AddonModDataEntryPage_div_15_Template,3,8,"div",9)(16,AddonModDataEntryPage_core_rating_rate_16_Template,1,8,"core-rating-rate",10)(17,AddonModDataEntryPage_core_rating_aggregate_17_Template,1,6,"core-rating-aggregate",11)(18,AddonModDataEntryPage_core_comments_18_Template,1,4,"core-comments",12),T.qZA(),T.YNc(19,AddonModDataEntryPage_div_19_Template,11,8,"div",13),T.qZA()),2&t&&(T.xp6(3),T.Q6J("text",T.lcZ(4,16,"core.back")),T.xp6(4),T.Q6J("text",n.title)("contextInstanceId",n.moduleId)("courseId",n.courseId),T.xp6(2),T.Q6J("disabled",!n.entryLoaded||!(n.isPullingToRefresh||!n.renderingEntry&&!n.loadingRating&&!n.loadingComments)),T.xp6(),T.s9C("pullingText",T.lcZ(11,18,"core.pulltorefresh")),T.xp6(2),T.Q6J("hideUntil",n.entryLoaded&&(n.isPullingToRefresh||!n.renderingEntry&&!n.loadingRating&&!n.loadingComments)),T.xp6(),T.Q6J("ngIf",n.entry&&n.entry.hasOffline),T.xp6(),T.Q6J("groupInfo",n.groupInfo)("selected",n.selectedGroup)("courseId",n.courseId),T.xp6(),T.Q6J("ngIf",n.database&&n.entry),T.xp6(),T.Q6J("ngIf",n.database&&n.entry&&n.ratingInfo&&(!n.database.approval||n.entry.approved)),T.xp6(),T.Q6J("ngIf",n.database&&n.entry&&n.ratingInfo),T.xp6(),T.Q6J("ngIf",n.database&&n.database.comments&&n.entry&&n.entry.id>0&&n.commentsEnabled),T.xp6(),T.Q6J("ngIf",n.entryLoaded&&n.hasPrevious||n.hasNext))},dependencies:[Z.O5,G.Q,L.r,R.r,V.I,k.r,j.u,N.t,F.O,h.YG,h.Sm,h.PM,h.wI,h.W2,h.Gu,h.gu,h.Ie,h.Q$,h.nJ,h.Wo,h.Nd,h.wd,h.sr,h.oU,S.H,Y.R,W.E,J.L,Q.X$],styles:["[_nghost-%COMP%]{--border-color: var(--stroke)}.addon-data-contents[_ngcontent-%COMP%]{overflow:visible;white-space:normal;word-break:break-word;padding:16px;background-color:var(--ion-item-background);border-bottom:1px solid var(--border-color)}.addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tbody{display:block}.addon-data-contents[_ngcontent-%COMP%]     tr{display:flex;flex-wrap:wrap;padding:0}@media (max-width: 575.98px){.addon-data-contents[_ngcontent-%COMP%]     tr{flex-direction:column}}.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));margin:0;box-sizing:border-box;position:relative;flex-basis:0;flex-grow:1;width:100%;max-width:100%;min-height:auto}@media (min-width: 576px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px))}}@media (min-width: 768px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px))}}@media (min-width: 992px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px))}}@media (min-width: 1200px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-inline-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px))}}.addon-data-contents[_ngcontent-%COMP%]     address, .addon-data-contents[_ngcontent-%COMP%]     article, .addon-data-contents[_ngcontent-%COMP%]     aside, .addon-data-contents[_ngcontent-%COMP%]     blockquote, .addon-data-contents[_ngcontent-%COMP%]     canvas, .addon-data-contents[_ngcontent-%COMP%]     dd, .addon-data-contents[_ngcontent-%COMP%]     div, .addon-data-contents[_ngcontent-%COMP%]     dl, .addon-data-contents[_ngcontent-%COMP%]     dt, .addon-data-contents[_ngcontent-%COMP%]     fieldset, .addon-data-contents[_ngcontent-%COMP%]     figcaption, .addon-data-contents[_ngcontent-%COMP%]     figure, .addon-data-contents[_ngcontent-%COMP%]     footer, .addon-data-contents[_ngcontent-%COMP%]     form, .addon-data-contents[_ngcontent-%COMP%]     h1, .addon-data-contents[_ngcontent-%COMP%]     h2, .addon-data-contents[_ngcontent-%COMP%]     h3, .addon-data-contents[_ngcontent-%COMP%]     h4, .addon-data-contents[_ngcontent-%COMP%]     h5, .addon-data-contents[_ngcontent-%COMP%]     h6, .addon-data-contents[_ngcontent-%COMP%]     header, .addon-data-contents[_ngcontent-%COMP%]     li, .addon-data-contents[_ngcontent-%COMP%]     main, .addon-data-contents[_ngcontent-%COMP%]     nav, .addon-data-contents[_ngcontent-%COMP%]     noscript, .addon-data-contents[_ngcontent-%COMP%]     ol, .addon-data-contents[_ngcontent-%COMP%]     p, .addon-data-contents[_ngcontent-%COMP%]     pre, .addon-data-contents[_ngcontent-%COMP%]     section, .addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tfoot, .addon-data-contents[_ngcontent-%COMP%]     ul, .addon-data-contents[_ngcontent-%COMP%]     video{width:auto!important;height:auto!important;min-width:auto!important;min-height:auto!important;max-height:none!important}.addon-data-contents[_ngcontent-%COMP%]     hr{border-top:1px solid var(--stroke)}"]}),AddonModDataEntryPage})();var K=e(98712),X=e(22976),tt=e(60067);let nt=(()=>{var t;class AddonModDataIndexPage extends K.S{constructor(){super(...arguments),this.group=0}ngOnInit(){super.ngOnInit(),this.group=v.b.getRouteNumberParam("group")||0}}return(t=AddonModDataIndexPage).ɵfac=(()=>{let n;return function AddonModDataIndexPage_Factory(e){return(n||(n=T.n5z(t)))(e||t)}})(),t.ɵcmp=T.Xpm({type:t,selectors:[["page-addon-mod-data-index"]],viewQuery:function AddonModDataIndexPage_Query(t,n){if(1&t&&T.Gf(X.$,5),2&t){let t;T.iGM(t=T.CRH())&&(n.activityComponent=t.first)}},features:[T.qOj],decls:14,vars:13,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","group","dataRetrieved"]],template:function AddonModDataIndexPage_Template(t,n){1&t&&(T.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),T._UZ(3,"ion-back-button",2),T.ALo(4,"translate"),T.qZA(),T.TgZ(5,"ion-title")(6,"h1"),T._UZ(7,"core-format-text",3),T.qZA()(),T._UZ(8,"ion-buttons",4),T.qZA()(),T.TgZ(9,"ion-content",5)(10,"ion-refresher",6),T.NdJ("ionRefresh",(function AddonModDataIndexPage_Template_ion_refresher_ionRefresh_10_listener(t){return null==n.activityComponent?null:n.activityComponent.doRefresh(t.target)})),T._UZ(11,"ion-refresher-content",7),T.ALo(12,"translate"),T.qZA(),T.TgZ(13,"addon-mod-data-index",8),T.NdJ("dataRetrieved",(function AddonModDataIndexPage_Template_addon_mod_data_index_dataRetrieved_13_listener(t){return n.updateData(t)})),T.qZA()()),2&t&&(T.xp6(3),T.Q6J("text",T.lcZ(4,9,"core.back")),T.xp6(4),T.Q6J("text",n.title)("contextInstanceId",n.module.id)("courseId",n.courseId),T.xp6(3),T.Q6J("disabled",null==n.activityComponent?null:n.activityComponent.showLoading),T.xp6(),T.s9C("pullingText",T.lcZ(12,11,"core.pulltorefresh")),T.xp6(2),T.Q6J("module",n.module)("courseId",n.courseId)("group",n.group))},dependencies:[k.r,tt.e,N.t,h.Sm,h.W2,h.Gu,h.nJ,h.Wo,h.wd,h.sr,h.oU,X.$,Q.X$],encapsulation:2}),AddonModDataIndexPage})();const et=[{path:":courseId/:cmId",component:nt},{path:":courseId/:cmId/edit",component:U,canDeactivate:[s.Y]},{path:":courseId/:cmId/edit/:entryId",component:U,canDeactivate:[s.Y]},{path:":courseId/:cmId/:entryId",component:z}];let ot=(()=>{var t;class AddonModDataLazyModule{}return(t=AddonModDataLazyModule).ɵfac=function AddonModDataLazyModule_Factory(n){return new(n||t)},t.ɵmod=T.oAB({type:t}),t.ɵinj=T.cJS({imports:[d.Bz.forChild(et),o.L,l.N,c.b,a.H,r.S,i.x]}),AddonModDataLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&T.kYT(ot,{declarations:[nt,z,U],imports:[d.Bz,o.L,l.N,c.b,a.H,r.S,i.x]}))}}]);