"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4171],{84171:(e,o,t)=>{t.r(o),t.d(o,{AddonStorageManagerLazyModule:()=>E});var n=t(67643),a=t(13386),r=t(49671),i=t(18005),d=t(73180),c=t(68050),s=t(9588),l=t(92974),g=t(23939),_=t(88831),u=t(43555),p=t(53564),m=t(13010),f=t(10727),S=t(49099),h=t(98370),C=t(19212),w=t(96814),x=t(66931),A=t(86700),M=t(8947),b=t(29657),P=t(22068),Z=t(31903),v=t(1097),I=t(89515);function AddonStorageManagerCoursesStoragePage_div_11_Template(e,o){1&e&&(C.TgZ(0,"div",6)(1,"h2"),C._uU(2),C.ALo(3,"translate"),C.qZA()()),2&e&&(C.xp6(2),C.Oqu(C.lcZ(3,1,"addon.storagemanager.alldata")))}function AddonStorageManagerCoursesStoragePage_ion_card_12_ion_badge_6_Template(e,o){if(1&e&&(C.TgZ(0,"ion-badge",9),C._uU(1),C.ALo(2,"coreBytesToSize"),C.qZA()),2&e){const e=C.oxw(2);C.xp6(),C.Oqu(C.lcZ(2,1,e.spaceUsage.spaceUsage))}}function AddonStorageManagerCoursesStoragePage_ion_card_12_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"ion-card")(1,"ion-item",13)(2,"ion-label")(3,"p",14),C._uU(4),C.ALo(5,"translate"),C.qZA(),C.YNc(6,AddonStorageManagerCoursesStoragePage_ion_card_12_ion_badge_6_Template,3,3,"ion-badge",15),C.qZA(),C.TgZ(7,"ion-button",16),C.NdJ("click",(function AddonStorageManagerCoursesStoragePage_ion_card_12_Template_ion_button_click_7_listener(o){C.CHM(e);const t=C.oxw();return C.KtG(t.deleteSiteStorage(o))})),C.ALo(8,"translate"),C._UZ(9,"ion-icon",17),C.qZA()()()}if(2&e){const e=C.oxw();C.xp6(4),C.Oqu(C.lcZ(5,4,"addon.storagemanager.totalspaceusage")),C.xp6(2),C.Q6J("ngIf",e.spaceUsage.spaceUsage),C.xp6(),C.Q6J("hidden",e.spaceUsage.spaceUsage+e.spaceUsage.cacheEntries<=0),C.uIk("aria-label",C.lcZ(8,6,"addon.storagemanager.deleteallsitedata"))}}function AddonStorageManagerCoursesStoragePage_ion_item_29_p_4_Template(e,o){1&e&&(C.TgZ(0,"p",23),C._uU(1),C.ALo(2,"translate"),C.qZA()),2&e&&(C.xp6(),C.hij(" ",C.lcZ(2,1,"core.downloading")," "))}const _c0=e=>({name:e});function AddonStorageManagerCoursesStoragePage_ion_item_29_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"ion-item",18),C.NdJ("click",(function AddonStorageManagerCoursesStoragePage_ion_item_29_Template_ion_item_click_0_listener(){const o=C.CHM(e).$implicit,t=C.oxw();return C.KtG(t.openCourse(o.id,o.title))})),C.TgZ(1,"ion-label",19)(2,"p",8),C._UZ(3,"core-format-text",20),C.qZA(),C.YNc(4,AddonStorageManagerCoursesStoragePage_ion_item_29_p_4_Template,3,3,"p",21),C.TgZ(5,"ion-badge",9),C._uU(6),C.ALo(7,"coreBytesToSize"),C.qZA()(),C.TgZ(8,"ion-button",10),C.NdJ("click",(function AddonStorageManagerCoursesStoragePage_ion_item_29_Template_ion_button_click_8_listener(o){const t=C.CHM(e).$implicit,n=C.oxw();return C.KtG(n.deleteCourse(o,t))})),C._UZ(9,"ion-icon",22),C.ALo(10,"translate"),C.qZA()()}if(2&e){const e=o.$implicit;C.Q6J("detail",!0),C.xp6(3),C.Q6J("text",e.title)("contextInstanceId",e.id)("adaptImg",!1),C.xp6(),C.Q6J("ngIf",e.isDownloading),C.xp6(2),C.hij(" ",C.lcZ(7,8,e.totalSize)," "),C.xp6(2),C.Q6J("disabled",e.isDownloading),C.xp6(),C.uIk("aria-label",C.xi3(10,10,"addon.storagemanager.deletedatafrom",C.VKq(13,_c0,e.title)))}}let D=(()=>{var e;class AddonStorageManagerCoursesStoragePage{constructor(){this.userCourses=[],this.downloadedCourses=[],this.completelyDownloadedCourses=[],this.totalSize=0,this.loaded=!1,this.spaceUsage={cacheEntries:0,spaceUsage:0},this.siteId=p.m9.getCurrentSiteId()}ngOnInit(){var e=this;return(0,r.Z)((function*(){e.userCourses=yield l.B.getUserCourses(),e.courseStatusObserver=h.R.on(h.R.COURSE_STATUS_CHANGED,(({courseId:o,status:t})=>e.onCourseUpdated(o,t)));const o=yield d.FO.getDownloadedCourseIds(),t=yield Promise.all(e.userCourses.filter((e=>-1!==o.indexOf(e.id))).map((o=>e.getDownloadedCourse(o))));if(yield _.CD.isAvailable(e.siteId)){const o=p.m9.getCurrentSiteHomeId(),n=yield e.calculateDownloadedCourseSize(o);if(n>0){const e=yield d.FO.getCourseStatus(o);t.push({id:o,title:f.vN.instant("core.sitehome.sitehome"),totalSize:n,isDownloading:e===i.i.DOWNLOADING})}}e.spaceUsage=yield g.f.getSiteSpaceUsage(e.siteId),e.setDownloadedCourses(t),e.loaded=!0}))()}ngOnDestroy(){var e;null===(e=this.courseStatusObserver)||void 0===e||e.off()}deleteCompletelyDownloadedCourses(e){var o=this;return(0,r.Z)((function*(){e.preventDefault(),e.stopPropagation();try{yield m.OQ.showDeleteConfirm("addon.storagemanager.confirmdeletecourses")}catch(e){if(!m.OQ.isCanceledError(e))throw e;return}const t=yield m.OQ.showModalLoading("core.deleting",!0),n=o.completelyDownloadedCourses.map((e=>e.id));try{yield Promise.all(n.map((e=>c.v.deleteCourseFiles(e)))),o.setDownloadedCourses(o.downloadedCourses.filter((e=>!n.includes(e.id))))}catch(e){m.OQ.showErrorModalDefault(e,f.vN.instant("core.errordeletefile"))}finally{t.dismiss()}}))()}deleteCourse(e,o){var t=this;return(0,r.Z)((function*(){e.preventDefault(),e.stopPropagation();try{yield m.OQ.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:o.title})}catch(e){if(!m.OQ.isCanceledError(e))throw e;return}const n=yield m.OQ.showModalLoading("core.deleting",!0);try{yield c.v.deleteCourseFiles(o.id),t.setDownloadedCourses(S.F.withoutItem(t.downloadedCourses,o))}catch(e){m.OQ.showErrorModalDefault(e,f.vN.instant("core.errordeletefile"))}finally{n.dismiss()}}))()}onCourseUpdated(e,o){var t=this;return(0,r.Z)((function*(){if(e==d.t3.ALL_COURSES_CLEARED)return t.setDownloadedCourses([]),void 0;const n=t.downloadedCourses.find((o=>o.id===e));n&&(n.isDownloading=o===i.i.DOWNLOADING,n.totalSize=yield t.calculateDownloadedCourseSize(n.id),t.setDownloadedCourses(t.downloadedCourses))}))()}setDownloadedCourses(e){this.downloadedCourses=e.sort(((e,o)=>o.totalSize-e.totalSize)),this.completelyDownloadedCourses=e.filter((e=>!e.isDownloading)),this.totalSize=this.downloadedCourses.reduce(((e,o)=>e+o.totalSize),0)}getDownloadedCourse(e){var o=this;return(0,r.Z)((function*(){const t=yield o.calculateDownloadedCourseSize(e.id),n=yield d.FO.getCourseStatus(e.id);return{id:e.id,title:e.displayname||e.fullname,totalSize:t,isDownloading:n===i.i.DOWNLOADING}}))()}calculateDownloadedCourseSize(e){return(0,r.Z)((function*(){const o=yield d.FO.getSections(e),t=S.F.flatten(o.map((e=>e.modules))).map(function(){var o=(0,r.Z)((function*(o){const t=yield s.e.getModuleStoredSize(o,e);return isNaN(t)?0:t}));return function(e){return o.apply(this,arguments)}}());return(yield Promise.all(t)).reduce(((e,o)=>e+o),0)}))()}openCourse(e,o){u.b.navigateToSitePath("/storage/"+e,{params:{title:o}})}deleteSiteStorage(e){var o=this;return(0,r.Z)((function*(){e.preventDefault(),e.stopPropagation();try{const e=p.m9.getRequiredCurrentSite(),t=yield e.getSiteName();o.spaceUsage=yield g.f.deleteSiteStorage(t,o.siteId)}catch{}}))()}}return(e=AddonStorageManagerCoursesStoragePage).ɵfac=function AddonStorageManagerCoursesStoragePage_Factory(o){return new(o||e)},e.ɵcmp=C.Xpm({type:e,selectors:[["page-addon-storagemanager-courses-storage"]],decls:30,vars:23,consts:[["slot","start"],[3,"text"],[1,"limited-width"],[3,"hideUntil"],["class","ion-padding-horizontal ion-text-wrap",4,"ngIf"],[4,"ngIf"],[1,"ion-padding-horizontal","ion-text-wrap"],["lines","full",1,"size","courses","ion-text-wrap"],[1,"item-heading"],["color","light"],["slot","end","color","danger","fill","clear",3,"disabled","click"],["name","fas-trash","slot","icon-only",3,"ariaLabel"],["class","course","button","",3,"detail","click",4,"ngFor","ngForOf"],[1,"ion-text-wrap","total"],[1,"item-heading","ion-text-wrap"],["color","light",4,"ngIf"],["fill","clear","color","danger","slot","end",3,"hidden","click"],["name","fas-trash","slot","icon-only","aria-hidden","true"],["button","",1,"course",3,"detail","click"],[1,"ion-text-wrap"],["contextLevel","course",3,"text","contextInstanceId","adaptImg"],["class","item-heading item-heading-secondary",4,"ngIf"],["name","fas-trash","slot","icon-only"],[1,"item-heading","item-heading-secondary"]],template:function AddonStorageManagerCoursesStoragePage_Template(e,o){1&e&&(C.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),C._UZ(3,"ion-back-button",1),C.ALo(4,"translate"),C.qZA(),C.TgZ(5,"ion-title")(6,"h1"),C._uU(7),C.ALo(8,"translate"),C.qZA()()()(),C.TgZ(9,"ion-content",2)(10,"core-loading",3),C.YNc(11,AddonStorageManagerCoursesStoragePage_div_11_Template,4,3,"div",4)(12,AddonStorageManagerCoursesStoragePage_ion_card_12_Template,10,8,"ion-card",5),C.TgZ(13,"div",6)(14,"h2"),C._uU(15),C.ALo(16,"translate"),C.qZA()(),C.TgZ(17,"ion-card")(18,"ion-item",7)(19,"ion-label")(20,"p",8),C._uU(21),C.ALo(22,"translate"),C.qZA(),C.TgZ(23,"ion-badge",9),C._uU(24),C.ALo(25,"coreBytesToSize"),C.qZA()(),C.TgZ(26,"ion-button",10),C.NdJ("click",(function AddonStorageManagerCoursesStoragePage_Template_ion_button_click_26_listener(e){return o.deleteCompletelyDownloadedCourses(e)})),C._UZ(27,"ion-icon",11),C.ALo(28,"translate"),C.qZA()(),C.YNc(29,AddonStorageManagerCoursesStoragePage_ion_item_29_Template,11,15,"ion-item",12),C.qZA()()()),2&e&&(C.xp6(3),C.Q6J("text",C.lcZ(4,11,"core.back")),C.xp6(4),C.Oqu(C.lcZ(8,13,"addon.storagemanager.managedownloads")),C.xp6(3),C.Q6J("hideUntil",o.loaded),C.xp6(),C.Q6J("ngIf",o.spaceUsage),C.xp6(),C.Q6J("ngIf",o.spaceUsage),C.xp6(3),C.Oqu(C.lcZ(16,15,"addon.storagemanager.downloadedcourses")),C.xp6(6),C.Oqu(C.lcZ(22,17,"addon.storagemanager.totalspaceusage")),C.xp6(3),C.Oqu(C.lcZ(25,19,o.totalSize)),C.xp6(2),C.Q6J("disabled",0===o.completelyDownloadedCourses.length),C.xp6(),C.s9C("ariaLabel",C.lcZ(28,21,"addon.storagemanager.deletecourses")),C.xp6(2),C.Q6J("ngForOf",o.downloadedCourses))},dependencies:[w.sg,w.O5,x.r,A.I,M.r,b.t,P.O,Z.yp,Z.YG,Z.Sm,Z.PM,Z.W2,Z.Gu,Z.gu,Z.Ie,Z.Q$,Z.wd,Z.sr,Z.oU,v.C,I.X$],styles:["ion-item.courses[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%], ion-item.total[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]{font-weight:700}"]}),AddonStorageManagerCoursesStoragePage})();var T=t(75803),y=t(93988),O=t(76396),z=t(52028),k=t(74176);function AddonStorageManagerCourseStoragePage_ion_item_11_Template(e,o){1&e&&(C.TgZ(0,"ion-item",15)(1,"ion-label")(2,"p"),C._uU(3),C.ALo(4,"translate"),C.qZA()()()),2&e&&(C.xp6(3),C.Oqu(C.lcZ(4,1,"addon.storagemanager.courseinfo")))}function AddonStorageManagerCourseStoragePage_ng_container_22_Template(e,o){if(1&e&&(C.ynx(0),C._uU(1),C.ALo(2,"coreBytesToSize"),C.BQk()),2&e){const e=C.oxw();C.xp6(),C.Oqu(C.lcZ(2,1,e.totalSize))}}function AddonStorageManagerCourseStoragePage_ng_container_23_Template(e,o){1&e&&(C.ynx(0),C._uU(1),C.ALo(2,"translate"),C.BQk()),2&e&&(C.xp6(),C.Oqu(C.lcZ(2,1,"core.calculating")))}function AddonStorageManagerCourseStoragePage_ion_button_24_ion_icon_1_Template(e,o){if(1&e&&C._UZ(0,"ion-icon",19),2&e){const e=C.oxw(2);C.Q6J("name",e.prefetchCourseData.icon)}}function AddonStorageManagerCourseStoragePage_ion_button_24_ion_spinner_2_Template(e,o){1&e&&C._UZ(0,"ion-spinner",0)}function AddonStorageManagerCourseStoragePage_ion_button_24_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"ion-button",16),C.NdJ("click",(function AddonStorageManagerCourseStoragePage_ion_button_24_Template_ion_button_click_0_listener(o){C.CHM(e);const t=C.oxw();return C.KtG(t.prefetchCourse(o))})),C.YNc(1,AddonStorageManagerCourseStoragePage_ion_button_24_ion_icon_1_Template,1,1,"ion-icon",17)(2,AddonStorageManagerCourseStoragePage_ion_button_24_ion_spinner_2_Template,1,0,"ion-spinner",18),C._uU(3),C.ALo(4,"translate"),C.qZA()}if(2&e){const e=C.oxw();C.Q6J("disabled",e.prefetchCourseData.loading),C.xp6(),C.Q6J("ngIf",!e.prefetchCourseData.loading),C.xp6(),C.Q6J("ngIf",e.prefetchCourseData.loading),C.xp6(),C.hij(" ",C.lcZ(4,4,e.prefetchCourseData.statusTranslatable)," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_ion_icon_1_Template(e,o){1&e&&(C._UZ(0,"ion-icon",30),C.ALo(1,"translate")),2&e&&C.uIk("aria-label",C.lcZ(1,1,"core.downloaded"))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_Template(e,o){if(1&e&&(C.TgZ(0,"ion-badge",28),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_ion_icon_1_Template,2,3,"ion-icon",29),C._uU(2),C.ALo(3,"coreBytesToSize"),C.qZA()),2&e){const e=C.oxw(2).$implicit,o=C.oxw();C.Q6J("color",e.downloadStatus===o.statusDownloaded?"success":"light"),C.xp6(),C.Q6J("ngIf",e.downloadStatus===o.statusDownloaded),C.xp6(),C.hij("",C.lcZ(3,3,e.totalSize)," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_9_Template(e,o){1&e&&(C.TgZ(0,"ion-badge",31),C._uU(1),C.ALo(2,"translate"),C.qZA()),2&e&&(C.xp6(),C.hij(" ",C.lcZ(2,1,"core.calculating")," "))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_p_10_Template(e,o){if(1&e&&(C.TgZ(0,"p"),C._UZ(1,"core-progress-bar",32),C.qZA()),2&e){const e=C.oxw(2).$implicit;C.xp6(),C.Q6J("progress",0===e.total?-1:e.count/e.total)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_core_download_refresh_1_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"core-download-refresh",39),C.NdJ("action",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_core_download_refresh_1_Template_core_download_refresh_action_0_listener(){C.CHM(e);const o=C.oxw(4).$implicit,t=C.oxw();return C.KtG(t.prefecthSection(o))})),C.qZA()}if(2&e){const e=C.oxw(4).$implicit;C.Q6J("status",e.downloadStatus)("enabled",!0)("loading",e.isDownloading||e.isCalculating)("canTrustDownload",!0)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_ion_badge_2_Template(e,o){if(1&e&&(C.TgZ(0,"ion-badge",40),C.ALo(1,"translate"),C._uU(2),C.qZA()),2&e){const e=C.oxw(4).$implicit;C.uIk("aria-valuemax",e.total)("aria-valuenow",e.count)("aria-valuetext",C.xi3(1,5,"core.course.downloadsectionprogressdescription",e)),C.xp6(2),C.AsE(" ",e.count," / ",e.total," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_Template(e,o){if(1&e&&(C.TgZ(0,"div",36),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_core_download_refresh_1_Template,1,4,"core-download-refresh",37)(2,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_ion_badge_2_Template,3,8,"ion-badge",38),C.qZA()),2&e){const e=C.oxw(3).$implicit,o=C.oxw();C.xp6(),C.Q6J("ngIf",!e.isDownloading&&e.downloadStatus!==o.statusDownloaded),C.xp6(),C.Q6J("ngIf",e.isDownloading&&e.count<e.total)}}const course_storage_c0=e=>({name:e});function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_ion_button_2_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"ion-button",41),C.NdJ("click",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_ion_button_2_Template_ion_button_click_0_listener(o){C.CHM(e);const t=C.oxw(3).$implicit,n=C.oxw();return C.KtG(n.deleteForSection(o,t))})),C._UZ(1,"ion-icon",42),C.ALo(2,"translate"),C.qZA()}if(2&e){const e=C.oxw(3).$implicit;C.xp6(),C.uIk("aria-label",C.xi3(2,1,"addon.storagemanager.deletedatafrom",C.VKq(4,course_storage_c0,e.name)))}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_Template(e,o){if(1&e&&(C.TgZ(0,"div",33),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_div_1_Template,3,2,"div",34)(2,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_ion_button_2_Template,3,6,"ion-button",35),C.qZA()),2&e){const e=C.oxw(2).$implicit,o=C.oxw();C.xp6(),C.Q6J("ngIf",o.downloadEnabled),C.xp6(),C.Q6J("ngIf",!e.calculatingSize&&e.totalSize>0)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_mod_icon_1_Template(e,o){if(1&e&&C._UZ(0,"core-mod-icon",50),2&e){const e=C.oxw(2).$implicit;C.Q6J("modicon",e.handlerData.icon)("modname",e.modname)("componentId",e.instance)("fallbackTranslation",e.modplural)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_ion_icon_1_Template(e,o){1&e&&(C._UZ(0,"ion-icon",30),C.ALo(1,"translate")),2&e&&C.uIk("aria-label",C.lcZ(1,1,"core.downloaded"))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_Template(e,o){if(1&e&&(C.TgZ(0,"ion-badge",28),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_ion_icon_1_Template,2,3,"ion-icon",29),C._uU(2),C.ALo(3,"coreBytesToSize"),C.qZA()),2&e){const e=C.oxw(2).$implicit,o=C.oxw(4);C.Q6J("color",e.downloadStatus===o.statusDownloaded?"success":"light"),C.xp6(),C.Q6J("ngIf",e.downloadStatus===o.statusDownloaded),C.xp6(),C.hij("",C.lcZ(3,3,e.totalSize)," ")}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_6_Template(e,o){1&e&&(C.TgZ(0,"ion-badge",31),C._uU(1),C.ALo(2,"translate"),C.qZA()),2&e&&(C.xp6(),C.hij(" ",C.lcZ(2,1,"core.calculating")," "))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_download_refresh_8_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"core-download-refresh",51),C.NdJ("action",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_download_refresh_8_Template_core_download_refresh_action_0_listener(){C.CHM(e);const o=C.oxw(2).$implicit,t=C.oxw(4);return C.KtG(t.prefetchModule(o))})),C.qZA()}if(2&e){const e=C.oxw(2).$implicit;C.Q6J("status",e.downloadStatus)("enabled",!0)("canTrustDownload",!0)("loading",e.spinner||e.handlerData.spinner)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_button_9_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"ion-button",52),C.NdJ("click",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_button_9_Template_ion_button_click_0_listener(o){C.CHM(e);const t=C.oxw(2).$implicit,n=C.oxw(3).$implicit,a=C.oxw();return C.KtG(a.deleteForModule(o,t,n))})),C._UZ(1,"ion-icon",42),C.ALo(2,"translate"),C.qZA()}if(2&e){const e=C.oxw(2).$implicit;C.xp6(),C.uIk("aria-label",C.xi3(2,1,"addon.storagemanager.deletedatafrom",C.VKq(4,course_storage_c0,e.name)))}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_p_10_Template(e,o){1&e&&(C.TgZ(0,"p",53),C._uU(1),C.ALo(2,"translate"),C.qZA()),2&e&&(C.xp6(),C.hij(" ",C.lcZ(2,1,"core.notdownloadable")," "))}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_Template(e,o){if(1&e&&(C.TgZ(0,"ion-item",44),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_mod_icon_1_Template,1,4,"core-mod-icon",45),C.TgZ(2,"ion-label",15)(3,"p"),C._UZ(4,"core-format-text",46),C.qZA(),C.YNc(5,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_5_Template,4,5,"ion-badge",24)(6,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_badge_6_Template,3,3,"ion-badge",25),C.qZA(),C.TgZ(7,"div",33),C.YNc(8,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_core_download_refresh_8_Template,1,4,"core-download-refresh",47)(9,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_ion_button_9_Template,3,6,"ion-button",48)(10,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_p_10_Template,3,3,"p",49),C.qZA()()),2&e){const e=C.oxw().$implicit,o=C.oxw(4);C.xp6(),C.Q6J("ngIf",e.handlerData.icon),C.xp6(2),C.Gre("item-heading ",e.handlerData.class," addon-storagemanager-module-size"),C.xp6(),C.Q6J("text",e.handlerData.title)("courseId",e.course)("contextInstanceId",e.id)("adaptImg",!1),C.xp6(),C.Q6J("ngIf",!e.calculatingSize&&e.totalSize>0),C.xp6(),C.Q6J("ngIf",e.calculatingSize),C.xp6(2),C.Q6J("ngIf",o.downloadEnabled&&(null==e.handlerData?null:e.handlerData.showDownloadButton)&&e.downloadStatus!==o.statusDownloaded),C.xp6(),C.Q6J("ngIf",!e.calculatingSize&&e.totalSize>0),C.xp6(),C.Q6J("ngIf",!o.downloadEnabled||!(null!=e.handlerData&&e.handlerData.showDownloadButton))}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_Template(e,o){if(1&e&&(C.ynx(0),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_ion_item_1_Template,11,13,"ion-item",43),C.BQk()),2&e){const e=o.$implicit,t=C.oxw(4);C.xp6(),C.Q6J("ngIf",t.downloadEnabled||!e.calculatingSize&&e.totalSize>0)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_Template(e,o){if(1&e&&(C.ynx(0),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_ng_container_1_Template,2,1,"ng-container",14),C.BQk()),2&e){const e=C.oxw(2).$implicit;C.xp6(),C.Q6J("ngForOf",e.modules)}}function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_Template(e,o){if(1&e){const e=C.EpF();C.TgZ(0,"ion-card",21)(1,"ion-card-header")(2,"ion-item",22),C.NdJ("click",(function AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_Template_ion_item_click_2_listener(o){C.CHM(e);const t=C.oxw().$implicit,n=C.oxw();return C.KtG(n.toggleExpand(o,t))})),C.ALo(3,"translate"),C._UZ(4,"ion-icon",23),C.TgZ(5,"ion-label")(6,"p",8),C._UZ(7,"core-format-text",6),C.qZA(),C.YNc(8,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_8_Template,4,5,"ion-badge",24)(9,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ion_badge_9_Template,3,3,"ion-badge",25)(10,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_p_10_Template,2,1,"p",10),C.qZA(),C.YNc(11,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_div_11_Template,3,2,"div",26),C.qZA()(),C.TgZ(12,"ion-card-content",27),C.YNc(13,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_ng_container_13_Template,2,1,"ng-container",10),C.qZA()()}if(2&e){const e=C.oxw().$implicit,o=C.oxw();C.xp6(2),C.ekj("core-course-storage-section-expanded",e.expanded),C.Q6J("lines",e.expanded?"full":"none")("detail",!1),C.uIk("aria-label",C.lcZ(3,18,e.expanded?"core.collapse":"core.expand"))("aria-expanded",e.expanded)("aria-controls","core-course-storage-section-"+e.id),C.xp6(2),C.ekj("expandable-status-icon-expanded",e.expanded),C.xp6(3),C.Q6J("text",e.name)("contextInstanceId",e.course)("adaptImg",!1),C.xp6(),C.Q6J("ngIf",!e.calculatingSize&&e.totalSize>0),C.xp6(),C.Q6J("ngIf",e.calculatingSize),C.xp6(),C.Q6J("ngIf",o.downloadEnabled&&e.isDownloading),C.xp6(),C.Q6J("ngIf",!e.calculatingSize&&e.totalSize>0||o.downloadEnabled),C.xp6(),C.MGl("id","core-course-storage-section-",e.id,""),C.xp6(),C.Q6J("ngIf",e.expanded)}}function AddonStorageManagerCourseStoragePage_ng_container_30_Template(e,o){if(1&e&&(C.ynx(0),C.YNc(1,AddonStorageManagerCourseStoragePage_ng_container_30_ion_card_1_Template,14,20,"ion-card",20),C.BQk()),2&e){const e=o.$implicit;C.xp6(),C.Q6J("ngIf",e.modules.length>0)}}let Q=(()=>{var e;class AddonStorageManagerCourseStoragePage{constructor(e,o){this.elementRef=e,this.changeDetectorRef=o,this.title="",this.loaded=!1,this.sections=[],this.totalSize=0,this.calculatingSize=!0,this.downloadEnabled=!1,this.downloadCourseEnabled=!1,this.prefetchCourseData={icon:i.i.ICON_LOADING,statusTranslatable:"core.course.downloadcourse",status:"",loading:!0},this.statusDownloaded=i.i.DOWNLOADED,this.isDestroyed=!1,this.isGuest=!1,this.siteUpdatedObserver=h.R.on(h.R.SITE_UPDATED,(()=>{this.downloadCourseEnabled=!l.B.isDownloadCourseDisabledInSite(),this.downloadEnabled=!p.m9.getRequiredCurrentSite().isOfflineDisabled(),this.initCoursePrefetch(),this.initModulePrefetch(),this.changeDetectorRef.markForCheck()}),p.m9.getCurrentSiteId())}ngOnInit(){var e=this;return(0,r.Z)((function*(){var o;try{e.courseId=u.b.getRequiredRouteParam("courseId")}catch(e){return m.OQ.showErrorModal(e),u.b.back(),void 0}e.title=u.b.getRouteParam("title")||"",e.title||e.courseId!=p.m9.getCurrentSiteHomeId()||(e.title=f.vN.instant("core.sitehome.sitehome")),e.isGuest=null!==(o=u.b.getRouteBooleanParam("isGuest"))&&void 0!==o?o:(yield c.v.courseUsesGuestAccessInfo(e.courseId)).guestAccess,e.initialSectionId=u.b.getRouteNumberParam("sectionId"),e.downloadCourseEnabled=!l.B.isDownloadCourseDisabledInSite(),e.downloadEnabled=!p.m9.getRequiredCurrentSite().isOfflineDisabled();const t=(yield d.FO.getSections(e.courseId,!1,!0)).filter((e=>!c.v.isSectionStealth(e)));e.sections=(yield c.v.addHandlerDataForModules(t,e.courseId)).sections.map((o=>({...o,totalSize:0,calculatingSize:!0,expanded:o.id===e.initialSectionId,modules:o.modules.map((e=>({...e,calculatingSize:!0})))}))),e.loaded=!0,y.V.scrollToElement(e.elementRef.nativeElement,".core-course-storage-section-expanded",{addYAxis:-10}),yield Promise.all([e.initSizes(),e.initCoursePrefetch(),e.initModulePrefetch()]),e.changeDetectorRef.markForCheck()}))()}initCoursePrefetch(){var e=this;return(0,r.Z)((function*(){if(!e.downloadCourseEnabled||e.courseStatusObserver)return;if(e.courseStatusObserver=h.R.on(h.R.COURSE_STATUS_CHANGED,(o=>{o.courseId!=e.courseId&&o.courseId!=d.t3.ALL_COURSES_CLEARED||e.updateCourseStatus(o.status)}),p.m9.getCurrentSiteId()),yield e.determineCoursePrefetchIcon(),e.prefetchCourseData.icon!=i.i.ICON_LOADING)return;const o=c.v.getCourseDownloadPromise(e.courseId);if(o)o.catch((o=>{e.isDestroyed||m.OQ.showErrorModalDefault(o,"core.course.errordownloadingcourse",!0)}));else{const o=yield d.FO.setCoursePreviousStatus(e.courseId);e.updateCourseStatus(o)}}))()}initModulePrefetch(){var e=this;return(0,r.Z)((function*(){e.downloadEnabled&&!e.sectionStatusObserver&&(e.sectionStatusObserver=h.R.on(h.R.SECTION_STATUS_CHANGED,function(){var o=(0,r.Z)((function*(o){if(!e.downloadEnabled||!e.sections.length||!o.sectionId||o.courseId!=e.courseId)return;const t=c.v.getSectionDownloadId({id:o.sectionId});if(s.e.isBeingDownloaded(t))return;const n=e.sections.find((e=>e.id==o.sectionId));n&&(yield c.v.calculateSectionStatus(n,e.courseId,!1),n.isDownloading&&!s.e.isBeingDownloaded(t)&&e.prefecthSection(n))}));return function(e){return o.apply(this,arguments)}}(),p.m9.getCurrentSiteId()),c.v.calculateSectionsStatus(e.sections,e.courseId,!1,!1),e.sections.forEach((o=>{o.modules.forEach((o=>{var t;null!==(t=o.handlerData)&&void 0!==t&&t.showDownloadButton&&(o.spinner=!0,o.prefetchHandler=s.e.getPrefetchHandlerFor(o.modname),e.calculateModuleStatus(o))}))})),e.moduleStatusObserver=h.R.on(h.R.PACKAGE_STATUS_CHANGED,(o=>{let t;if(e.sections.some((e=>(t=e.modules.find((e=>{var t;return e.id==o.componentId&&e.prefetchHandler&&o.component==(null===(t=e.prefetchHandler)||void 0===t?void 0:t.component)})),!!t))),!t)return;const n=s.e.determineModuleStatus(t,o.status);e.updateModuleStatus(t,n)}),p.m9.getCurrentSiteId()))}))()}initSizes(){var e=this;return(0,r.Z)((function*(){yield Promise.all(e.sections.map(function(){var o=(0,r.Z)((function*(o){yield Promise.all(o.modules.map(function(){var t=(0,r.Z)((function*(t){const n=yield s.e.getModuleStoredSize(t,e.courseId);isNaN(n)||(t.totalSize=Number(n),o.totalSize+=n,e.totalSize+=n),t.calculatingSize=!1}));return function(e){return t.apply(this,arguments)}}())),o.calculatingSize=!1}));return function(e){return o.apply(this,arguments)}}())),e.calculatingSize=!1,0==e.totalSize&&e.markCourseAsNotDownloaded()}))()}updateModulesSizes(e,o){var t=this;return(0,r.Z)((function*(){t.calculatingSize=!0,yield Promise.all(e.map(function(){var e=(0,r.Z)((function*(e){if(!e.calculatingSize){e.calculatingSize=!0,t.changeDetectorRef.markForCheck(),o||(o=t.sections.find((o=>o.modules.some((o=>o.id===e.id)))))&&(o.calculatingSize=!0,t.changeDetectorRef.markForCheck());try{var n;const a=yield s.e.getModuleStoredSize(e,t.courseId),r=(isNaN(a)?0:a)-(null!==(n=e.totalSize)&&void 0!==n?n:0);e.totalSize=Number(a),t.totalSize+=r,o&&(o.totalSize+=r)}catch{}finally{e.calculatingSize=!1,t.changeDetectorRef.markForCheck()}}}));return function(o){return e.apply(this,arguments)}}())),t.calculatingSize=!1,o&&(o.calculatingSize=!1),t.changeDetectorRef.markForCheck()}))()}deleteForCourse(e){var o=this;return(0,r.Z)((function*(){e.stopPropagation(),e.preventDefault();try{yield m.OQ.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:o.title})}catch(e){if(!m.OQ.isCanceledError(e))throw e;return}const t=[];o.sections.forEach((e=>{e.modules.forEach((e=>{e.totalSize&&e.totalSize>0&&t.push(e)}))})),o.deleteModules(t)}))()}deleteForSection(e,o){var t=this;return(0,r.Z)((function*(){e.stopPropagation(),e.preventDefault();try{yield m.OQ.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:o.name})}catch(e){if(!m.OQ.isCanceledError(e))throw e;return}const n=[];o.modules.forEach((e=>{e.totalSize&&e.totalSize>0&&n.push(e)})),t.deleteModules(n,o)}))()}deleteForModule(e,o,t){var n=this;return(0,r.Z)((function*(){if(e.stopPropagation(),e.preventDefault(),0!==o.totalSize){try{yield m.OQ.showDeleteConfirm("addon.storagemanager.confirmdeletedatafrom",{name:o.name})}catch(e){if(!m.OQ.isCanceledError(e))throw e;return}n.deleteModules([o],t)}}))()}deleteModules(e,o){var t=this;return(0,r.Z)((function*(){const n=yield m.OQ.showModalLoading("core.deleting",!0),a=[];e.forEach((e=>{const n=c.v.removeModuleStoredData(e,t.courseId).then((()=>{const n=e.totalSize||0;o&&(o.totalSize-=n),t.totalSize-=n,e.totalSize=0}));a.push(n)}));try{yield Promise.all(a)}catch(e){m.OQ.showErrorModalDefault(e,f.vN.instant("core.errordeletefile"))}finally{n.dismiss(),yield t.updateModulesSizes(e,o),c.v.calculateSectionsStatus(t.sections,t.courseId,!1,!1),0===t.totalSize&&t.sections.map((e=>e.totalSize=0)),t.changeDetectorRef.markForCheck()}}))()}markCourseAsNotDownloaded(){d.FO.setCourseStatus(this.courseId,i.i.NOT_DOWNLOADED)}calculateSectionsStatus(e){this.sections&&T.Tr.ignoreErrors(c.v.calculateSectionsStatus(this.sections,this.courseId,e))}prefecthSection(e){var o=this;return(0,r.Z)((function*(){e.isCalculating=!0,o.changeDetectorRef.markForCheck();try{yield c.v.confirmDownloadSizeSection(o.courseId,e,o.sections);try{yield c.v.prefetchSection(e,o.courseId,o.sections)}catch(e){o.isDestroyed||m.OQ.showErrorModalDefault(e,"core.course.errordownloadingsection",!0)}finally{yield o.updateModulesSizes(e.modules,e),o.changeDetectorRef.markForCheck()}}catch(e){if(!o.isDestroyed&&e)return m.OQ.showErrorModal(e),o.changeDetectorRef.markForCheck(),void 0}finally{e.isCalculating=!1,o.changeDetectorRef.markForCheck()}}))()}prefetchModule(e,o=!1){var t=this;return(0,r.Z)((function*(){if(e.prefetchHandler){e.spinner=!0;try{const n=yield e.prefetchHandler.getDownloadSize(e,e.course,!0);yield c.v.prefetchModule(e.prefetchHandler,e,n,e.course,o),c.v.calculateSectionsStatus(t.sections,t.courseId,!1,!1)}catch(e){t.isDestroyed||m.OQ.showErrorModalDefault(e,"core.errordownloading",!0)}finally{e.spinner=!1,yield t.updateModulesSizes([e])}}}))()}updateModuleStatus(e,o){var t,n;o&&(e.spinner=!1,e.downloadStatus=o,null===(t=e.handlerData)||void 0===t||null===(n=t.updateStatus)||void 0===n||n.call(t,o),this.changeDetectorRef.markForCheck())}calculateModuleStatus(e){var o=this;return(0,r.Z)((function*(){if(!e)return;const t=yield s.e.getModuleStatus(e,o.courseId);o.updateModuleStatus(e,t)}))()}determineCoursePrefetchIcon(){var e=this;return(0,r.Z)((function*(){e.prefetchCourseData=yield c.v.getCourseStatusIconAndTitle(e.courseId)}))()}updateCourseStatus(e){const o=c.v.getCoursePrefetchStatusInfo(e);this.prefetchCourseData.status=o.status,this.prefetchCourseData.icon=o.icon,this.prefetchCourseData.statusTranslatable=o.statusTranslatable,this.prefetchCourseData.loading=o.loading,this.changeDetectorRef.markForCheck()}getCourse(e){var o=this;return(0,r.Z)((function*(){try{return yield l.B.getUserCourse(e,!0)}catch{}try{return yield l.B.getCourse(e)}catch{}return yield l.B.getCourseByField("id",o.courseId)}))()}prefetchCourse(e){var o=this;return(0,r.Z)((function*(){e.stopPropagation(),e.preventDefault();const t=yield o.getCourse(o.courseId);if(!t)return m.OQ.showErrorModal("core.course.errordownloadingcourse",!0),void 0;try{o.changeDetectorRef.markForCheck(),yield c.v.confirmAndPrefetchCourse(o.prefetchCourseData,t,{sections:o.sections,isGuest:o.isGuest}),yield Promise.all(o.sections.map((e=>o.updateModulesSizes(e.modules,e)))),o.changeDetectorRef.markForCheck()}catch(e){if(o.isDestroyed)return;m.OQ.showErrorModalDefault(e,"core.course.errordownloadingcourse",!0)}}))()}toggleExpand(e,o){o.expanded=!o.expanded,e.stopPropagation(),e.preventDefault()}ngOnDestroy(){var e,o,t,n;null===(e=this.courseStatusObserver)||void 0===e||e.off(),null===(o=this.sectionStatusObserver)||void 0===o||o.off(),null===(t=this.moduleStatusObserver)||void 0===t||t.off(),null===(n=this.siteUpdatedObserver)||void 0===n||n.off(),this.sections.forEach((e=>{e.modules.forEach((e=>{var o,t;null===(o=e.handlerData)||void 0===o||null===(t=o.onDestroy)||void 0===t||t.call(o)}))})),this.isDestroyed=!0}}return(e=AddonStorageManagerCourseStoragePage).ɵfac=function AddonStorageManagerCourseStoragePage_Factory(o){return new(o||e)(C.Y36(C.SBq),C.Y36(C.sBO))},e.ɵcmp=C.Xpm({type:e,selectors:[["page-addon-storagemanager-course-storage"]],decls:31,vars:28,consts:[["slot","start"],[3,"text"],[1,"limited-width"],[3,"hideUntil"],["class","ion-text-wrap",4,"ngIf"],[1,"wholecourse"],["contextLevel","course",3,"text","contextInstanceId","adaptImg"],[1,"size","ion-text-wrap","ion-no-padding"],[1,"item-heading","ion-text-wrap"],["color","light","slot","end"],[4,"ngIf"],["expand","block","fill","outline","class","ion-no-margin",3,"disabled","click",4,"ngIf"],["expand","block","color","danger",1,"ion-no-margin","ion-margin-top",3,"disabled","click"],["name","fas-trash","slot","start"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["expand","block","fill","outline",1,"ion-no-margin",3,"disabled","click"],["slot","start",3,"name",4,"ngIf"],["slot","start",4,"ngIf"],["slot","start",3,"name"],["class","section",4,"ngIf"],[1,"section"],["button","",3,"lines","detail","click"],["name","fas-chevron-right","flip-rtl","","slot","start",1,"expandable-status-icon"],[3,"color",4,"ngIf"],["color","light",4,"ngIf"],["class","storage-buttons","slot","end",4,"ngIf"],[3,"id"],[3,"color"],["name","fam-cloud-done",4,"ngIf"],["name","fam-cloud-done"],["color","light"],[3,"progress"],["slot","end",1,"storage-buttons"],["slot","end","class","core-button-spinner",4,"ngIf"],["color","danger","fill","clear",3,"click",4,"ngIf"],["slot","end",1,"core-button-spinner"],[3,"status","enabled","loading","canTrustDownload","action",4,"ngIf"],["class","core-course-download-section-progress","role","progressbar",4,"ngIf"],[3,"status","enabled","loading","canTrustDownload","action"],["role","progressbar",1,"core-course-download-section-progress"],["color","danger","fill","clear",3,"click"],["name","fas-trash","slot","icon-only"],["class","core-course-storage-activity",4,"ngIf"],[1,"core-course-storage-activity"],["slot","start",3,"modicon","modname","componentId","fallbackTranslation",4,"ngIf"],["contextLevel","module",3,"text","courseId","contextInstanceId","adaptImg"],[3,"status","enabled","canTrustDownload","loading","action",4,"ngIf"],["fill","clear","color","danger",3,"click",4,"ngIf"],["class","sr-only",4,"ngIf"],["slot","start",3,"modicon","modname","componentId","fallbackTranslation"],[3,"status","enabled","canTrustDownload","loading","action"],["fill","clear","color","danger",3,"click"],[1,"sr-only"]],template:function AddonStorageManagerCourseStoragePage_Template(e,o){1&e&&(C.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),C._UZ(3,"ion-back-button",1),C.ALo(4,"translate"),C.qZA(),C.TgZ(5,"ion-title")(6,"h1"),C._uU(7),C.ALo(8,"translate"),C.qZA()()()(),C.TgZ(9,"ion-content",2)(10,"core-loading",3),C.YNc(11,AddonStorageManagerCourseStoragePage_ion_item_11_Template,5,3,"ion-item",4),C.TgZ(12,"ion-card",5)(13,"ion-card-header")(14,"ion-card-title"),C._UZ(15,"core-format-text",6),C.qZA(),C.TgZ(16,"ion-item",7)(17,"ion-label")(18,"p",8),C._uU(19),C.ALo(20,"translate"),C.qZA()(),C.TgZ(21,"ion-badge",9),C.YNc(22,AddonStorageManagerCourseStoragePage_ng_container_22_Template,3,3,"ng-container",10)(23,AddonStorageManagerCourseStoragePage_ng_container_23_Template,3,3,"ng-container",10),C.qZA()(),C.YNc(24,AddonStorageManagerCourseStoragePage_ion_button_24_Template,5,6,"ion-button",11),C.TgZ(25,"ion-button",12),C.NdJ("click",(function AddonStorageManagerCourseStoragePage_Template_ion_button_click_25_listener(e){return o.deleteForCourse(e)})),C._UZ(26,"ion-icon",13),C.ALo(27,"translate"),C._uU(28),C.ALo(29,"translate"),C.qZA()()(),C.YNc(30,AddonStorageManagerCourseStoragePage_ng_container_30_Template,2,1,"ng-container",14),C.qZA()()),2&e&&(C.xp6(3),C.Q6J("text",C.lcZ(4,15,"core.back")),C.xp6(4),C.Oqu(C.lcZ(8,17,"addon.storagemanager.coursedownloads")),C.xp6(3),C.Q6J("hideUntil",o.loaded),C.xp6(),C.Q6J("ngIf",o.downloadCourseEnabled),C.xp6(4),C.Q6J("text",o.title)("contextInstanceId",o.courseId)("adaptImg",!1),C.xp6(4),C.Oqu(C.lcZ(20,19,"addon.storagemanager.totaldownloads")),C.xp6(3),C.Q6J("ngIf",!o.calculatingSize),C.xp6(),C.Q6J("ngIf",o.calculatingSize),C.xp6(),C.Q6J("ngIf",o.downloadCourseEnabled),C.xp6(),C.Q6J("disabled",o.calculatingSize||o.totalSize<=0),C.xp6(),C.uIk("aria-label",C.xi3(27,21,"addon.storagemanager.deletedatafrom",C.VKq(26,course_storage_c0,o.title))),C.xp6(2),C.hij(" ",C.lcZ(29,24,"addon.storagemanager.deleteall")," "),C.xp6(2),C.Q6J("ngForOf",o.sections))},dependencies:[w.sg,w.O5,O.D,x.r,z.o,k.j,A.I,M.r,b.t,P.O,Z.yp,Z.YG,Z.Sm,Z.PM,Z.FN,Z.Zi,Z.Dq,Z.W2,Z.Gu,Z.gu,Z.Ie,Z.Q$,Z.PQ,Z.wd,Z.sr,Z.oU,v.C,I.X$],styles:['[_nghost-%COMP%]{--course-storage-max-activity-height: 120px}[_nghost-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-item.size[_ngcontent-%COMP%]{--inner-padding-end: 0px}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .core-course-storage-activity[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{position:relative;max-height:var(--course-storage-max-activity-height);overflow:hidden}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .core-course-storage-activity[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]     *{pointer-events:none!important}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .core-course-storage-activity[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:before{content:"";height:var(--course-storage-max-activity-height);position:absolute;left:0;right:0;top:0;background:linear-gradient(to bottom,rgba(var(--background-gradient-rgb),0) calc(100% - 30px),rgba(var(--background-gradient-rgb),1) calc(100% - 20px));z-index:6;pointer-events:none}[_nghost-%COMP%]   ion-card.section[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]{font-weight:700;font-size:1.2rem}ion-badge[_ngcontent-%COMP%]{margin-top:8px}ion-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-inline-end:8px}ion-item[_ngcontent-%COMP%]   core-mod-icon[_ngcontent-%COMP%]{--size: 18px;--padding: 9px;--margin-vertical: 8px;--margin-end: 8px}.storage-buttons[_ngcontent-%COMP%]{display:flex;align-items:center}'],changeDetection:0}),AddonStorageManagerCourseStoragePage})();const U=[{path:"storage",component:D},{path:"storage/:courseId",component:Q}];let E=(()=>{var e;class AddonStorageManagerLazyModule{}return(e=AddonStorageManagerLazyModule).ɵfac=function AddonStorageManagerLazyModule_Factory(o){return new(o||e)},e.ɵmod=C.oAB({type:e}),e.ɵinj=C.cJS({imports:[n.Bz.forChild(U),a.L,n.Bz]}),AddonStorageManagerLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&C.kYT(E,{declarations:[D,Q],imports:[n.Bz,a.L],exports:[n.Bz]}))}}]);