"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7664],{27664:(e,n,o)=>{o.r(n),o.d(n,{AddonMessagesConversationInfoComponent:()=>I,AddonMessagesConversationInfoComponentModule:()=>x});var t=o(13386),s=o(49671),a=o(11509),r=o(13010),i=o(10727),c=o(19212),l=o(67643),d=o(96814),m=o(52133),f=o(66931),p=o(80070),_=o(50668),u=o(86700),g=o(8947),v=o(29657),C=o(22068),M=o(31903),h=o(89515);function AddonMessagesConversationInfoComponent_ion_item_15_core_format_text_7_Template(e,n){if(1&e&&c._UZ(0,"core-format-text",12),2&e){const e=c.oxw(2);c.Q6J("text",e.conversation.subname)("contextInstanceId",0)}}const _c0=e=>({$a:e});function AddonMessagesConversationInfoComponent_ion_item_15_Template(e,n){if(1&e&&(c.TgZ(0,"ion-item",9)(1,"ion-label")(2,"div",10),c._UZ(3,"img",11),c.qZA(),c.TgZ(4,"h2"),c._UZ(5,"core-format-text",12),c.qZA(),c.TgZ(6,"p"),c.YNc(7,AddonMessagesConversationInfoComponent_ion_item_15_core_format_text_7_Template,1,2,"core-format-text",13),c.qZA(),c.TgZ(8,"p"),c._uU(9),c.ALo(10,"translate"),c.qZA()()()),2&e){const e=c.oxw();c.xp6(3),c.Q6J("src",e.conversation.imageurl,c.LSH)("alt",e.conversation.name),c.xp6(2),c.Q6J("text",e.conversation.name)("contextInstanceId",0),c.xp6(2),c.Q6J("ngIf",e.conversation.subname),c.xp6(2),c.Oqu(c.xi3(10,6,"addon.messages.numparticipants",c.VKq(9,_c0,e.conversation.membercount)))}}function AddonMessagesConversationInfoComponent_ion_item_16_ion_icon_5_Template(e,n){1&e&&(c._UZ(0,"ion-icon",18),c.ALo(1,"translate")),2&e&&c.uIk("aria-label",c.lcZ(1,1,"addon.messages.contactblocked"))}function AddonMessagesConversationInfoComponent_ion_item_16_Template(e,n){if(1&e){const e=c.EpF();c.TgZ(0,"ion-item",14),c.NdJ("click",(function AddonMessagesConversationInfoComponent_ion_item_16_Template_ion_item_click_0_listener(){const n=c.CHM(e).$implicit,o=c.oxw();return c.KtG(o.closeModal(n.id))})),c._UZ(1,"core-user-avatar",15),c.TgZ(2,"ion-label")(3,"p",16),c._uU(4),c.YNc(5,AddonMessagesConversationInfoComponent_ion_item_16_ion_icon_5_Template,2,3,"ion-icon",17),c.qZA()()()}if(2&e){const e=n.$implicit;c.Q6J("detail",!0),c.xp6(),c.Q6J("user",e)("linkProfile",!1)("checkOnline",e.showonlinestatus),c.xp6(3),c.hij(" ",e.fullname," "),c.xp6(),c.Q6J("ngIf",e.isblocked)}}let I=(()=>{var e;class AddonMessagesConversationInfoComponent{constructor(e){this.route=e,this.conversationId=0,this.loaded=!1,this.members=[],this.canLoadMore=!1,this.loadMoreError=!1}ngOnInit(){this.fetchData().finally((()=>{this.loaded=!0}))}fetchData(){var e=this;return(0,s.Z)((function*(){try{const n=yield a.r.getConversation(e.conversationId,!1,!0,0,0);e.conversation=n,yield e.fetchMembers()}catch(e){r.OQ.showErrorModalDefault(e,"Error getting members.")}}))()}fetchMembers(e){var n=this;return(0,s.Z)((function*(){n.loadMoreError=!1;const o=e?n.members.length:0,t=yield a.r.getConversationMembers(n.conversationId,o);n.members=e?n.members.concat(t.members):t.members,n.canLoadMore=t.canLoadMore}))()}loadMoreMembers(e){var n=this;return(0,s.Z)((function*(){try{yield n.fetchMembers(!0)}catch(e){r.OQ.showErrorModalDefault(e,"Error getting members."),n.loadMoreError=!0}finally{e&&e()}}))()}refreshData(e){var n=this;return(0,s.Z)((function*(){const o=[];o.push(a.r.invalidateConversation(n.conversationId)),o.push(a.r.invalidateConversationMembers(n.conversationId)),yield Promise.all(o),yield n.fetchData().finally((()=>{null==e||e.complete()}))}))()}closeModal(e){i.IN.dismiss(e)}}return(e=AddonMessagesConversationInfoComponent).ɵfac=function AddonMessagesConversationInfoComponent_Factory(n){return new(n||e)(c.Y36(l.gz))},e.ɵcmp=c.Xpm({type:e,selectors:[["page-addon-messages-conversation-info"]],inputs:{conversationId:"conversationId"},decls:18,vars:15,consts:[["slot","end"],["fill","clear",3,"click"],["name","fas-xmark","slot","icon-only","aria-hidden","true"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-center",4,"ngIf"],["class","ion-text-wrap addon-messages-conversation-item","button","",3,"detail","click",4,"ngFor","ngForOf"],[3,"enabled","error","action"],[1,"ion-text-center"],[1,"large-avatar"],["core-external-content","","onError","this.src='assets/img/group-avatar.svg'",1,"avatar",3,"src","alt"],["contextLevel","system",3,"text","contextInstanceId"],["contextLevel","system",3,"text","contextInstanceId",4,"ngIf"],["button","",1,"ion-text-wrap","addon-messages-conversation-item",3,"detail","click"],["slot","start",3,"user","linkProfile","checkOnline"],[1,"item-heading"],["name","fas-user-slash",4,"ngIf"],["name","fas-user-slash"]],template:function AddonMessagesConversationInfoComponent_Template(e,n){1&e&&(c.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title")(3,"h1"),c._uU(4),c.ALo(5,"translate"),c.qZA()(),c.TgZ(6,"ion-buttons",0)(7,"ion-button",1),c.NdJ("click",(function AddonMessagesConversationInfoComponent_Template_ion_button_click_7_listener(){return n.closeModal()})),c.ALo(8,"translate"),c._UZ(9,"ion-icon",2),c.qZA()()()(),c.TgZ(10,"ion-content")(11,"ion-refresher",3),c.NdJ("ionRefresh",(function AddonMessagesConversationInfoComponent_Template_ion_refresher_ionRefresh_11_listener(e){return n.refreshData(e.target)})),c._UZ(12,"ion-refresher-content",4),c.ALo(13,"translate"),c.qZA(),c.TgZ(14,"core-loading",5),c.YNc(15,AddonMessagesConversationInfoComponent_ion_item_15_Template,11,11,"ion-item",6)(16,AddonMessagesConversationInfoComponent_ion_item_16_Template,6,6,"ion-item",7),c.TgZ(17,"core-infinite-loading",8),c.NdJ("action",(function AddonMessagesConversationInfoComponent_Template_core_infinite_loading_action_17_listener(e){return n.loadMoreMembers(e)})),c.qZA()()()),2&e&&(c.xp6(4),c.Oqu(c.lcZ(5,9,"addon.messages.groupinfo")),c.xp6(3),c.uIk("aria-label",c.lcZ(8,11,"core.close")),c.xp6(4),c.Q6J("disabled",!n.loaded),c.xp6(),c.s9C("pullingText",c.lcZ(13,13,"core.pulltorefresh")),c.xp6(2),c.Q6J("hideUntil",n.loaded),c.xp6(),c.Q6J("ngIf",n.conversation),c.xp6(),c.Q6J("ngForOf",n.members),c.xp6(),c.Q6J("enabled",n.canLoadMore)("error",n.loadMoreError))},dependencies:[d.sg,d.O5,m.n,f.r,p.X,_.l,u.I,g.r,v.t,C.O,M.YG,M.Sm,M.W2,M.Gu,M.gu,M.Ie,M.Q$,M.nJ,M.Wo,M.wd,M.sr,h.X$],encapsulation:2}),AddonMessagesConversationInfoComponent})(),x=(()=>{var e;class AddonMessagesConversationInfoComponentModule{}return(e=AddonMessagesConversationInfoComponentModule).ɵfac=function AddonMessagesConversationInfoComponentModule_Factory(n){return new(n||e)},e.ɵmod=c.oAB({type:e}),e.ɵinj=c.cJS({imports:[t.L]}),AddonMessagesConversationInfoComponentModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&c.kYT(x,{declarations:[I],imports:[t.L]}))}}]);