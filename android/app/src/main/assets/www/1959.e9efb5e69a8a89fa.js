"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1959],{71460:(e,n,t)=>{t.d(n,{t:()=>CoreSwipeNavigationItemsManager});var r=t(49671),o=t(67643),a=t(43555),i=t(22594);class CoreSwipeNavigationItemsManager extends i.A{start(){var e=this;return(0,r.Z)((function*(){e.updateSelectedItem()}))()}navigateToNextItem(){var e=this;return(0,r.Z)((function*(){yield e.navigateToItemBy(1,"forward")}))()}navigateToPreviousItem(){var e=this;return(0,r.Z)((function*(){yield e.navigateToItemBy(-1,"back")}))()}hasNextItem(){var e=this;return(0,r.Z)((function*(){return!!(yield e.getItemBy(1))}))()}hasPreviousItem(){var e=this;return(0,r.Z)((function*(){return!!(yield e.getItemBy(-1))}))()}getCurrentPageRoute(){return a.b.getCurrentRoute()}getSelectedItemPathFromRoute(e){const n=[];for(;e;){if(n.push(...(e instanceof o.De?e:e.snapshot).url),!e.firstChild)break;e=e.firstChild}return n.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,n){var t=this;return(0,r.Z)((function*(){const r=yield t.getItemBy(e);r&&(yield t.navigateToItem(r,{animationDirection:n,replace:!0}))}))()}getItemBy(e){var n=this;return(0,r.Z)((function*(){var t;const r=n.getSource().getItems(),o=null!==(t=n.selectedItem&&(null==r?void 0:r.indexOf(n.selectedItem)))&&void 0!==t?t:-1;if(-1===o||null===r)return null;const a=e>0?1:-1;let i=o,_=0;for(;_!==e;){if(i+=a,i<0)return null;if(i>=r.length)break;n.skipItemInSwipe(r[i])||(_+=a)}return _===e?r[i]:n.getSource().isCompleted()?null:(yield n.getSource().load(),n.getItemBy(e))}))()}skipItemInSwipe(e){return!1}}},29535:(e,n,t)=>{t.d(n,{s:()=>CoreGradesCoursesSource});var r=t(49671),o=t(54129),a=t(26442),i=t(4496);class CoreGradesCoursesSource extends o.H{loadPageItems(){return(0,r.Z)((function*(){const e=yield a.$.getCoursesGrades();return{items:yield i.b$.getGradesCourseData(e)}}))()}getItemPath(e){return e.courseid.toString()}}},21959:(e,n,t)=>{t.d(n,{u:()=>i});var r=t(13386),o=t(49618),a=t(19212);let i=(()=>{var e;class CoreGradesCoursePageModule{}return(e=CoreGradesCoursePageModule).ɵfac=function CoreGradesCoursePageModule_Factory(n){return new(n||e)},e.ɵmod=a.oAB({type:e}),e.ɵinj=a.cJS({imports:[r.L]}),CoreGradesCoursePageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&a.kYT(i,{declarations:[o.N],imports:[r.L]}))},49618:(e,n,t)=>{t.d(n,{N:()=>A});var r=t(49671),o=t(67643),a=t(13010),i=t(26442),_=t(4496),c=t(53564),s=t(75803),g=t(43555),d=t(38049),l=t(10727),u=t(71460),p=t(25233),m=t(85093),C=t(29535),h=t(93988),f=t(88817),P=t(43468),v=t(19212),x=t(96814),b=t(55126),w=t(52133),M=t(66931),O=t(52028),T=t(86700),I=t(8947),Z=t(88317),G=t(5065),y=t(22742),k=t(29657),J=t(31903),Q=t(89515);function CoreGradesCoursePage_core_empty_box_13_Template(e,n){1&e&&(v._UZ(0,"core-empty-box",8),v.ALo(1,"translate")),2&e&&v.Q6J("message",v.lcZ(1,1,"core.grades.nogradesreturned"))}function CoreGradesCoursePage_div_14_th_4_Template(e,n){if(1&e&&(v.TgZ(0,"th",14),v._uU(1),v.ALo(2,"translate"),v.qZA()),2&e){const e=n.$implicit;v.ekj("ion-hide-md-down",e.hiddenPhone),v.s9C("id",e.name),v.uIk("colspan",e.colspan),v.xp6(),v.hij(" ",v.lcZ(2,5,"core.grades."+e.name)," ")}}function CoreGradesCoursePage_div_14_ng_container_6_tr_1_Template(e,n){if(1&e&&(v.TgZ(0,"tr"),v._UZ(1,"td",18),v.qZA()),2&e){const e=v.oxw().$implicit;v.xp6(),v.uIk("rowspan",e.rowspan)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_td_1_Template(e,n){if(1&e&&v._UZ(0,"td",27),2&e){const e=v.oxw(3).$implicit;v.uIk("rowspan",e.rowspan)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_3_Template(e,n){if(1&e&&v._UZ(0,"ion-icon",28),2&e){const e=v.oxw(3).$implicit;v.ekj("expandable-status-icon-expanded",e.expanded)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_4_Template(e,n){if(1&e&&v._UZ(0,"ion-icon",29),2&e){const e=v.oxw(3).$implicit;v.s9C("name",e.icon),v.uIk("aria-label",e.iconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_img_5_Template(e,n){if(1&e&&v._UZ(0,"img",30),2&e){const e=v.oxw(3).$implicit;v.Q6J("src",e.image,v.LSH)("alt",e.iconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_core_mod_icon_6_Template(e,n){if(1&e&&v._UZ(0,"core-mod-icon",31),2&e){const e=v.oxw(3).$implicit;v.Q6J("modicon",e.image)("modname",e.itemmodule)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_1_Template(e,n){if(1&e&&v._UZ(0,"td",26),2&e){const e=v.oxw().$implicit,n=v.oxw(4).$implicit;v.Tol("ion-text-start core-grades-table-"+e.name),v.ekj("ion-hide-md-down",e.hiddenPhone),v.Q6J("innerHTML",n[e.name],v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_2_Template(e,n){if(1&e&&(v.TgZ(0,"td",35),v._UZ(1,"core-format-text",36),v.qZA()),2&e){const e=v.oxw().$implicit,n=v.oxw(4).$implicit,t=v.oxw(2);v.ekj("ion-hide-md-down",e.hiddenPhone),v.xp6(),v.Q6J("text",n.feedback)("contextInstanceId",t.courseId)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_ion_icon_1_Template(e,n){if(1&e&&v._UZ(0,"ion-icon",38),2&e){const e=v.oxw(6).$implicit;v.Q6J("name",e.gradeIcon),v.uIk("aria-label",e.gradeIconAlt)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_Template(e,n){if(1&e&&(v.TgZ(0,"td"),v.YNc(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_ion_icon_1_Template,1,2,"ion-icon",37),v._UZ(2,"span",26),v.qZA()),2&e){const e=v.oxw().$implicit,n=v.oxw(4).$implicit;v.Gre("ion-text-start core-grades-table-grade ",n.gradeClass,""),v.ekj("ion-hide-md-down",e.hiddenPhone),v.xp6(),v.Q6J("ngIf",n.gradeIcon),v.xp6(),v.Q6J("innerHTML",n[e.name],v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_Template(e,n){if(1&e&&(v.ynx(0),v.YNc(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_1_Template,1,5,"td",32)(2,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_2_Template,2,4,"td",33)(3,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_td_3_Template,3,7,"td",34),v.BQk()),2&e){const e=n.$implicit,t=v.oxw(4).$implicit;v.xp6(),v.Q6J("ngIf","gradeitem"!==e.name&&"feedback"!==e.name&&"grade"!==e.name&&void 0!==t[e.name]),v.xp6(),v.Q6J("ngIf","feedback"===e.name&&void 0!==t.feedback),v.xp6(),v.Q6J("ngIf","grade"===e.name)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_Template(e,n){if(1&e&&(v.ynx(0),v.YNc(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_ng_container_1_Template,4,3,"ng-container",12),v.BQk()),2&e){const e=v.oxw(5);v.xp6(),v.Q6J("ngForOf",e.columns)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_Template(e,n){if(1&e&&(v.ynx(0),v.YNc(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_td_1_Template,1,1,"td",20),v.TgZ(2,"th",21),v.YNc(3,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_3_Template,1,2,"ion-icon",22)(4,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ion_icon_4_Template,1,2,"ion-icon",23)(5,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_img_5_Template,1,2,"img",24)(6,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_core_mod_icon_6_Template,1,2,"core-mod-icon",25),v._UZ(7,"span",26),v.qZA(),v.YNc(8,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_ng_container_8_Template,2,1,"ng-container",15),v.BQk()),2&e){const e=v.oxw(2).$implicit,n=v.oxw(2);v.xp6(),v.Q6J("ngIf","category"===e.itemtype),v.xp6(),v.uIk("colspan",e.colspan),v.xp6(),v.Q6J("ngIf",e.expandable&&n.showSummary),v.xp6(),v.Q6J("ngIf",e.icon),v.xp6(),v.Q6J("ngIf",e.image&&!e.itemmodule),v.xp6(),v.Q6J("ngIf",e.image&&e.itemmodule),v.xp6(),v.Q6J("innerHTML",e.gradeitem,v.oJD),v.xp6(),v.Q6J("ngIf","category"!==e.itemtype)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template(e,n){if(1&e){const e=v.EpF();v.TgZ(0,"tr",19),v.NdJ("ariaButtonClick",(function CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template_tr_ariaButtonClick_0_listener(){v.CHM(e);const n=v.oxw().$implicit,t=v.oxw(2);return v.KtG(n.expandable&&t.showSummary&&t.toggleRow(n))})),v.YNc(1,CoreGradesCoursePage_div_14_ng_container_6_tr_2_ng_container_1_Template,9,8,"ng-container",15),v.qZA()}if(2&e){const e=v.oxw().$implicit,n=v.oxw(2);v.Tol(e.rowclass),v.ekj("core-grades-grade-clickable",e.expandable&&n.showSummary),v.Q6J("id","grade-"+e.id),v.uIk("role",e.expandable&&n.showSummary?"button row":"row")("tabindex",e.expandable&&n.showSummary&&0)("aria-expanded",e.expanded)("aria-label",n.rowAriaLabel(e))("aria-controls",e.detailsid),v.xp6(),v.Q6J("ngIf",e.itemtype)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_3_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.weight")),v.xp6(2),v.Q6J("innerHTML",e.weight,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_4_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.grade")),v.xp6(2),v.Q6J("innerHTML",e.grade,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_5_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.range")),v.xp6(2),v.Q6J("innerHTML",e.range,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_6_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.percentage")),v.xp6(2),v.Q6J("innerHTML",e.percentage,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_7_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.lettergrade")),v.xp6(2),v.Q6J("innerHTML",e.lettergrade,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_8_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.rank")),v.xp6(2),v.Q6J("innerHTML",e.rank,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_9_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.average")),v.xp6(2),v.Q6J("innerHTML",e.average,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_10_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v.TgZ(5,"p"),v._UZ(6,"core-format-text",36),v.qZA()()()),2&e){const e=v.oxw(2).$implicit,n=v.oxw(2);v.xp6(3),v.Oqu(v.lcZ(4,3,"core.grades.feedback")),v.xp6(3),v.Q6J("text",e.feedback)("contextInstanceId",n.courseId)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_11_Template(e,n){if(1&e&&(v.TgZ(0,"ion-item",41)(1,"ion-label")(2,"p",42),v._uU(3),v.ALo(4,"translate"),v.qZA(),v._UZ(5,"p",26),v.qZA()()),2&e){const e=v.oxw(2).$implicit;v.xp6(3),v.Oqu(v.lcZ(4,2,"core.grades.contributiontocoursetotal")),v.xp6(2),v.Q6J("innerHTML",e.contributiontocoursetotal,v.oJD)}}function CoreGradesCoursePage_div_14_ng_container_6_tr_3_Template(e,n){if(1&e&&(v.TgZ(0,"tr",39)(1,"td")(2,"ion-list"),v.YNc(3,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_3_Template,6,4,"ion-item",40)(4,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_4_Template,6,4,"ion-item",40)(5,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_5_Template,6,4,"ion-item",40)(6,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_6_Template,6,4,"ion-item",40)(7,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_7_Template,6,4,"ion-item",40)(8,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_8_Template,6,4,"ion-item",40)(9,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_9_Template,6,4,"ion-item",40)(10,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_10_Template,7,5,"ion-item",40)(11,CoreGradesCoursePage_div_14_ng_container_6_tr_3_ion_item_11_Template,6,4,"ion-item",40),v.qZA()()()),2&e){const e=v.oxw().$implicit,n=v.oxw(2);v.Tol(e.rowclass),v.Q6J("id",e.detailsid),v.xp6(),v.uIk("colspan",n.totalColumnsSpan),v.xp6(2),v.Q6J("ngIf",e.weight),v.xp6(),v.Q6J("ngIf",e.grade),v.xp6(),v.Q6J("ngIf",e.range),v.xp6(),v.Q6J("ngIf",e.percentage),v.xp6(),v.Q6J("ngIf",e.lettergrade),v.xp6(),v.Q6J("ngIf",e.rank),v.xp6(),v.Q6J("ngIf",e.average),v.xp6(),v.Q6J("ngIf",e.feedback),v.xp6(),v.Q6J("ngIf",e.contributiontocoursetotal)}}function CoreGradesCoursePage_div_14_ng_container_6_Template(e,n){if(1&e&&(v.ynx(0),v.YNc(1,CoreGradesCoursePage_div_14_ng_container_6_tr_1_Template,2,1,"tr",15)(2,CoreGradesCoursePage_div_14_ng_container_6_tr_2_Template,2,11,"tr",16)(3,CoreGradesCoursePage_div_14_ng_container_6_tr_3_Template,12,13,"tr",17),v.BQk()),2&e){const e=n.$implicit;v.xp6(),v.Q6J("ngIf","leader"===e.itemtype),v.xp6(),v.Q6J("ngIf","leader"!==e.itemtype),v.xp6(),v.Q6J("ngIf",e.expandable&&e.expanded)}}function CoreGradesCoursePage_div_14_Template(e,n){if(1&e){const e=v.EpF();v.TgZ(0,"div",9)(1,"table",10)(2,"thead")(3,"tr"),v.YNc(4,CoreGradesCoursePage_div_14_th_4_Template,3,7,"th",11),v.qZA()(),v.TgZ(5,"tbody"),v.YNc(6,CoreGradesCoursePage_div_14_ng_container_6_Template,4,3,"ng-container",12),v.ALo(7,"slice"),v.qZA()(),v.TgZ(8,"core-infinite-loading",13),v.NdJ("action",(function CoreGradesCoursePage_div_14_Template_core_infinite_loading_action_8_listener(n){v.CHM(e);const t=v.oxw();return v.KtG(t.loadMore(n))})),v.qZA()()}if(2&e){const e=v.oxw();v.xp6(),v.ekj("summary",e.showSummary),v.xp6(3),v.Q6J("ngForOf",e.columns),v.xp6(2),v.Q6J("ngForOf",v.Dn7(7,5,e.rows,0,e.rowsOnView)),v.xp6(2),v.Q6J("enabled",e.rowsOnView<e.rows.length)}}let A=(()=>{var e;class CoreGradesCoursePage{constructor(e,n){this.route=e,this.element=n,this.columns=[],this.rows=[],this.rowsOnView=0,this.loaded=!1,this.logView=f.V.once((()=>this.performLogView()));try{var t,r,o;switch(this.courseId=g.b.getRequiredRouteNumberParam("courseId",{route:e}),this.userId=null!==(t=g.b.getRouteNumberParam("userId",{route:e}))&&void 0!==t?t:c.m9.getCurrentSiteUserId(),this.gradeId=g.b.getRouteNumberParam("gradeId",{route:e}),this.expandLabel=l.vN.instant("core.expand"),this.collapseLabel=l.vN.instant("core.collapse"),this.useLegacyLayout=!c.m9.getRequiredCurrentSite().isVersionGreaterEqualThan("4.1"),null!==(r=e.snapshot.data.swipeManagerSource)&&void 0!==r?r:null===(o=e.snapshot.parent)||void 0===o?void 0:o.data.swipeManagerSource){case"courses":this.swipeManager=new CoreGradesCourseCoursesSwipeManager(p.p.getOrCreateSource(C.s,[]));break;case"participants":{const e=g.b.getRouteParam("search");this.swipeManager=new CoreGradesCourseParticipantsSwipeManager(p.p.getOrCreateSource(m.f,[this.courseId,e]))}}}catch(e){return a.OQ.showErrorModal(e),g.b.back(),void 0}}get showSummary(){return d.X4.isMobile||!!this.withinSplitView}ngAfterViewInit(){var e=this;return(0,r.Z)((function*(){var n,t;e.withinSplitView=!(null===(n=e.element.nativeElement.parentElement)||void 0===n||!n.closest("core-split-view")),yield null===(t=e.swipeManager)||void 0===t?void 0:t.start(),yield e.fetchInitialGrades(),e.loaded=!0}))()}ngOnDestroy(){var e;null===(e=this.swipeManager)||void 0===e||e.destroy()}rowAriaLabel(e){if(!e.expandable||!this.showSummary)return;return`${e.expanded?this.collapseLabel:this.expandLabel} ${e.ariaLabel}`}toggleRow(e,n){var t;if(!this.rows||!this.columns)return;e.expanded=null!=n?n:!e.expanded;let r=this.columns.length+(null!==(t=e.colspan)&&void 0!==t?t:0);this.useLegacyLayout&&r--;for(let n=this.rows.indexOf(e)-1;n>=0;n--){const t=this.rows[n];!t.rowspan||!t.colspan||t.colspan!==r||!this.useLegacyLayout&&"leader"!==t.itemtype||this.useLegacyLayout&&t.expandable||(r++,t.rowspan+=e.expanded?1:-1)}}refreshGrades(e){var n=this;return(0,r.Z)((function*(){yield s.Tr.ignoreErrors(i.$.invalidateCourseGradesData(n.courseId,n.userId)),yield s.Tr.ignoreErrors(n.fetchGrades()),null==e||e.complete()}))()}fetchInitialGrades(){var e=this;return(0,r.Z)((function*(){try{if(yield e.fetchGrades(),e.gradeId&&e.rows){const n=e.rows.find((n=>n.id==e.gradeId));n&&(e.toggleRow(n,!0),h.V.scrollToElement(e.element.nativeElement,"#grade-"+n.id),e.gradeId=void 0)}}catch(n){a.OQ.showErrorModalDefault(n,"Error loading course"),e.columns=[],e.rows=[],e.rowsOnView=0}}))()}fetchGrades(){var e=this;return(0,r.Z)((function*(){var n,t,r,o;const a=yield i.$.getCourseGradesTable(e.courseId,e.userId),c=yield _.b$.formatGradesTable(a);e.title=null!==(n=null!==(t=null===(r=e.swipeManager)||void 0===r?void 0:r.getPageTitle())&&void 0!==t?t:null===(o=c.rows[0])||void 0===o?void 0:o.gradeitem)&&void 0!==n?n:l.vN.instant("core.grades.grades"),e.columns=c.columns,e.rows=c.rows,e.rowsOnView=e.getRowsOnHeight(),e.totalColumnsSpan=c.columns.reduce(((e,n)=>e+n.colspan),0),e.logView()}))()}getRowsOnHeight(){return Math.floor(window.innerHeight/44)}loadMore(e){this.rowsOnView+=this.getRowsOnHeight(),e&&e()}performLogView(){var e=this;return(0,r.Z)((function*(){var n;yield s.Tr.ignoreErrors(i.$.logCourseGradesView(e.courseId,e.userId)),P.ke.logEvent({type:P.gM.VIEW_ITEM,ws:"gradereport_user_view_grade_report",name:null!==(n=e.title)&&void 0!==n?n:"",data:{id:e.courseId,userid:e.userId,category:"grades"},url:`/grade/report/user/index.php?id=${e.courseId}`+(e.userId!==c.m9.getCurrentSiteUserId()?`&userid=${e.userId}`:"")})}))()}}return(e=CoreGradesCoursePage).ɵfac=function CoreGradesCoursePage_Factory(n){return new(n||e)(v.Y36(o.gz),v.Y36(v.SBq))},e.ɵcmp=v.Xpm({type:e,selectors:[["page-core-grades-course"]],decls:15,vars:12,consts:[["slot","start"],[3,"text"],[3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-chart-bar",3,"message",4,"ngIf"],["class","core-grades-container",4,"ngIf"],["icon","fas-chart-bar",3,"message"],[1,"core-grades-container"],[1,"core-grades-table"],["class","ion-text-start",3,"id","ion-hide-md-down",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"enabled","action"],[1,"ion-text-start",3,"id"],[4,"ngIf"],[3,"class","core-grades-grade-clickable","id","ariaButtonClick",4,"ngIf"],[3,"id","class",4,"ngIf"],[1,"core-grades-table-leader"],[3,"id","ariaButtonClick"],["class","core-grades-table-category",4,"ngIf"],[1,"core-grades-table-gradeitem","ion-text-start"],["aria-hidden","true","slot","start","name","fas-chevron-right","class","expandable-status-icon",3,"expandable-status-icon-expanded",4,"ngIf"],["slot","start",3,"name",4,"ngIf"],["slot","start","class","core-module-icon",3,"src","alt",4,"ngIf"],["slot","start",3,"modicon","modname",4,"ngIf"],[3,"innerHTML"],[1,"core-grades-table-category"],["aria-hidden","true","slot","start","name","fas-chevron-right",1,"expandable-status-icon"],["slot","start",3,"name"],["slot","start",1,"core-module-icon",3,"src","alt"],["slot","start",3,"modicon","modname"],[3,"class","ion-hide-md-down","innerHTML",4,"ngIf"],["class","ion-text-start core-grades-table-feedback",3,"ion-hide-md-down",4,"ngIf"],[3,"ion-hide-md-down","class",4,"ngIf"],[1,"ion-text-start","core-grades-table-feedback"],["collapsible-item","","contextLevel","course",3,"text","contextInstanceId"],[3,"name",4,"ngIf"],[3,"name"],[3,"id"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],[1,"item-heading"]],template:function CoreGradesCoursePage_Template(e,n){1&e&&(v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),v._UZ(3,"ion-back-button",1),v.ALo(4,"translate"),v.qZA(),v.TgZ(5,"ion-title")(6,"h1"),v._uU(7),v.qZA()()()(),v.TgZ(8,"ion-content",2)(9,"ion-refresher",3),v.NdJ("ionRefresh",(function CoreGradesCoursePage_Template_ion_refresher_ionRefresh_9_listener(e){return n.refreshGrades(e.target)})),v._UZ(10,"ion-refresher-content",4),v.ALo(11,"translate"),v.qZA(),v.TgZ(12,"core-loading",5),v.YNc(13,CoreGradesCoursePage_core_empty_box_13_Template,2,3,"core-empty-box",6)(14,CoreGradesCoursePage_div_14_Template,9,9,"div",7),v.qZA()()),2&e&&(v.xp6(3),v.Q6J("text",v.lcZ(4,8,"core.back")),v.xp6(4),v.Oqu(n.title),v.xp6(),v.Q6J("core-swipe-navigation",n.swipeManager),v.xp6(),v.Q6J("disabled",!n.columns||!n.rows),v.xp6(),v.s9C("pullingText",v.lcZ(11,10,"core.pulltorefresh")),v.xp6(2),v.Q6J("hideUntil",n.loaded),v.xp6(),v.Q6J("ngIf",!n.rows.length),v.xp6(),v.Q6J("ngIf",n.rows.length))},dependencies:[x.sg,x.O5,b.z,w.n,M.r,O.o,T.I,I.r,Z.h,G.g,y._,k.t,J.Sm,J.W2,J.Gu,J.gu,J.Ie,J.Q$,J.q_,J.nJ,J.Wo,J.wd,J.sr,J.oU,x.OU,Q.X$],styles:["[_nghost-%COMP%]{--header-background: var(--white);--odd-cell-background: var(--light);--odd-cell-hover: var(--gray-200);--even-cell-background: var(--white);--even-cell-hover: var(--light);--icon-color: var(--gray-500);--border-color: var(--stroke)}[_nghost-%COMP%]   .odd[_ngcontent-%COMP%]{--cell-background: var(--odd-cell-background);--cell-hover: var(--odd-cell-hover)}[_nghost-%COMP%]   .even[_ngcontent-%COMP%]{--cell-background: var(--even-cell-background);--cell-hover: var(--even-cell-hover)}html.dark[_nghost-%COMP%], html.dark   [_nghost-%COMP%]{--header-background: var(--gray-900);--odd-cell-background: var(--gray-800);--odd-cell-hover: var(--gray-600);--even-cell-background: var(--gray-900);--even-cell-hover: var(--gray-700);--icon-color: var(--gray-200)}.core-grades-table[_ngcontent-%COMP%]{border-collapse:collapse;line-height:20px;width:100%;font-size:16px;color:var(--ion-text-color)}.core-grades-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--border-color)}.core-grades-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-inline-end:8px;padding-top:8px;padding-bottom:8px;vertical-align:top;white-space:normal;text-align:start}.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:bottom;font-weight:700;background-color:var(--header-background)}.core-grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-inline-start:24px}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.core-bold[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:inherit}.core-grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   #gradeitem[_ngcontent-%COMP%]{padding-inline-start:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]{padding-inline-start:4px;font-weight:700}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem.column-itemname[_ngcontent-%COMP%]{padding-inline-start:0}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;height:16px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   core-mod-icon[_ngcontent-%COMP%]{--padding: 0px;--size: 16px;background:transparent;--filter: var(--module-icon-filter)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--icon-color)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-inline-start:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon[_ngcontent-%COMP%]{font-size:var(--text-size);margin-inline-start:0;margin-inline-end:2px;transition:transform .2s ease-in-out}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-gradeitem[_ngcontent-%COMP%]   .expandable-status-icon.expandable-status-icon-expanded[_ngcontent-%COMP%]{transform:var(--rotate-expandable)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]{padding-inline-start:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-feedback[_ngcontent-%COMP%]   .no-overflow[_ngcontent-%COMP%]{overflow:auto}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-grade[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{padding-inline-end:4px}.core-grades-table[_ngcontent-%COMP%]   .core-grades-table-leader[_ngcontent-%COMP%]{width:0}.core-grades-table[_ngcontent-%COMP%]   .ion-no-border[_ngcontent-%COMP%]{border:0!important}.core-grades-table[_ngcontent-%COMP%]   .dimmed_text[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{opacity:.7}.core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .odd[_ngcontent-%COMP%]   th[aria-current=page][_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .even[_ngcontent-%COMP%]   th[aria-current=page][_ngcontent-%COMP%]{background-color:var(--cell-background)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]{cursor:pointer}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]:hover   th[aria-current=page][_ngcontent-%COMP%]{background-color:var(--cell-hover)}.core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   .core-grades-grade-clickable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:var(--a11y-min-target-size);vertical-align:middle}.core-grades-table[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%], .core-grades-table[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]::part(native){background-color:transparent}.core-grades-table.summary[_ngcontent-%COMP%]   .ion-hide-md-down[_ngcontent-%COMP%]{display:none;opacity:0}@media (max-width: 767.98px){.core-grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85em}}"]}),CoreGradesCoursePage})();class CoreGradesCourseCoursesSwipeManager extends u.t{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.courseFullName}}class CoreGradesCourseParticipantsSwipeManager extends u.t{constructor(e){super(e)}getPageTitle(){const e=this.getSelectedItem();return null==e?void 0:e.fullname}getSelectedItemPathFromRoute(e){return(e instanceof o.De?e:e.snapshot).params.userId}}}}]);