"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3114],{83114:(t,e,n)=>{n.r(e),n.d(e,{AddonModH5PActivityLazyModule:()=>C});var o=n(67643),i=n(13386),a=n(84095),c=n(75606),r=n(49671),s=n(98712),_=n(13010),d=n(10727),l=n(71505),p=n(19212),m=n(8947),g=n(60067),u=n(29657),A=n(31903),y=n(89515);let h=(()=>{var t;class AddonModH5PActivityIndexPage extends s.S{constructor(){super(...arguments),this.canLeaveSafely=!1}canLeave(){var t=this;return(0,r.Z)((function*(){var e;if(null===(e=t.activityComponent)||void 0===e||!e.playing||t.activityComponent.isOpeningPage||t.activityComponent.saveStateEnabled)return!0;if(!t.canLeaveSafely)try{return yield _.OQ.showConfirm(d.vN.instant("core.confirmleaveunknownchanges")),!0}catch{return!1}return!0}))()}setCanleaveSafely(t){this.canLeaveSafely=t,this.remainingTimeout&&clearTimeout(this.remainingTimeout),this.remainingTimeout=window.setTimeout((()=>{this.canLeaveSafely=!1}),1e4)}ngOnDestroy(){this.remainingTimeout&&clearTimeout(this.remainingTimeout)}}return(t=AddonModH5PActivityIndexPage).ɵfac=(()=>{let e;return function AddonModH5PActivityIndexPage_Factory(n){return(e||(e=p.n5z(t)))(n||t)}})(),t.ɵcmp=p.Xpm({type:t,selectors:[["page-addon-mod-h5pactivity-index"]],viewQuery:function AddonModH5PActivityIndexPage_Query(t,e){if(1&t&&p.Gf(l.F,5),2&t){let t;p.iGM(t=p.CRH())&&(e.activityComponent=t.first)}},features:[p.qOj],decls:14,vars:12,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","dataRetrieved","onActivityFinish"]],template:function AddonModH5PActivityIndexPage_Template(t,e){1&t&&(p.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),p._UZ(3,"ion-back-button",2),p.ALo(4,"translate"),p.qZA(),p.TgZ(5,"ion-title")(6,"h1"),p._UZ(7,"core-format-text",3),p.qZA()(),p._UZ(8,"ion-buttons",4),p.qZA()(),p.TgZ(9,"ion-content")(10,"ion-refresher",5),p.NdJ("ionRefresh",(function AddonModH5PActivityIndexPage_Template_ion_refresher_ionRefresh_10_listener(t){return null==e.activityComponent?null:e.activityComponent.doRefresh(t.target)})),p._UZ(11,"ion-refresher-content",6),p.ALo(12,"translate"),p.qZA(),p.TgZ(13,"addon-mod-h5pactivity-index",7),p.NdJ("dataRetrieved",(function AddonModH5PActivityIndexPage_Template_addon_mod_h5pactivity_index_dataRetrieved_13_listener(t){return e.updateData(t)}))("onActivityFinish",(function AddonModH5PActivityIndexPage_Template_addon_mod_h5pactivity_index_onActivityFinish_13_listener(t){return e.setCanleaveSafely(t)})),p.qZA()()),2&t&&(p.xp6(3),p.Q6J("text",p.lcZ(4,8,"core.back")),p.xp6(4),p.Q6J("text",e.title)("contextInstanceId",e.module.id)("courseId",e.courseId),p.xp6(3),p.Q6J("disabled",null==e.activityComponent?null:e.activityComponent.showLoading),p.xp6(),p.s9C("pullingText",p.lcZ(12,10,"core.pulltorefresh")),p.xp6(2),p.Q6J("module",e.module)("courseId",e.courseId))},dependencies:[m.r,g.e,u.t,A.Sm,A.W2,A.Gu,A.nJ,A.Wo,A.wd,A.sr,A.oU,l.F,y.X$],encapsulation:2}),AddonModH5PActivityIndexPage})();var v=n(45151),f=n(43555),P=n(53564),x=n(75803),Z=n(37083),I=n(88817),T=n(43468),M=n(96814),U=n(55126),w=n(66931),H=n(80070),b=n(86700),q=n(97037),R=n(83369);function AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template(t,e){if(1&t&&p._UZ(0,"core-format-text",11),2&t){const t=p.oxw();p.Q6J("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityUserAttemptsPage_ion_item_13_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",12),p._UZ(1,"core-user-avatar",13),p.TgZ(2,"ion-label")(3,"h2"),p._uU(4),p.qZA()()()),2&t){const t=p.oxw();p.Q6J("userId",t.user.id)("courseId",t.courseId)("detail",!0),p.uIk("aria-label",t.user.fullname),p.xp6(),p.Q6J("user",t.user)("courseId",t.courseId)("linkProfile",!1),p.xp6(3),p.Oqu(t.user.fullname)}}function AddonModH5PActivityUserAttemptsPage_ion_item_14_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",14),p._UZ(1,"core-user-avatar",15),p.TgZ(2,"ion-label")(3,"h2"),p._uU(4),p.ALo(5,"translate"),p.qZA()()()),2&t){const t=p.oxw();p.xp6(),p.Q6J("user",t.user)("courseId",t.courseId),p.xp6(3),p.Oqu(p.lcZ(5,3,"addon.mod_h5pactivity.myattempts"))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template(t,e){1&t&&p.GkF(0)}const _c0=t=>({attempts:t});function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template(t,e){if(1&t&&(p.ynx(0),p.TgZ(1,"ion-item-divider")(2,"ion-label")(3,"h3",16),p._uU(4),p.qZA()()(),p.YNc(5,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template,1,0,"ng-container",17),p.BQk()),2&t){const t=p.oxw(2),e=p.MAs(18);p.xp6(4),p.Oqu(t.attemptsData.scored.title),p.xp6(),p.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",p.VKq(3,_c0,t.attemptsData.scored.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template(t,e){1&t&&p.GkF(0)}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template(t,e){if(1&t&&(p.ynx(0),p.TgZ(1,"ion-item-divider")(2,"ion-label")(3,"h3",16),p._uU(4),p.ALo(5,"translate"),p.qZA()()(),p.YNc(6,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template,1,0,"ng-container",17),p.BQk()),2&t){const t=p.oxw(2),e=p.MAs(18);p.xp6(4),p.Oqu(p.lcZ(5,3,"addon.mod_h5pactivity.all_attempts")),p.xp6(2),p.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",p.VKq(5,_c0,t.attemptsData.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_Template(t,e){if(1&t&&(p.TgZ(0,"ion-list"),p.YNc(1,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template,6,5,"ng-container",8)(2,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template,7,7,"ng-container",8),p.qZA()),2&t){const t=p.oxw();p.xp6(),p.Q6J("ngIf",t.attemptsData.scored),p.xp6(),p.Q6J("ngIf",t.attemptsData.attempts&&t.attemptsData.attempts.length)}}function AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template(t,e){1&t&&(p._UZ(0,"core-empty-box",18),p.ALo(1,"translate")),2&t&&p.Q6J("message",p.lcZ(1,1,"addon.mod_h5pactivity.attempts_none"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template(t,e){1&t&&(p._UZ(0,"img",33),p.ALo(1,"translate")),2&t&&p.Q6J("alt",p.lcZ(1,1,"addon.mod_h5pactivity.attempt_completion_yes"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template(t,e){1&t&&(p._UZ(0,"img",34),p.ALo(1,"translate")),2&t&&p.Q6J("alt",p.lcZ(1,1,"addon.mod_h5pactivity.attempt_completion_no"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template(t,e){1&t&&(p._UZ(0,"ion-icon",35),p.ALo(1,"translate")),2&t&&p.uIk("aria-label",p.lcZ(1,1,"addon.mod_h5pactivity.attempt_success_pass"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template(t,e){1&t&&(p._UZ(0,"ion-icon",36),p.ALo(1,"translate")),2&t&&p.uIk("aria-label",p.lcZ(1,1,"addon.mod_h5pactivity.attempt_success_fail"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template(t,e){1&t&&(p._UZ(0,"img",37),p.ALo(1,"translate")),2&t&&p.Q6J("alt",p.lcZ(1,1,"addon.mod_h5pactivity.attempt_success_unknown"))}const _c1=t=>({$a:t});function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"ion-item",25),p.NdJ("click",(function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template_ion_item_click_0_listener(){const e=p.CHM(t).$implicit,n=p.oxw(2);return p.KtG(n.openAttempt(e))})),p.ALo(1,"translate"),p.TgZ(2,"ion-label")(3,"ion-row",20)(4,"ion-col",21),p._uU(5),p.qZA(),p.TgZ(6,"ion-col",22),p._uU(7),p.ALo(8,"coreFormatDate"),p.qZA(),p.TgZ(9,"ion-col",21),p._uU(10),p.TgZ(11,"span",26),p._uU(12),p.qZA()(),p.TgZ(13,"ion-col",23),p._uU(14),p.qZA(),p.TgZ(15,"ion-col",23),p._uU(16),p.qZA(),p.TgZ(17,"ion-col",23),p.YNc(18,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template,2,3,"img",27)(19,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template,2,3,"img",28),p.qZA(),p.TgZ(20,"ion-col",29),p.YNc(21,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template,2,3,"ion-icon",30)(22,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template,2,3,"ion-icon",31)(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template,2,3,"img",32),p.qZA()()()()}if(2&t){const t=e.$implicit;p.Q6J("detail",!0),p.uIk("aria-label",p.xi3(1,13,"addon.mod_h5pactivity.viewattempt",p.VKq(19,_c1,t.attempt))),p.xp6(5),p.Oqu(t.attempt),p.xp6(2),p.hij(" ",p.xi3(8,16,t.timemodified,"strftimedatetimeshort")," "),p.xp6(3),p.hij(" ",t.rawscore,""),p.xp6(2),p.hij(" / ",t.maxscore,""),p.xp6(2),p.Oqu(t.maxscore),p.xp6(2),p.Oqu(t.durationReadable),p.xp6(2),p.Q6J("ngIf",t.completion),p.xp6(),p.Q6J("ngIf",!t.completion),p.xp6(2),p.Q6J("ngIf",null!==t.success&&t.success),p.xp6(),p.Q6J("ngIf",null!==t.success&&!t.success),p.xp6(),p.Q6J("ngIf",null===t.success)}}function AddonModH5PActivityUserAttemptsPage_ng_template_17_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",19)(1,"ion-label")(2,"ion-row",20)(3,"ion-col",21),p._uU(4,"#"),p.qZA(),p.TgZ(5,"ion-col",22),p._uU(6),p.ALo(7,"translate"),p.qZA(),p.TgZ(8,"ion-col",21),p._uU(9),p.ALo(10,"translate"),p.qZA(),p.TgZ(11,"ion-col",23),p._uU(12),p.ALo(13,"translate"),p.qZA(),p.TgZ(14,"ion-col",23),p._uU(15),p.ALo(16,"translate"),p.qZA(),p.TgZ(17,"ion-col",23),p._uU(18),p.ALo(19,"translate"),p.qZA(),p.TgZ(20,"ion-col",21),p._uU(21),p.ALo(22,"translate"),p.qZA()()()(),p.YNc(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template,24,21,"ion-item",24)),2&t){const t=e.attempts;p.Q6J("detail",!0),p.xp6(6),p.Oqu(p.lcZ(7,8,"core.date")),p.xp6(3),p.Oqu(p.lcZ(10,10,"addon.mod_h5pactivity.score")),p.xp6(3),p.Oqu(p.lcZ(13,12,"addon.mod_h5pactivity.maxscore")),p.xp6(3),p.Oqu(p.lcZ(16,14,"addon.mod_h5pactivity.duration")),p.xp6(3),p.Oqu(p.lcZ(19,16,"addon.mod_h5pactivity.completion")),p.xp6(3),p.Oqu(p.lcZ(22,18,"core.success")),p.xp6(2),p.Q6J("ngForOf",t)}}let Q=(()=>{var t;class AddonModH5PActivityUserAttemptsPage{constructor(){var t=this;this.loaded=!1,this.isCurrentUser=!1,this.logView=I.V.once((0,r.Z)((function*(){t.h5pActivity&&(yield x.Tr.ignoreErrors(Z.X6.logViewReport(t.h5pActivity.id,{userId:t.userId})),T.ke.logEvent({type:T.gM.VIEW_ITEM,ws:"mod_h5pactivity_log_report_viewed",name:t.h5pActivity.name,data:{id:t.h5pActivity.id,userid:t.userId,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${t.h5pActivity.id}&userid=${t.userId}`}))})))}ngOnInit(){var t=this;return(0,r.Z)((function*(){try{t.courseId=f.b.getRequiredRouteNumberParam("courseId"),t.cmId=f.b.getRequiredRouteNumberParam("cmId"),t.userId=f.b.getRouteNumberParam("userId")||P.m9.getCurrentSiteUserId()}catch(t){return _.OQ.showErrorModal(t),f.b.back(),void 0}t.isCurrentUser=t.userId==P.m9.getCurrentSiteUserId(),yield t.fetchData()}))()}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(){var t=this;return(0,r.Z)((function*(){try{t.h5pActivity=yield Z.X6.getH5PActivity(t.courseId,t.cmId),yield Promise.all([t.fetchAttempts(),t.fetchUserProfile()]),t.logView()}catch(t){_.OQ.showErrorModalDefault(t,"Error loading attempts.")}finally{t.loaded=!0}}))()}fetchAttempts(){var t=this;return(0,r.Z)((function*(){t.h5pActivity&&(t.attemptsData=yield Z.X6.getUserAttempts(t.h5pActivity.id,{cmId:t.cmId,userId:t.userId}))}))()}fetchUserProfile(){var t=this;return(0,r.Z)((function*(){try{t.user=yield v.My.getProfile(t.userId,t.courseId,!0)}catch{}}))()}refreshData(){var t=this;return(0,r.Z)((function*(){const e=[Z.X6.invalidateActivityData(t.courseId)];t.h5pActivity&&e.push(Z.X6.invalidateUserAttempts(t.h5pActivity.id,t.userId)),yield x.Tr.ignoreErrors(Promise.all(e)),yield t.fetchData()}))()}openAttempt(t){f.b.navigate(`../../attemptresults/${t.id}`)}}return(t=AddonModH5PActivityUserAttemptsPage).ɵfac=function AddonModH5PActivityUserAttemptsPage_Factory(e){return new(e||t)},t.ɵcmp=p.Xpm({type:t,selectors:[["page-addon-mod-h5pactivity-user-attempts"]],decls:19,vars:13,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap","core-user-link","","button","",3,"userId","courseId","detail",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],[4,"ngIf"],["icon","fas-chart-bar",3,"message",4,"ngIf"],["attemptsTemplate",""],["contextLevel","module",3,"text","contextInstanceId","courseId"],["core-user-link","","button","",1,"ion-text-wrap",3,"userId","courseId","detail"],["slot","start",3,"user","courseId","linkProfile"],[1,"ion-text-wrap"],["slot","start",3,"user","courseId"],[1,"item-heading"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["icon","fas-chart-bar",3,"message"],[1,"addon-mod_h5pactivity-table-header","hide-detail",3,"detail"],[1,"ion-align-items-center"],[1,"ion-text-center"],["size","5","size-md","2",1,"ion-text-center"],[1,"ion-text-center","ion-hide-md-down"],["class","ion-text-wrap addon-mod_h5pactivity-table-row","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap","addon-mod_h5pactivity-table-row",3,"detail","click"],[1,"ion-hide-md-up"],["src","assets/img/completion/completion-auto-y.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-n.svg",3,"alt",4,"ngIf"],[1,"ion-text-center","addon-mod_h5pactivity-table-success-col"],["name","fas-circle-check",4,"ngIf"],["name","far-circle",4,"ngIf"],["src","assets/img/icons/empty.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-y.svg",3,"alt"],["src","assets/img/completion/completion-auto-n.svg",3,"alt"],["name","fas-circle-check"],["name","far-circle"],["src","assets/img/icons/empty.svg",3,"alt"]],template:function AddonModH5PActivityUserAttemptsPage_Template(t,e){1&t&&(p.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),p._UZ(3,"ion-back-button",1),p.ALo(4,"translate"),p.qZA(),p.TgZ(5,"ion-title")(6,"h1"),p.YNc(7,AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template,1,3,"core-format-text",2),p.qZA()()()(),p.TgZ(8,"ion-content")(9,"ion-refresher",3),p.NdJ("ionRefresh",(function AddonModH5PActivityUserAttemptsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),p._UZ(10,"ion-refresher-content",4),p.ALo(11,"translate"),p.qZA(),p.TgZ(12,"core-loading",5),p.YNc(13,AddonModH5PActivityUserAttemptsPage_ion_item_13_Template,5,8,"ion-item",6)(14,AddonModH5PActivityUserAttemptsPage_ion_item_14_Template,6,5,"ion-item",7)(15,AddonModH5PActivityUserAttemptsPage_ion_list_15_Template,3,2,"ion-list",8)(16,AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template,2,3,"core-empty-box",9),p.qZA()(),p.YNc(17,AddonModH5PActivityUserAttemptsPage_ng_template_17_Template,24,20,"ng-template",null,10,p.W1O)),2&t&&(p.xp6(3),p.Q6J("text",p.lcZ(4,9,"core.back")),p.xp6(4),p.Q6J("ngIf",e.h5pActivity),p.xp6(2),p.Q6J("disabled",!e.loaded),p.xp6(),p.s9C("pullingText",p.lcZ(11,11,"core.pulltorefresh")),p.xp6(2),p.Q6J("hideUntil",e.loaded),p.xp6(),p.Q6J("ngIf",e.user&&!e.isCurrentUser),p.xp6(),p.Q6J("ngIf",e.user&&e.isCurrentUser),p.xp6(),p.Q6J("ngIf",e.attemptsData),p.xp6(),p.Q6J("ngIf",e.attemptsData&&(!e.attemptsData.attempts||!e.attemptsData.attempts.length)))},dependencies:[M.sg,M.O5,M.tP,U.z,w.r,H.X,b.I,m.r,q.j,u.t,A.Sm,A.wI,A.W2,A.Gu,A.gu,A.Ie,A.rH,A.Q$,A.q_,A.nJ,A.Wo,A.Nd,A.wd,A.sr,A.oU,R.o,y.X$],styles:["[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .addon-mod_h5pactivity-table-row[_ngcontent-%COMP%]   .addon-mod_h5pactivity-table-success-col[_ngcontent-%COMP%]{font-size:1.2em}"]}),AddonModH5PActivityUserAttemptsPage})();function AddonModH5PActivityAttemptResultsPage_core_format_text_7_Template(t,e){if(1&t&&p._UZ(0,"core-format-text",8),2&t){const t=p.oxw();p.Q6J("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_1_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",14),p._UZ(1,"core-user-avatar",15),p.TgZ(2,"ion-label")(3,"p",13),p._uU(4),p.ALo(5,"translate"),p.qZA()()()),2&t){const t=p.oxw(2);p.Q6J("userId",t.user.id)("courseId",t.courseId),p.uIk("aria-label",t.user.fullname),p.xp6(),p.Q6J("user",t.user)("courseId",t.courseId)("linkProfile",!1),p.xp6(3),p.lnq("",p.lcZ(5,9,"addon.mod_h5pactivity.attempt")," #",t.attempt.attempt,": ",t.user.fullname,"")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_2_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",12)(1,"ion-label")(2,"p",13),p._uU(3),p.ALo(4,"translate"),p.qZA()()()),2&t){const t=p.oxw(2);p.xp6(3),p.AsE("",p.lcZ(4,2,"addon.mod_h5pactivity.attempt")," #",t.attempt.attempt,"")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_18_Template(t,e){1&t&&(p.TgZ(0,"p"),p._UZ(1,"img",16),p._uU(2),p.ALo(3,"translate"),p.qZA()),2&t&&(p.xp6(2),p.hij(" ",p.lcZ(3,1,"addon.mod_h5pactivity.attempt_completion_yes")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_19_Template(t,e){1&t&&(p.TgZ(0,"p"),p._UZ(1,"img",17),p._uU(2),p.ALo(3,"translate"),p.qZA()),2&t&&(p.xp6(2),p.hij(" ",p.lcZ(3,1,"addon.mod_h5pactivity.attempt_completion_no")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_32_Template(t,e){1&t&&(p.TgZ(0,"p"),p._UZ(1,"ion-icon",18),p._uU(2),p.ALo(3,"translate"),p.qZA()),2&t&&(p.xp6(2),p.hij(" ",p.lcZ(3,1,"addon.mod_h5pactivity.attempt_success_pass")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_33_Template(t,e){1&t&&(p.TgZ(0,"p"),p._UZ(1,"ion-icon",19),p._uU(2),p.ALo(3,"translate"),p.qZA()),2&t&&(p.xp6(2),p.hij(" ",p.lcZ(3,1,"addon.mod_h5pactivity.attempt_success_fail")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_34_Template(t,e){1&t&&(p.TgZ(0,"p"),p._uU(1),p.ALo(2,"translate"),p.qZA()),2&t&&(p.xp6(),p.hij(" ",p.lcZ(2,1,"addon.mod_h5pactivity.attempt_success_unknown")," "))}const attempt_results_c0=t=>({$a:t});function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_35_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",12)(1,"ion-label")(2,"p",13),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.TgZ(5,"p"),p._uU(6),p.ALo(7,"translate"),p.qZA()()()),2&t){const t=p.oxw(2);p.xp6(3),p.Oqu(p.lcZ(4,2,"addon.mod_h5pactivity.totalscore")),p.xp6(3),p.Oqu(p.xi3(7,4,"addon.mod_h5pactivity.score_out_of",p.VKq(7,attempt_results_c0,t.attempt)))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_4_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",12)(1,"ion-label"),p._UZ(2,"core-format-text",21),p.qZA()()),2&t){const t=p.oxw().$implicit,e=p.oxw(3);p.xp6(2),p.Q6J("text",t.content)("component",e.component)("componentId",e.cmId)("contextInstanceId",e.cmId)("courseId",e.courseId)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_ng_container_1_Template(t,e){1&t&&p.GkF(0)}const attempt_results_c1=t=>({answer:t});function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_Template(t,e){if(1&t&&(p.ynx(0),p.YNc(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_ng_container_1_Template,1,0,"ng-container",30),p.BQk()),2&t){const t=p.oxw().$implicit;p.oxw(5);const e=p.MAs(15);p.xp6(),p.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",p.VKq(2,attempt_results_c1,t.correctanswer))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_ng_container_1_Template(t,e){1&t&&p.GkF(0)}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_Template(t,e){if(1&t&&(p.ynx(0),p.YNc(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_ng_container_1_Template,1,0,"ng-container",30),p.BQk()),2&t){const t=p.oxw().$implicit;p.oxw(5);const e=p.MAs(15);p.xp6(),p.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",p.VKq(2,attempt_results_c1,t.useranswer))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",29)(1,"ion-label")(2,"ion-row",24)(3,"ion-col",25),p._UZ(4,"core-format-text",21),p.qZA(),p.TgZ(5,"ion-col",26),p.YNc(6,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_Template,2,4,"ng-container",6),p.qZA(),p.TgZ(7,"ion-col",26),p.YNc(8,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_Template,2,4,"ng-container",6),p.qZA()()()()),2&t){const t=e.$implicit,n=p.oxw(5);p.xp6(4),p.Q6J("text",t.description)("component",n.component)("componentId",n.cmId)("contextInstanceId",n.cmId)("courseId",n.courseId),p.xp6(2),p.Q6J("ngIf",t.correctanswer),p.xp6(2),p.Q6J("ngIf",t.useranswer)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_11_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",31)(1,"ion-label")(2,"p")(3,"strong"),p._uU(4),p.ALo(5,"translate"),p.ALo(6,"translate"),p.qZA()()()()),2&t){const t=p.oxw(2).$implicit;p.xp6(4),p.AsE(" ",p.lcZ(5,2,"addon.mod_h5pactivity.score"),": ",p.xi3(6,4,"addon.mod_h5pactivity.score_out_of",p.VKq(7,attempt_results_c0,t))," ")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_Template(t,e){if(1&t&&(p.ynx(0),p.TgZ(1,"ion-item",23)(2,"ion-label")(3,"ion-row",24)(4,"ion-col",25),p._uU(5),p.qZA(),p.TgZ(6,"ion-col",26),p._uU(7),p.qZA(),p.TgZ(8,"ion-col",26),p._uU(9),p.qZA()()()(),p.YNc(10,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_Template,9,7,"ion-item",27)(11,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_11_Template,7,9,"ion-item",28),p.BQk()),2&t){const t=p.oxw().$implicit;p.xp6(5),p.Oqu(t.optionslabel),p.xp6(2),p.Oqu(t.correctlabel),p.xp6(2),p.Oqu(t.answerlabel),p.xp6(),p.Q6J("ngForOf",t.options),p.xp6(),p.Q6J("ngIf",t.maxscore)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_6_Template(t,e){if(1&t&&(p.TgZ(0,"ion-item",32),p._UZ(1,"ion-icon",33),p.TgZ(2,"ion-label"),p._uU(3),p.ALo(4,"translate"),p.qZA()()),2&t){const t=p.oxw().$implicit;p.xp6(3),p.hij(" ",p.xi3(4,1,"addon.mod_h5pactivity.no_compatible_track",p.VKq(4,attempt_results_c0,t.interactiontype))," ")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_Template(t,e){if(1&t&&(p.TgZ(0,"ion-card")(1,"ion-card-header",12)(2,"ion-card-title"),p._UZ(3,"core-format-text",21),p.qZA()(),p.YNc(4,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_4_Template,3,5,"ion-item",10)(5,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_Template,12,5,"ng-container",6)(6,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_6_Template,5,6,"ion-item",22),p.qZA()),2&t){const t=e.$implicit,n=p.oxw(3);p.xp6(3),p.Q6J("text",t.description)("component",n.component)("componentId",n.cmId)("contextInstanceId",n.cmId)("courseId",n.courseId),p.xp6(),p.Q6J("ngIf",t.content),p.xp6(),p.Q6J("ngIf",t.options&&t.options.length),p.xp6(),p.Q6J("ngIf",!t.track)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_Template(t,e){if(1&t&&(p.ynx(0),p.YNc(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_Template,7,8,"ion-card",20),p.BQk()),2&t){const t=p.oxw(2);p.xp6(),p.Q6J("ngForOf",t.attempt.results)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_Template(t,e){if(1&t&&(p.ynx(0),p.YNc(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_1_Template,6,11,"ion-item",9)(2,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_2_Template,5,4,"ion-item",10),p.TgZ(3,"ion-card",11)(4,"ion-list")(5,"ion-item",12)(6,"ion-label")(7,"p",13),p._uU(8),p.ALo(9,"translate"),p.qZA(),p.TgZ(10,"p"),p._uU(11),p.ALo(12,"coreFormatDate"),p.qZA()()(),p.TgZ(13,"ion-item",12)(14,"ion-label")(15,"p",13),p._uU(16),p.ALo(17,"translate"),p.qZA(),p.YNc(18,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_18_Template,4,3,"p",6)(19,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_19_Template,4,3,"p",6),p.qZA()(),p.TgZ(20,"ion-item",12)(21,"ion-label")(22,"p",13),p._uU(23),p.ALo(24,"translate"),p.qZA(),p.TgZ(25,"p"),p._uU(26),p.qZA()()(),p.TgZ(27,"ion-item",12)(28,"ion-label")(29,"p",13),p._uU(30),p.ALo(31,"translate"),p.qZA(),p.YNc(32,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_32_Template,4,3,"p",6)(33,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_33_Template,4,3,"p",6)(34,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_34_Template,3,3,"p",6),p.qZA()(),p.YNc(35,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_35_Template,8,9,"ion-item",10),p.qZA()(),p.YNc(36,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_Template,2,1,"ng-container",6),p.BQk()),2&t){const t=p.oxw();p.xp6(),p.Q6J("ngIf",t.user),p.xp6(),p.Q6J("ngIf",!t.user),p.xp6(6),p.Oqu(p.lcZ(9,15,"addon.mod_h5pactivity.startdate")),p.xp6(3),p.Oqu(p.xi3(12,17,t.attempt.timecreated,"strftimedatetime")),p.xp6(5),p.Oqu(p.lcZ(17,20,"addon.mod_h5pactivity.completion")),p.xp6(2),p.Q6J("ngIf",t.attempt.completion),p.xp6(),p.Q6J("ngIf",!t.attempt.completion),p.xp6(4),p.Oqu(p.lcZ(24,22,"addon.mod_h5pactivity.duration")),p.xp6(3),p.Oqu(t.attempt.durationReadable),p.xp6(4),p.Oqu(p.lcZ(31,24,"addon.mod_h5pactivity.outcome")),p.xp6(2),p.Q6J("ngIf",null!==t.attempt.success&&t.attempt.success),p.xp6(),p.Q6J("ngIf",null!==t.attempt.success&&!t.attempt.success),p.xp6(),p.Q6J("ngIf",null===t.attempt.success),p.xp6(),p.Q6J("ngIf",t.attempt.maxscore),p.xp6(),p.Q6J("ngIf",t.attempt.results)}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_0_Template(t,e){if(1&t&&(p.TgZ(0,"p"),p._UZ(1,"ion-icon",34),p.ALo(2,"translate"),p._uU(3),p.qZA()),2&t){const t=p.oxw().answer;p.xp6(),p.uIk("aria-label",p.lcZ(2,2,"addon.mod_h5pactivity.answer_correct")),p.xp6(2),p.hij(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_1_Template(t,e){if(1&t&&(p.TgZ(0,"p"),p._UZ(1,"ion-icon",35),p.ALo(2,"translate"),p._uU(3),p.qZA()),2&t){const t=p.oxw().answer;p.xp6(),p.uIk("aria-label",p.lcZ(2,2,"addon.mod_h5pactivity.answer_incorrect")),p.xp6(2),p.hij(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_2_Template(t,e){if(1&t&&(p.TgZ(0,"p"),p._uU(1),p.qZA()),2&t){const t=p.oxw().answer;p.xp6(),p.hij(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_3_Template(t,e){1&t&&(p.TgZ(0,"p"),p._UZ(1,"ion-icon",36),p.ALo(2,"translate"),p.qZA()),2&t&&(p.xp6(),p.uIk("aria-label",p.lcZ(2,1,"addon.mod_h5pactivity.answer_checked")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_4_Template(t,e){1&t&&(p.TgZ(0,"p"),p._UZ(1,"ion-icon",34),p.ALo(2,"translate"),p.qZA()),2&t&&(p.xp6(),p.uIk("aria-label",p.lcZ(2,1,"addon.mod_h5pactivity.answer_pass")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_5_Template(t,e){1&t&&(p.TgZ(0,"p"),p._UZ(1,"ion-icon",35),p.ALo(2,"translate"),p.qZA()),2&t&&(p.xp6(),p.uIk("aria-label",p.lcZ(2,1,"addon.mod_h5pactivity.answer_fail")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_Template(t,e){if(1&t&&p.YNc(0,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_0_Template,4,4,"p",6)(1,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_1_Template,4,4,"p",6)(2,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_2_Template,2,1,"p",6)(3,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_3_Template,3,3,"p",6)(4,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_4_Template,3,3,"p",6)(5,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_5_Template,3,3,"p",6),2&t){const t=e.answer;p.Q6J("ngIf",t.correct),p.xp6(),p.Q6J("ngIf",t.incorrect),p.xp6(),p.Q6J("ngIf",t.text),p.xp6(),p.Q6J("ngIf",t.checked),p.xp6(),p.Q6J("ngIf",t.pass),p.xp6(),p.Q6J("ngIf",t.fail)}}let O=(()=>{var t;class AddonModH5PActivityAttemptResultsPage{constructor(){var t=this;this.loaded=!1,this.component=Z.Rp.COMPONENT,this.logView=I.V.once((0,r.Z)((function*(){t.h5pActivity&&(yield x.Tr.ignoreErrors(Z.X6.logViewReport(t.h5pActivity.id,{attemptId:t.attemptId})),T.ke.logEvent({type:T.gM.VIEW_ITEM,ws:"mod_h5pactivity_log_report_viewed",name:t.h5pActivity.name,data:{id:t.h5pActivity.id,attemptid:t.attemptId,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${t.h5pActivity.id}&attemptid=${t.attemptId}`}))})))}ngOnInit(){var t=this;return(0,r.Z)((function*(){try{t.courseId=f.b.getRequiredRouteNumberParam("courseId"),t.cmId=f.b.getRequiredRouteNumberParam("cmId"),t.attemptId=f.b.getRequiredRouteNumberParam("attemptId")}catch(t){return _.OQ.showErrorModal(t),f.b.back(),void 0}yield t.fetchData()}))()}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(){var t=this;return(0,r.Z)((function*(){try{t.h5pActivity=yield Z.X6.getH5PActivity(t.courseId,t.cmId),t.attempt=yield Z.X6.getAttemptResults(t.h5pActivity.id,t.attemptId,{cmId:t.cmId}),yield t.fetchUserProfile(),t.logView()}catch(t){_.OQ.showErrorModalDefault(t,"Error loading attempt.")}finally{t.loaded=!0}}))()}fetchUserProfile(){var t=this;return(0,r.Z)((function*(){if(t.attempt)try{t.user=yield v.My.getProfile(t.attempt.userid,t.courseId,!0)}catch{}}))()}refreshData(){var t=this;return(0,r.Z)((function*(){const e=[Z.X6.invalidateActivityData(t.courseId)];t.h5pActivity&&e.push(Z.X6.invalidateAttemptResults(t.h5pActivity.id,t.attemptId)),yield x.Tr.ignoreErrors(Promise.all(e)),yield t.fetchData()}))()}}return(t=AddonModH5PActivityAttemptResultsPage).ɵfac=function AddonModH5PActivityAttemptResultsPage_Factory(e){return new(e||t)},t.ɵcmp=p.Xpm({type:t,selectors:[["page-addon-mod-h5pactivity-attempt-results"]],decls:16,vars:10,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["answerTemplate",""],["contextLevel","module",3,"text","contextInstanceId","courseId"],["class","ion-text-wrap","core-user-link","",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],[1,"addon-mod_h5pactivity-attempt-result-summary"],[1,"ion-text-wrap"],[1,"item-heading"],["core-user-link","",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","courseId","linkProfile"],["src","assets/img/completion/completion-auto-y.svg","role","presentation","alt",""],["src","assets/img/completion/completion-auto-n.svg","role","presentation","alt",""],["name","fas-circle-check","aria-hidden","true"],["name","far-circle","aria-hidden","true"],[4,"ngFor","ngForOf"],["contextLevel","module",3,"text","component","componentId","contextInstanceId","courseId"],["class","ion-text-wrap core-warning-item",4,"ngIf"],[1,"ion-text-wrap","addon-mod_h5pactivity-result-table-header"],[1,"ion-align-items-center"],[1,"ion-text-start"],[1,"ion-text-center"],["class","ion-text-wrap addon-mod_h5pactivity-result-table-row",4,"ngFor","ngForOf"],["class","ion-text-wrap ion-text-end addon-mod_h5pactivity-result-score",4,"ngIf"],[1,"ion-text-wrap","addon-mod_h5pactivity-result-table-row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ion-text-wrap","ion-text-end","addon-mod_h5pactivity-result-score"],[1,"ion-text-wrap","core-warning-item"],["slot","start","name","fas-triangle-exclamation","color","warning","aria-hidden","true"],["name","fas-check","color","success"],["name","fas-xmark","color","danger"],["name","fas-circle-check"]],template:function AddonModH5PActivityAttemptResultsPage_Template(t,e){1&t&&(p.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),p._UZ(3,"ion-back-button",1),p.ALo(4,"translate"),p.qZA(),p.TgZ(5,"ion-title")(6,"h1"),p.YNc(7,AddonModH5PActivityAttemptResultsPage_core_format_text_7_Template,1,3,"core-format-text",2),p.qZA()()()(),p.TgZ(8,"ion-content")(9,"ion-refresher",3),p.NdJ("ionRefresh",(function AddonModH5PActivityAttemptResultsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),p._UZ(10,"ion-refresher-content",4),p.ALo(11,"translate"),p.qZA(),p.TgZ(12,"core-loading",5),p.YNc(13,AddonModH5PActivityAttemptResultsPage_ng_container_13_Template,37,26,"ng-container",6),p.qZA()(),p.YNc(14,AddonModH5PActivityAttemptResultsPage_ng_template_14_Template,6,6,"ng-template",null,7,p.W1O)),2&t&&(p.xp6(3),p.Q6J("text",p.lcZ(4,6,"core.back")),p.xp6(4),p.Q6J("ngIf",e.h5pActivity),p.xp6(2),p.Q6J("disabled",!e.loaded),p.xp6(),p.s9C("pullingText",p.lcZ(11,8,"core.pulltorefresh")),p.xp6(2),p.Q6J("hideUntil",e.loaded),p.xp6(),p.Q6J("ngIf",e.attempt))},dependencies:[M.sg,M.O5,M.tP,w.r,H.X,b.I,m.r,q.j,u.t,A.Sm,A.PM,A.Zi,A.Dq,A.wI,A.W2,A.Gu,A.gu,A.Ie,A.Q$,A.q_,A.nJ,A.Wo,A.Nd,A.wd,A.sr,A.oU,R.o,y.X$],styles:["[_nghost-%COMP%]   .core-warning-item[_ngcontent-%COMP%]{--inner-border-width: 0px}[_nghost-%COMP%]   .addon-mod_h5pactivity-attempt-result-summary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;height:16px;display:inline;margin-inline-start:0;margin-inline-end:4px}[_nghost-%COMP%]   .addon-mod_h5pactivity-attempt-result-summary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2em}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-header[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n){--background: var(--light)}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-score[_ngcontent-%COMP%]{border-top:1px solid black}html.dark[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n), html.dark   [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n){--background: var(--gray-900)}"]}),AddonModH5PActivityAttemptResultsPage})();var J=n(52133);function AddonModH5PActivityUsersAttemptsPage_core_format_text_7_Template(t,e){if(1&t&&p._UZ(0,"core-format-text",9),2&t){const t=p.oxw();p.Q6J("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_9_Template(t,e){if(1&t&&(p.TgZ(0,"span"),p._uU(1),p.ALo(2,"coreFormatDate"),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(),p.hij(" ",p.xi3(2,1,t.attempts[t.attempts.length-1].timemodified,"strftimedatetimeshort")," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_10_Template(t,e){1&t&&(p.TgZ(0,"span"),p._uU(1,"-"),p.qZA())}const users_attempts_c0=t=>({$a:t});function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_12_Template(t,e){if(1&t&&(p.TgZ(0,"span"),p._uU(1),p.ALo(2,"translate"),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(),p.hij(" ",p.xi3(2,1,"core.percentagenumber",p.VKq(4,users_attempts_c0,t.score))," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_13_Template(t,e){1&t&&(p.TgZ(0,"span"),p._uU(1,"-"),p.qZA())}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"ion-item",15),p.NdJ("click",(function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template_ion_item_click_0_listener(){const e=p.CHM(t).$implicit,n=p.oxw(2);return p.KtG(n.openUser(e))})),p.ALo(1,"translate"),p.TgZ(2,"ion-label")(3,"ion-row",11)(4,"ion-col",12)(5,"p"),p._UZ(6,"core-user-avatar",16),p.qZA(),p._uU(7),p.qZA(),p.TgZ(8,"ion-col",12),p.YNc(9,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_9_Template,3,4,"span",6)(10,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_10_Template,2,0,"span",6),p.qZA(),p.TgZ(11,"ion-col",13),p.YNc(12,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_12_Template,3,6,"span",6)(13,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_13_Template,2,0,"span",6),p.qZA(),p.TgZ(14,"ion-col",13),p._uU(15),p.qZA()()()()}if(2&t){const t=e.$implicit,n=p.oxw(2);p.ekj("hide-detail",!t.attempts.length),p.Q6J("detail",!0)("button",t.attempts.length>0),p.uIk("aria-label",p.xi3(1,13,"addon.mod_h5pactivity.review_user_attempts",p.VKq(16,users_attempts_c0,t.attempts.length))),p.xp6(6),p.Q6J("user",t.user)("courseId",n.courseId),p.xp6(),p.hij(" ",t.user.fullname," "),p.xp6(2),p.Q6J("ngIf",t.attempts.length),p.xp6(),p.Q6J("ngIf",!t.attempts.length),p.xp6(2),p.Q6J("ngIf",void 0!==t.score),p.xp6(),p.Q6J("ngIf",void 0===t.score),p.xp6(2),p.hij(" ",t.attempts.length," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_Template(t,e){if(1&t&&(p.TgZ(0,"ion-list")(1,"ion-item",10)(2,"ion-label")(3,"ion-row",11)(4,"ion-col",12),p._uU(5),p.ALo(6,"translate"),p.qZA(),p.TgZ(7,"ion-col",12),p._uU(8),p.ALo(9,"translate"),p.qZA(),p.TgZ(10,"ion-col",13),p._uU(11),p.ALo(12,"translate"),p.qZA(),p.TgZ(13,"ion-col",13),p._uU(14),p.ALo(15,"translate"),p.qZA()()()(),p.YNc(16,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template,16,18,"ion-item",14),p.qZA()),2&t){const t=p.oxw();p.xp6(),p.Q6J("detail",!0),p.xp6(4),p.Oqu(p.lcZ(6,6,"core.user")),p.xp6(3),p.Oqu(p.lcZ(9,8,"core.date")),p.xp6(3),p.Oqu(p.lcZ(12,10,"addon.mod_h5pactivity.score")),p.xp6(3),p.Oqu(p.lcZ(15,12,"addon.mod_h5pactivity.attempts")),p.xp6(2),p.Q6J("ngForOf",t.users)}}function AddonModH5PActivityUsersAttemptsPage_core_empty_box_14_Template(t,e){1&t&&(p._UZ(0,"core-empty-box",17),p.ALo(1,"translate")),2&t&&p.Q6J("message",p.lcZ(1,1,"addon.mod_h5pactivity.noparticipants"))}let L=(()=>{var t;class AddonModH5PActivityUsersAttemptsPage{constructor(){var t=this;this.loaded=!1,this.users=[],this.fetchMoreUsersFailed=!1,this.canLoadMore=!1,this.page=0,this.logView=I.V.once((0,r.Z)((function*(){t.h5pActivity&&(yield x.Tr.ignoreErrors(Z.X6.logViewReport(t.h5pActivity.id)),T.ke.logEvent({type:T.gM.VIEW_ITEM_LIST,ws:"mod_h5pactivity_log_report_viewed",name:t.h5pActivity.name,data:{id:t.h5pActivity.id,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${t.h5pActivity.id}`}))})))}ngOnInit(){var t=this;return(0,r.Z)((function*(){try{t.courseId=f.b.getRequiredRouteNumberParam("courseId"),t.cmId=f.b.getRequiredRouteNumberParam("cmId")}catch(t){return _.OQ.showErrorModal(t),f.b.back(),void 0}t.fetchData()}))()}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(t){var e=this;return(0,r.Z)((function*(){try{e.h5pActivity=yield Z.X6.getH5PActivity(e.courseId,e.cmId),yield Promise.all([e.fetchUsers(t)]),e.logView()}catch(t){_.OQ.showErrorModalDefault(t,"Error loading attempts.")}finally{e.loaded=!0}}))()}fetchUsers(t){var e=this;return(0,r.Z)((function*(){if(!e.h5pActivity)return;t&&(e.page=0);const n=yield Z.X6.getUsersAttempts(e.h5pActivity.id,{cmId:e.cmId,page:e.page}),o=yield e.formatUsers(e.h5pActivity,n.users);e.users=0===e.page?o:e.users.concat(o),e.canLoadMore=n.canLoadMore,e.page++}))()}formatUsers(t,e){var n=this;return(0,r.Z)((function*(){return Promise.all(e.map(function(){var e=(0,r.Z)((function*(e){var o;if(e.user=yield v.My.getProfile(e.userid,n.courseId,!0),t.grademethod===Z.Rp.GRADEMANUAL);else if(t.grademethod===Z.Rp.GRADEAVERAGEATTEMPT){if(e.attempts.length){const t=e.attempts.reduce(((t,e)=>t+100*e.rawscore/e.maxscore),0);e.score=Math.round(t/e.attempts.length)}}else null!==(o=e.scored)&&void 0!==o&&o.attempts[0]&&(e.score=Math.round(100*e.scored.attempts[0].rawscore/e.scored.attempts[0].maxscore));return e}));return function(t){return e.apply(this,arguments)}}()))}))()}fetchMoreUsers(t){var e=this;return(0,r.Z)((function*(){try{yield e.fetchUsers(!1)}catch(t){_.OQ.showErrorModalDefault(t,"Error loading more users"),e.fetchMoreUsersFailed=!0}t()}))()}refreshData(){var t=this;return(0,r.Z)((function*(){const e=[Z.X6.invalidateActivityData(t.courseId)];t.h5pActivity&&e.push(Z.X6.invalidateAllUsersAttempts(t.h5pActivity.id)),yield x.Tr.ignoreErrors(Promise.all(e)),yield t.fetchData(!0)}))()}openUser(t){t.attempts.length&&f.b.navigate(`../userattempts/${t.userid}`)}}return(t=AddonModH5PActivityUsersAttemptsPage).ɵfac=function AddonModH5PActivityUsersAttemptsPage_Factory(e){return new(e||t)},t.ɵcmp=p.Xpm({type:t,selectors:[["page-addon-mod-h5pactivity-users-attempts"]],decls:16,vars:13,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["icon","fas-chart-bar",3,"message",4,"ngIf"],[3,"enabled","error","action"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"addon-mod_h5pactivity-table-header","hide-detail","font-bold",3,"detail"],[1,"ion-align-items-center"],["size","4",1,"ion-text-center"],["size","2",1,"ion-text-center"],["class","ion-text-wrap addon-mod_h5pactivity-table-row",3,"detail","hide-detail","button","click",4,"ngFor","ngForOf"],[1,"ion-text-wrap","addon-mod_h5pactivity-table-row",3,"detail","button","click"],[3,"user","courseId"],["icon","fas-chart-bar",3,"message"]],template:function AddonModH5PActivityUsersAttemptsPage_Template(t,e){1&t&&(p.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),p._UZ(3,"ion-back-button",1),p.ALo(4,"translate"),p.qZA(),p.TgZ(5,"ion-title")(6,"h1"),p.YNc(7,AddonModH5PActivityUsersAttemptsPage_core_format_text_7_Template,1,3,"core-format-text",2),p.qZA()()()(),p.TgZ(8,"ion-content")(9,"ion-refresher",3),p.NdJ("ionRefresh",(function AddonModH5PActivityUsersAttemptsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),p._UZ(10,"ion-refresher-content",4),p.ALo(11,"translate"),p.qZA(),p.TgZ(12,"core-loading",5),p.YNc(13,AddonModH5PActivityUsersAttemptsPage_ion_list_13_Template,17,14,"ion-list",6)(14,AddonModH5PActivityUsersAttemptsPage_core_empty_box_14_Template,2,3,"core-empty-box",7),p.TgZ(15,"core-infinite-loading",8),p.NdJ("action",(function AddonModH5PActivityUsersAttemptsPage_Template_core_infinite_loading_action_15_listener(t){return e.fetchMoreUsers(t)})),p.qZA()()()),2&t&&(p.xp6(3),p.Q6J("text",p.lcZ(4,9,"core.back")),p.xp6(4),p.Q6J("ngIf",e.h5pActivity),p.xp6(2),p.Q6J("disabled",!e.loaded),p.xp6(),p.s9C("pullingText",p.lcZ(11,11,"core.pulltorefresh")),p.xp6(2),p.Q6J("hideUntil",e.loaded),p.xp6(),p.Q6J("ngIf",e.users.length),p.xp6(),p.Q6J("ngIf",!e.users.length&&!e.canLoadMore),p.xp6(),p.Q6J("enabled",e.loaded&&e.canLoadMore)("error",e.fetchMoreUsersFailed))},dependencies:[M.sg,M.O5,U.z,J.n,w.r,H.X,m.r,u.t,A.Sm,A.wI,A.W2,A.Gu,A.Ie,A.Q$,A.q_,A.nJ,A.Wo,A.Nd,A.wd,A.sr,A.oU,R.o,y.X$],styles:["[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}"]}),AddonModH5PActivityUsersAttemptsPage})();const k=[{path:":courseId/:cmId",component:h,canDeactivate:[a.Y]},{path:":courseId/:cmId/userattempts/:userId",component:Q},{path:":courseId/:cmId/attemptresults/:attemptId",component:O},{path:":courseId/:cmId/users",component:L}];let C=(()=>{var t;class AddonModH5PActivityLazyModule{}return(t=AddonModH5PActivityLazyModule).ɵfac=function AddonModH5PActivityLazyModule_Factory(e){return new(e||t)},t.ɵmod=p.oAB({type:t}),t.ɵinj=p.cJS({imports:[o.Bz.forChild(k),i.L,c.Y]}),AddonModH5PActivityLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&p.kYT(C,{declarations:[h,Q,O,L],imports:[o.Bz,i.L,c.Y]}))}}]);