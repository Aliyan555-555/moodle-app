"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9234],{89234:(e,t,o)=>{o.r(t),o.d(t,{AddonModChatLazyModule:()=>oe});var n=o(67643),s=o(13386),a=o(66693),i=o(98712),r=o(62382),d=o(19212),c=o(8947),l=o(60067),g=o(29657),_=o(31903),m=o(89515);let u=(()=>{var e;class AddonModChatIndexPage extends i.S{}return(e=AddonModChatIndexPage).ɵfac=(()=>{let t;return function AddonModChatIndexPage_Factory(o){return(t||(t=d.n5z(e)))(o||e)}})(),e.ɵcmp=d.Xpm({type:e,selectors:[["page-addon-mod-chat-index"]],viewQuery:function AddonModChatIndexPage_Query(e,t){if(1&e&&d.Gf(r.Y,5),2&e){let e;d.iGM(e=d.CRH())&&(t.activityComponent=e.first)}},features:[d.qOj],decls:14,vars:12,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","dataRetrieved"]],template:function AddonModChatIndexPage_Template(e,t){1&e&&(d.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),d._UZ(3,"ion-back-button",2),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"ion-title")(6,"h1"),d._UZ(7,"core-format-text",3),d.qZA()(),d._UZ(8,"ion-buttons",4),d.qZA()(),d.TgZ(9,"ion-content",5)(10,"ion-refresher",6),d.NdJ("ionRefresh",(function AddonModChatIndexPage_Template_ion_refresher_ionRefresh_10_listener(e){return null==t.activityComponent?null:t.activityComponent.doRefresh(e.target)})),d._UZ(11,"ion-refresher-content",7),d.ALo(12,"translate"),d.qZA(),d.TgZ(13,"addon-mod-chat-index",8),d.NdJ("dataRetrieved",(function AddonModChatIndexPage_Template_addon_mod_chat_index_dataRetrieved_13_listener(e){return t.updateData(e)})),d.qZA()()),2&e&&(d.xp6(3),d.Q6J("text",d.lcZ(4,8,"core.back")),d.xp6(4),d.Q6J("text",t.title)("contextInstanceId",t.module.id)("courseId",t.courseId),d.xp6(3),d.Q6J("disabled",null==t.activityComponent?null:t.activityComponent.showLoading),d.xp6(),d.s9C("pullingText",d.lcZ(12,10,"core.pulltorefresh")),d.xp6(2),d.Q6J("module",t.module)("courseId",t.courseId))},dependencies:[c.r,l.e,g.t,_.Sm,_.W2,_.Gu,_.nJ,_.Wo,_.wd,_.sr,_.oU,r.Y,m.X$],encapsulation:2}),AddonModChatIndexPage})();var h=o(49671),p=o(30300),f=o(29540),x=o(81370),I=o(43555),M=o(53564),A=o(13010),C=o(75803),b=o(10727),T=o(98370),Z=o(39515),P=o(81538),v=o(99539),w=o(88817),y=o(43468),S=o(96814),U=o(55126),q=o(66931),Q=o(61968),J=o(86700),O=o(22068),L=o(83369);function AddonModChatChatPage_ion_button_9_Template(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",(function AddonModChatChatPage_ion_button_9_Template_ion_button_click_0_listener(){d.CHM(e);const t=d.oxw();return d.KtG(t.showChatUsers())})),d.ALo(1,"translate"),d._UZ(2,"ion-icon",15),d.qZA()}2&e&&d.uIk("aria-label",d.lcZ(1,1,"core.users"))}function AddonModChatChatPage_ng_container_13_p_1_Template(e,t){if(1&e&&(d.TgZ(0,"p",19),d._uU(1),d.ALo(2,"coreFormatDate"),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(),d.hij(" ",d.xi3(2,1,1e3*e.timestamp,"strftimedayshort")," ")}}const _c0=e=>({$a:e});function AddonModChatChatPage_ng_container_13_div_2_ion_badge_1_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",26)(1,"span"),d._UZ(2,"ion-icon",27),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messageenter",d.VKq(8,_c0,e.userfullname))," ")}}function AddonModChatChatPage_ng_container_13_div_2_ion_badge_2_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",28)(1,"span"),d._UZ(2,"ion-icon",29),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messageexit",d.VKq(8,_c0,e.userfullname))," ")}}function AddonModChatChatPage_ng_container_13_div_2_ion_badge_3_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",30)(1,"span"),d._UZ(2,"ion-icon",31),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messagebeepseveryone",d.VKq(8,_c0,e.userfullname))," ")}}function AddonModChatChatPage_ng_container_13_div_2_ion_badge_4_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",30)(1,"span"),d._UZ(2,"ion-icon",31),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messagebeepsyou",d.VKq(8,_c0,e.userfullname))," ")}}function AddonModChatChatPage_ng_container_13_div_2_ion_badge_5_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",32)(1,"span"),d._UZ(2,"ion-icon",31),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messageyoubeep",d.VKq(8,_c0,e.beepWho))," ")}}function AddonModChatChatPage_ng_container_13_div_2_ion_badge_6_Template(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-badge",33)(1,"span"),d._UZ(2,"ion-icon",34),d._uU(3),d.ALo(4,"coreFormatDate"),d.TgZ(5,"strong"),d._uU(6),d.TgZ(7,"core-format-text",35),d.NdJ("afterRender",(function AddonModChatChatPage_ng_container_13_div_2_ion_badge_6_Template_core_format_text_afterRender_7_listener(){d.CHM(e);const t=d.oxw(2).last,o=d.oxw();return d.KtG(t&&o.scrollToBottom())})),d.qZA()()()()}if(2&e){const e=d.oxw(2).$implicit,t=d.oxw();d.xp6(3),d.hij(" ",d.xi3(4,5,1e3*e.timestamp,"strftimetime")," "),d.xp6(3),d.hij(" ",e.userfullname," "),d.xp6(),d.Q6J("text",e.message)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModChatChatPage_ng_container_13_div_2_Template(e,t){if(1&e&&(d.TgZ(0,"div",20),d.YNc(1,AddonModChatChatPage_ng_container_13_div_2_ion_badge_1_Template,6,10,"ion-badge",21)(2,AddonModChatChatPage_ng_container_13_div_2_ion_badge_2_Template,6,10,"ion-badge",22)(3,AddonModChatChatPage_ng_container_13_div_2_ion_badge_3_Template,6,10,"ion-badge",23)(4,AddonModChatChatPage_ng_container_13_div_2_ion_badge_4_Template,6,10,"ion-badge",23)(5,AddonModChatChatPage_ng_container_13_div_2_ion_badge_5_Template,6,10,"ion-badge",24)(6,AddonModChatChatPage_ng_container_13_div_2_ion_badge_6_Template,8,8,"ion-badge",25),d.qZA()),2&e){const e=d.oxw().$implicit,t=d.oxw();d.xp6(),d.Q6J("ngIf",e.system&&"enter"===e.message),d.xp6(),d.Q6J("ngIf",e.system&&"exit"===e.message),d.xp6(),d.Q6J("ngIf","all"===e.beep),d.xp6(),d.Q6J("ngIf",e.userid!==t.currentUserId&&e.beep===t.currentUserId),d.xp6(),d.Q6J("ngIf",e.userid===t.currentUserId&&e.beep&&"all"!==e.beep),d.xp6(),d.Q6J("ngIf",!e.system&&!e.beep)}}function AddonModChatChatPage_ng_container_13_core_message_3_Template(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"core-message",36),d.NdJ("afterRender",(function AddonModChatChatPage_ng_container_13_core_message_3_Template_core_message_afterRender_0_listener(){d.CHM(e);const t=d.oxw().last,o=d.oxw();return d.KtG(t&&o.scrollToBottom())})),d.qZA()}if(2&e){const e=d.oxw().$implicit,t=d.oxw();d.Q6J("message",e)("user",e)("text",e.message)("time",1e3*e.timestamp)("instanceId",t.cmId)("courseId",t.courseId)}}function AddonModChatChatPage_ng_container_13_Template(e,t){if(1&e&&(d.ynx(0),d.YNc(1,AddonModChatChatPage_ng_container_13_p_1_Template,3,4,"p",16)(2,AddonModChatChatPage_ng_container_13_div_2_Template,7,6,"div",17)(3,AddonModChatChatPage_ng_container_13_core_message_3_Template,1,6,"core-message",18),d.BQk()),2&e){const e=t.$implicit;d.xp6(),d.Q6J("ngIf",e.showDate),d.xp6(),d.Q6J("ngIf",e.special),d.xp6(),d.Q6J("ngIf",!e.special)}}function AddonModChatChatPage_core_empty_box_14_Template(e,t){1&e&&(d._UZ(0,"core-empty-box",37),d.ALo(1,"translate")),2&e&&d.Q6J("message",d.lcZ(1,1,"addon.mod_chat.nomessages"))}function AddonModChatChatPage_p_17_Template(e,t){1&e&&(d.TgZ(0,"p",38),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(),d.hij(" ",d.lcZ(2,1,"addon.mod_chat.mustbeonlinetosendmessages")," "))}function AddonModChatChatPage_core_send_message_form_18_Template(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"core-send-message-form",39),d.NdJ("onSubmit",(function AddonModChatChatPage_core_send_message_form_18_Template_core_send_message_form_onSubmit_0_listener(t){d.CHM(e);const o=d.oxw();return d.KtG(o.sendMessage(t))})),d.ALo(1,"translate"),d.qZA()}if(2&e){const e=d.oxw();d.Q6J("sendDisabled",e.sending)("message",e.newMessage)("placeholder",d.lcZ(1,3,"addon.messages.newmessage"))}}function AddonModChatChatPage_ion_button_19_Template(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-button",40),d.NdJ("click",(function AddonModChatChatPage_ion_button_19_Template_ion_button_click_0_listener(){d.CHM(e);const t=d.oxw();return d.KtG(t.reconnect())})),d._uU(1),d.ALo(2,"translate"),d.qZA()}2&e&&(d.xp6(),d.hij(" ",d.lcZ(2,1,"core.login.reconnect")," "))}let k=(()=>{var e;class AddonModChatChatPage{constructor(){this.loaded=!1,this.title="",this.messages=[],this.sending=!1,this.lastTime=0,this.oldContentHeight=0,this.viewDestroyed=!1,this.pollingRunning=!1,this.users=[],this.currentUserId=M.m9.getCurrentSiteUserId(),this.isOnline=x.AS.isOnline(),this.onlineSubscription=x.AS.onChange().subscribe((()=>{b.R0.run((()=>{this.isOnline=x.AS.isOnline()}))})),this.logView=w.V.once((()=>{y.ke.logEvent({type:y.gM.VIEW_ITEM_LIST,ws:"mod_chat_get_chat_latest_messages",name:this.title,data:{chatid:this.chatId,category:"chat"},url:`/mod/chat/gui_ajax/index.php?id=${this.chatId}`})}))}ngOnInit(){var e=this;return(0,h.Z)((function*(){try{e.courseId=I.b.getRequiredRouteNumberParam("courseId"),e.cmId=I.b.getRequiredRouteNumberParam("cmId"),e.chatId=I.b.getRequiredRouteNumberParam("chatId"),e.title=I.b.getRouteParam("title")||"",yield e.loginUser(),yield e.fetchMessages(),e.startPolling(),e.logView()}catch(e){A.OQ.showErrorModalDefault(e,"addon.mod_chat.errorwhileconnecting",!0),I.b.back()}finally{e.loaded=!0}}))()}ionViewDidEnter(){this.startPolling()}ionViewWillLeave(){T.R.trigger(T.R.ACTIVITY_DATA_SENT,{module:"chat"}),this.stopPolling()}loginUser(){var e=this;return(0,h.Z)((function*(){e.sessionId=yield P.Y.loginUser(e.chatId)}))()}fetchMessages(){var e=this;return(0,h.Z)((function*(){const t=yield P.Y.getLatestMessages(e.sessionId,e.lastTime);e.lastTime=t.chatnewlasttime||0;const o=yield P.Y.getMessagesUserData(t.messages,e.courseId);if(!o.length)return;const n=e.messages.length;e.messages=e.messages.concat(o);for(let t=n;t<e.messages.length;t++){e.messages[t]=v.L.formatMessage(e.currentUserId,e.messages[t],t>0?e.messages[t-1]:void 0);const o=e.messages[t];o.beep&&o.beep!=String(e.currentUserId)&&e.loadMessageBeepWho(o)}e.messages[e.messages.length-1].showTail=!0,e.scrollToBottom()}))()}loadMessageBeepWho(e){var t=this;return(0,h.Z)((function*(){e.beepWho=yield t.getUserFullname(e.beep)}))()}showChatUsers(){var e=this;return(0,h.Z)((function*(){const t=yield A.OQ.openSideModal({component:Z.S,componentProps:{sessionId:e.sessionId,cmId:e.cmId}});if(t){var o;if(t.talkTo)e.newMessage=`To ${t.talkTo}: `+((null===(o=e.sendMessageForm)||void 0===o?void 0:o.message)||"");t.beepTo&&e.sendMessage("",t.beepTo),e.users=t.users}}))()}getUserFullname(e){var t=this;return(0,h.Z)((function*(){const o=parseInt(e,10);if(isNaN(o))return e;const n=t.users.find((e=>e.id==o));if(n)return n.fullname;try{const n=yield P.Y.getChatUsers(t.sessionId,{cmId:t.cmId});t.users=n.users;const s=t.users.find((e=>e.id==o));return s?s.fullname:e}catch{return e}}))()}startPolling(){this.polling||(this.polling=window.setInterval((()=>{C.Tr.ignoreErrors(this.fetchMessagesInterval())}),P.m.POLL_INTERVAL))}stopPolling(){clearInterval(this.polling),this.polling=void 0}fetchMessagesInterval(){var e=this;return(0,h.Z)((function*(){if(e.isOnline&&!e.pollingRunning){e.pollingRunning=!0;try{yield e.fetchMessages()}catch{try{yield e.loginUser(),yield e.fetchMessages()}catch(t){throw e.stopPolling(),A.OQ.showErrorModalDefault(t,"addon.mod_chat.errorwhileretrievingmessages",!0),t}}finally{e.pollingRunning=!1}}}))()}sendMessage(e,t=0){var o=this;return(0,h.Z)((function*(){if(o.isOnline&&(0!==t||e.trim())){o.sending=!0;try{yield P.Y.sendMessage(o.sessionId,e,t),C.Tr.ignoreErrors(o.fetchMessagesInterval())}catch(t){f.z.closeKeyboard(),o.newMessage=e,A.OQ.showErrorModalDefault(t,"addon.mod_chat.errorwhilesendingmessage",!0)}finally{o.sending=!1}}}))()}reconnect(){var e=this;return(0,h.Z)((function*(){const t=yield A.OQ.showModalLoading();try{yield e.fetchMessagesInterval(),e.startPolling()}catch{}finally{t.dismiss()}}))()}scrollToBottom(){var e=this;return(0,h.Z)((function*(){var t;(yield C.Tr.nextTick(),e.viewDestroyed)||(null===(t=e.content)||void 0===t||t.scrollToBottom())}))()}canLeave(){var e=this;return(0,h.Z)((function*(){return!e.messages.some((e=>!e.special))||(yield A.OQ.showConfirm(b.vN.instant("addon.mod_chat.confirmloss")),!0)}))()}ngOnDestroy(){this.onlineSubscription&&this.onlineSubscription.unsubscribe(),this.stopPolling(),this.viewDestroyed=!0}}return(e=AddonModChatChatPage).ɵfac=function AddonModChatChatPage_Factory(t){return new(t||e)},e.ɵcmp=d.Xpm({type:e,selectors:[["page-addon-mod-chat-chat"]],viewQuery:function AddonModChatChatPage_Query(e,t){if(1&e&&(d.Gf(_.W2,5),d.Gf(p.j,5)),2&e){let e;d.iGM(e=d.CRH())&&(t.content=e.first),d.iGM(e=d.CRH())&&(t.sendMessageForm=e.first)}},decls:20,vars:14,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[3,"hideUntil"],["aria-live","polite",1,"addon-messages-discussion-container"],[4,"ngFor","ngForOf"],["icon","far-comments",3,"message",4,"ngIf"],[1,"footer-adjustable"],[3,"color"],["class","ion-text-center",4,"ngIf"],[3,"sendDisabled","message","placeholder","onSubmit",4,"ngIf"],["expand","block","fill","outline",3,"click",4,"ngIf"],["fill","clear",3,"click"],["name","fas-users","slot","icon-only","aria-hidden","true"],["class","ion-text-center addon-messages-date",4,"ngIf"],["class","ion-text-center addon-mod_chat-notice",4,"ngIf"],["contextLevel","module",3,"message","user","text","time","instanceId","courseId","afterRender",4,"ngIf"],[1,"ion-text-center","addon-messages-date"],[1,"ion-text-center","addon-mod_chat-notice"],["class","ion-text-wrap","color","success",4,"ngIf"],["class","ion-text-wrap","color","danger",4,"ngIf"],["class","ion-text-wrap","color","primary",4,"ngIf"],["class","ion-text-wrap","color","light",4,"ngIf"],["class","ion-text-wrap","color","info",4,"ngIf"],["color","success",1,"ion-text-wrap"],["name","fas-right-to-bracket","aria-hidden","true"],["color","danger",1,"ion-text-wrap"],["name","fas-right-from-bracket","aria-hidden","true"],["color","primary",1,"ion-text-wrap"],["name","fas-bell","aria-hidden","true"],["color","light",1,"ion-text-wrap"],["color","info",1,"ion-text-wrap"],["name","fas-asterisk","aria-hidden","true"],["contextLevel","module",3,"text","contextInstanceId","courseId","afterRender"],["contextLevel","module",3,"message","user","text","time","instanceId","courseId","afterRender"],["icon","far-comments",3,"message"],[1,"ion-text-center"],[3,"sendDisabled","message","placeholder","onSubmit"],["expand","block","fill","outline",3,"click"]],template:function AddonModChatChatPage_Template(e,t){1&e&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d._UZ(3,"ion-back-button",1),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"ion-title")(6,"h1"),d._UZ(7,"core-format-text",2),d.qZA()(),d.TgZ(8,"ion-buttons",3),d.YNc(9,AddonModChatChatPage_ion_button_9_Template,3,3,"ion-button",4),d.qZA()()(),d.TgZ(10,"ion-content")(11,"core-loading",5)(12,"ion-list",6),d.YNc(13,AddonModChatChatPage_ng_container_13_Template,4,3,"ng-container",7),d.qZA(),d.YNc(14,AddonModChatChatPage_core_empty_box_14_Template,2,3,"core-empty-box",8),d.qZA()(),d.TgZ(15,"ion-footer",9)(16,"ion-toolbar",10),d.YNc(17,AddonModChatChatPage_p_17_Template,3,3,"p",11)(18,AddonModChatChatPage_core_send_message_form_18_Template,2,5,"core-send-message-form",12)(19,AddonModChatChatPage_ion_button_19_Template,3,3,"ion-button",13),d.qZA()()),2&e&&(d.xp6(3),d.Q6J("text",d.lcZ(4,12,"core.back")),d.xp6(4),d.Q6J("text",t.title)("contextInstanceId",t.cmId)("courseId",t.courseId),d.xp6(2),d.Q6J("ngIf",t.loaded),d.xp6(2),d.Q6J("hideUntil",t.loaded),d.xp6(2),d.Q6J("ngForOf",t.messages),d.xp6(),d.Q6J("ngIf",!t.messages||t.messages.length<=0),d.xp6(2),d.Q6J("color",t.isOnline&&t.polling&&t.loaded?null:"light"),d.xp6(),d.Q6J("ngIf",!t.isOnline),d.xp6(),d.Q6J("ngIf",t.isOnline&&t.polling&&t.loaded),d.xp6(),d.Q6J("ngIf",t.isOnline&&!t.polling&&t.loaded))},dependencies:[S.sg,S.O5,U.z,q.r,Q.F,p.j,J.I,c.r,g.t,O.O,_.yp,_.YG,_.Sm,_.W2,_.fr,_.Gu,_.gu,_.q_,_.wd,_.sr,_.oU,L.o,m.X$],styles:[".ios[_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child, .ios   [_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child{padding-bottom:4px;min-height:0}ion-content[_ngcontent-%COMP%]{--content-background: var(--background-alternative);--background: var(--content-background)}ion-content[_ngcontent-%COMP%]::part(scroll){padding-bottom:0!important}.addon-messages-discussion-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:16px!important;background:var(--content-background)}.addon-messages-date[_ngcontent-%COMP%]{font-weight:400;font-size:.9rem}","[_nghost-%COMP%]   .addon-mod_chat-notice[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:8px}"]}),AddonModChatChatPage})();var R=o(45151);function AddonModChatSessionMessagesPage_ng_container_15_div_1_Template(e,t){if(1&e&&(d.TgZ(0,"div",10),d._uU(1),d.ALo(2,"coreFormatDate"),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(),d.hij(" ",d.xi3(2,1,1e3*e.timestamp,"strftimedayshort")," ")}}const session_messages_c0=e=>({$a:e});function AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_1_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",17)(1,"span"),d._UZ(2,"ion-icon",18),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messageenter",d.VKq(8,session_messages_c0,e.userfullname))," ")}}function AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_2_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",19)(1,"span"),d._UZ(2,"ion-icon",20),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messageexit",d.VKq(8,session_messages_c0,e.userfullname))," ")}}function AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_3_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",21)(1,"span"),d._UZ(2,"ion-icon",22),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messagebeepseveryone",d.VKq(8,session_messages_c0,e.userfullname))," ")}}function AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_4_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",21)(1,"span"),d._UZ(2,"ion-icon",22),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messagebeepsyou",d.VKq(8,session_messages_c0,e.userfullname))," ")}}function AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_5_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",23)(1,"span"),d._UZ(2,"ion-icon",22),d._uU(3),d.ALo(4,"coreFormatDate"),d.ALo(5,"translate"),d.qZA()()),2&e){const e=d.oxw(2).$implicit;d.xp6(3),d.AsE(" ",d.xi3(4,2,1e3*e.timestamp,"strftimetime")," ",d.xi3(5,5,"addon.mod_chat.messageyoubeep",d.VKq(8,session_messages_c0,e.beepWho))," ")}}function AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_6_Template(e,t){if(1&e&&(d.TgZ(0,"ion-badge",24)(1,"span"),d._UZ(2,"ion-icon",25),d._uU(3),d.ALo(4,"coreFormatDate"),d.TgZ(5,"strong"),d._uU(6),d._UZ(7,"core-format-text",26),d.qZA()()()),2&e){const e=d.oxw(2).$implicit,t=d.oxw();d.xp6(3),d.hij(" ",d.xi3(4,5,1e3*e.timestamp,"strftimetime")," "),d.xp6(3),d.hij(" ",e.userfullname," "),d.xp6(),d.Q6J("text",e.message)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModChatSessionMessagesPage_ng_container_15_div_2_Template(e,t){if(1&e&&(d.TgZ(0,"div",11),d.YNc(1,AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_1_Template,6,10,"ion-badge",12)(2,AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_2_Template,6,10,"ion-badge",13)(3,AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_3_Template,6,10,"ion-badge",14)(4,AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_4_Template,6,10,"ion-badge",14)(5,AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_5_Template,6,10,"ion-badge",15)(6,AddonModChatSessionMessagesPage_ng_container_15_div_2_ion_badge_6_Template,8,8,"ion-badge",16),d.qZA()),2&e){const e=d.oxw().$implicit,t=d.oxw();d.xp6(),d.Q6J("ngIf",e.issystem&&"enter"===e.message),d.xp6(),d.Q6J("ngIf",e.issystem&&"exit"===e.message),d.xp6(),d.Q6J("ngIf","all"===e.beep),d.xp6(),d.Q6J("ngIf",e.userid!==t.currentUserId&&e.beep===t.currentUserId),d.xp6(),d.Q6J("ngIf",e.userid===t.currentUserId&&e.beep&&"all"!==e.beep),d.xp6(),d.Q6J("ngIf",!e.issystem&&!e.beep)}}function AddonModChatSessionMessagesPage_ng_container_15_core_message_3_Template(e,t){if(1&e&&d._UZ(0,"core-message",27),2&e){const e=d.oxw().$implicit,t=d.oxw();d.Q6J("message",e)("user",e)("text",e.message)("time",1e3*e.timestamp)("instanceId",t.cmId)("courseId",t.courseId)}}function AddonModChatSessionMessagesPage_ng_container_15_Template(e,t){if(1&e&&(d.ynx(0),d.YNc(1,AddonModChatSessionMessagesPage_ng_container_15_div_1_Template,3,4,"div",7)(2,AddonModChatSessionMessagesPage_ng_container_15_div_2_Template,7,6,"div",8)(3,AddonModChatSessionMessagesPage_ng_container_15_core_message_3_Template,1,6,"core-message",9),d.BQk()),2&e){const e=t.$implicit;d.xp6(),d.Q6J("ngIf",e.showDate),d.xp6(),d.Q6J("ngIf",e.special),d.xp6(),d.Q6J("ngIf",!e.special)}}let E=(()=>{var e;class AddonModChatSessionMessagesPage{constructor(){var e=this;this.messages=[],this.loaded=!1,this.logView=w.V.once((0,h.Z)((function*(){yield C.Tr.ignoreErrors(P.Y.logViewSessions(e.cmId,{start:e.sessionStart,end:e.sessionEnd})),y.ke.logEvent({type:y.gM.VIEW_ITEM,ws:"mod_chat_view_sessions",name:b.vN.instant("addon.mod_chat.messages"),data:{chatid:e.chatId,category:"chat",start:e.sessionStart,end:e.sessionEnd},url:`/mod/chat/report.php?id=${e.cmId}&start=${e.sessionStart}&end=${e.sessionEnd}`})})))}ngOnInit(){try{this.courseId=I.b.getRequiredRouteNumberParam("courseId"),this.cmId=I.b.getRequiredRouteNumberParam("cmId"),this.sessionStart=I.b.getRequiredRouteNumberParam("sessionStart"),this.sessionEnd=I.b.getRequiredRouteNumberParam("sessionEnd"),this.chatId=I.b.getRequiredRouteNumberParam("chatId"),this.groupId=I.b.getRouteNumberParam("groupId")||0}catch(e){return A.OQ.showErrorModal(e),I.b.back(),void 0}this.currentUserId=M.m9.getCurrentSiteUserId(),this.fetchMessages()}fetchMessages(){var e=this;return(0,h.Z)((function*(){try{const t=yield P.Y.getSessionMessages(e.chatId,e.sessionStart,e.sessionEnd,e.groupId,{cmId:e.cmId});e.messages=yield P.Y.getMessagesUserData(t,e.courseId);for(let t=0;t<e.messages.length;t++){e.messages[t]=v.L.formatMessage(e.currentUserId,e.messages[t],t>0?e.messages[t-1]:void 0);const o=e.messages[t];o.beep&&o.beep!=String(e.currentUserId)&&e.loadMessageBeepWho(o)}e.messages[e.messages.length-1].showTail=!0}catch(e){A.OQ.showErrorModalDefault(e,"core.errorloadingcontent",!0)}finally{e.loaded=!0}}))()}loadMessageBeepWho(e){var t=this;return(0,h.Z)((function*(){e.beepWho=yield t.getUserFullname(e.beep)}))()}getUserFullname(e){var t=this;return(0,h.Z)((function*(){const o=parseInt(e,10);if(isNaN(o))return e;try{return(yield R.My.getProfile(o,t.courseId,!0)).fullname}catch{return e}}))()}refreshMessages(e){var t=this;return(0,h.Z)((function*(){try{yield C.Tr.ignoreErrors(P.Y.invalidateSessionMessages(t.chatId,t.sessionStart,t.groupId)),yield t.fetchMessages()}finally{e.complete()}}))()}}return(e=AddonModChatSessionMessagesPage).ɵfac=function AddonModChatSessionMessagesPage_Factory(t){return new(t||e)},e.ɵcmp=d.Xpm({type:e,selectors:[["page-addon-mod-chat-session-messages"]],decls:16,vars:12,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"addon-messages-discussion-container"],[4,"ngFor","ngForOf"],["class","ion-text-center addon-messages-date",4,"ngIf"],["class","ion-text-center addon-mod_chat-notice",4,"ngIf"],["contextLevel","module",3,"message","user","text","time","instanceId","courseId",4,"ngIf"],[1,"ion-text-center","addon-messages-date"],[1,"ion-text-center","addon-mod_chat-notice"],["class","ion-text-wrap","color","success",4,"ngIf"],["class","ion-text-wrap","color","danger",4,"ngIf"],["class","ion-text-wrap","color","primary",4,"ngIf"],["class","ion-text-wrap","color","light",4,"ngIf"],["class","ion-text-wrap","color","info",4,"ngIf"],["color","success",1,"ion-text-wrap"],["name","fas-right-to-bracket","aria-hidden","true"],["color","danger",1,"ion-text-wrap"],["name","fas-right-from-bracket","aria-hidden","true"],["color","primary",1,"ion-text-wrap"],["name","fas-bell","aria-hidden","true"],["color","light",1,"ion-text-wrap"],["color","info",1,"ion-text-wrap"],["name","fas-asterisk","aria-hidden","true"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["contextLevel","module",3,"message","user","text","time","instanceId","courseId"]],template:function AddonModChatSessionMessagesPage_Template(e,t){1&e&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d._UZ(3,"ion-back-button",1),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"ion-title")(6,"h1"),d._uU(7),d.ALo(8,"translate"),d.qZA()()()(),d.TgZ(9,"ion-content")(10,"ion-refresher",2),d.NdJ("ionRefresh",(function AddonModChatSessionMessagesPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshMessages(e.target)})),d._UZ(11,"ion-refresher-content",3),d.ALo(12,"translate"),d.qZA(),d.TgZ(13,"core-loading",4)(14,"ion-list",5),d.YNc(15,AddonModChatSessionMessagesPage_ng_container_15_Template,4,3,"ng-container",6),d.qZA()()()),2&e&&(d.xp6(3),d.Q6J("text",d.lcZ(4,6,"core.back")),d.xp6(4),d.Oqu(d.lcZ(8,8,"addon.mod_chat.messages")),d.xp6(3),d.Q6J("disabled",!t.loaded),d.xp6(),d.s9C("pullingText",d.lcZ(12,10,"core.pulltorefresh")),d.xp6(2),d.Q6J("hideUntil",t.loaded),d.xp6(2),d.Q6J("ngForOf",t.messages))},dependencies:[S.sg,S.O5,q.r,Q.F,J.I,c.r,g.t,_.yp,_.Sm,_.W2,_.Gu,_.gu,_.q_,_.nJ,_.Wo,_.wd,_.sr,_.oU,L.o,m.X$],styles:[".ios[_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child, .ios   [_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child{padding-bottom:4px;min-height:0}ion-content[_ngcontent-%COMP%]{--content-background: var(--background-alternative);--background: var(--content-background)}ion-content[_ngcontent-%COMP%]::part(scroll){padding-bottom:0!important}.addon-messages-discussion-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:16px!important;background:var(--content-background)}.addon-messages-date[_ngcontent-%COMP%]{font-weight:400;font-size:.9rem}","[_nghost-%COMP%]   .addon-mod_chat-notice[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:8px}"]}),AddonModChatSessionMessagesPage})();var D=o(38049),F=o(23966),N=o(1389),$=o(25233),Y=o(30242),V=o(54129),G=o(95800);class AddonModChatSessionsSource extends V.H{constructor(e,t,o){super(),this.showAll=!1,this.groupId=0,this.COURSE_ID=e,this.CHAT_ID=t,this.CM_ID=o}invalidateCache(){var e=this;return(0,h.Z)((function*(){yield C.Tr.ignoreErrors(C.Tr.allPromises([G.t.invalidateActivityGroupInfo(e.CM_ID),P.Y.invalidateSessions(e.CHAT_ID,e.groupId,e.showAll)]))}))()}loadPageItems(){var e=this;return(0,h.Z)((function*(){e.groupInfo=yield G.t.getActivityGroupInfo(e.CM_ID,!1),e.groupId=G.t.validateGroupId(e.groupId,e.groupInfo);const t=yield P.Y.getSessions(e.CHAT_ID,e.groupId,e.showAll,{cmId:e.CM_ID}),o=[],n=t.map((t=>(t.duration=t.sessionend-t.sessionstart,t.sessionusers.forEach((t=>{o.push(e.loadUserFullname(t))})),t.allsessionusers=t.sessionusers,t.sessionusers.length>4&&(t.sessionusers=t.allsessionusers.slice(0,3)),t)));return yield Promise.all(o),{items:n}}))()}getItemPath(e){return`${e.sessionstart}/${e.sessionend}`}getItemQueryParams(){return{chatId:this.CHAT_ID,groupId:this.groupId}}loadUserFullname(e){var t=this;return(0,h.Z)((function*(){if(!e.userfullname)try{const o=yield R.My.getProfile(e.userid,t.COURSE_ID,!0);e.userfullname=o.fullname}catch{e.userfullname=b.vN.instant("core.deleteduser")+" "+e.userid}}))()}}var W=o(72526),j=o(56223),H=o(67475);function AddonModChatSessionsPage_ion_card_20_p_6_Template(e,t){if(1&e&&(d.TgZ(0,"p"),d._uU(1),d.ALo(2,"coreDuration"),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(),d.Oqu(d.lcZ(2,1,e.duration))}}function AddonModChatSessionsPage_ion_card_20_ion_item_8_span_3_Template(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(),d.hij("(",e.messagecount,")")}}function AddonModChatSessionsPage_ion_card_20_ion_item_8_Template(e,t){if(1&e&&(d.TgZ(0,"ion-item")(1,"ion-label"),d._uU(2),d.YNc(3,AddonModChatSessionsPage_ion_card_20_ion_item_8_span_3_Template,2,1,"span",12),d.qZA()()),2&e){const e=t.$implicit;d.xp6(2),d.hij(" ",e.userfullname," "),d.xp6(),d.Q6J("ngIf",e.messagecount)}}function AddonModChatSessionsPage_ion_card_20_ion_button_9_Template(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-button",15),d.NdJ("click",(function AddonModChatSessionsPage_ion_card_20_ion_button_9_Template_ion_button_click_0_listener(t){d.CHM(e);const o=d.oxw().$implicit,n=d.oxw();return d.KtG(n.showMoreUsers(o,t))})),d._uU(1),d.ALo(2,"translate"),d.qZA()}2&e&&(d.xp6(),d.hij(" ",d.lcZ(2,1,"core.showmore")," "))}function AddonModChatSessionsPage_ion_card_20_Template(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"ion-card",9),d.NdJ("click",(function AddonModChatSessionsPage_ion_card_20_Template_ion_card_click_0_listener(){const t=d.CHM(e).$implicit,o=d.oxw();return d.KtG(o.sessions.select(t))})),d.TgZ(1,"ion-item",10)(2,"ion-label")(3,"p",11),d._uU(4),d.ALo(5,"coreFormatDate"),d.qZA(),d.YNc(6,AddonModChatSessionsPage_ion_card_20_p_6_Template,3,3,"p",12),d.qZA()(),d.TgZ(7,"ion-card-content"),d.YNc(8,AddonModChatSessionsPage_ion_card_20_ion_item_8_Template,4,2,"ion-item",13),d.qZA(),d.YNc(9,AddonModChatSessionsPage_ion_card_20_ion_button_9_Template,3,3,"ion-button",14),d.qZA()}if(2&e){const e=t.$implicit,o=d.oxw();d.ekj("addon-mod-chat-session-show-more",e.sessionusers.length<e.allsessionusers.length),d.uIk("aria-current",o.sessions.getItemAriaCurrent(e)),d.xp6(4),d.Oqu(d.lcZ(5,7,1e3*e.sessionstart)),d.xp6(2),d.Q6J("ngIf",e.duration),d.xp6(2),d.Q6J("ngForOf",e.sessionusers),d.xp6(),d.Q6J("ngIf",e.sessionusers.length<e.allsessionusers.length)}}function AddonModChatSessionsPage_core_empty_box_21_Template(e,t){1&e&&(d._UZ(0,"core-empty-box",16),d.ALo(1,"translate")),2&e&&d.Q6J("message",d.lcZ(1,1,"addon.mod_chat.nosessionsfound"))}let K=(()=>{var e;class AddonModChatSessionsPage{constructor(){var e=this;this.logView=w.V.once((0,h.Z)((function*(){const t=e.sessions.getSource();yield C.Tr.ignoreErrors(P.Y.logViewSessions(e.sessions.getSource().CM_ID)),y.ke.logEvent({type:y.gM.VIEW_ITEM_LIST,ws:"mod_chat_view_sessions",name:b.vN.instant("addon.mod_chat.chatreport"),data:{chatid:t.CHAT_ID,category:"chat"},url:`/mod/chat/report.php?id=${t.CM_ID}`})})))}ngOnInit(){try{this.courseId=I.b.getRequiredRouteNumberParam("courseId");const e=I.b.getRequiredRouteNumberParam("chatId"),t=I.b.getRequiredRouteNumberParam("cmId"),o=$.p.getOrCreateSource(AddonModChatSessionsSource,[this.courseId,e,t]);this.sessions=new N.a(o,AddonModChatSessionsPage)}catch(e){return A.OQ.showErrorModal(e),I.b.back(),void 0}}get groupId(){return this.sessions.getSource().groupId}set groupId(e){this.sessions.getSource().groupId=e}get showAll(){return this.sessions.getSource().showAll}set showAll(e){this.sessions.getSource().showAll=e}get groupInfo(){return this.sessions.getSource().groupInfo}ngAfterViewInit(){var e=this;return(0,h.Z)((function*(){yield e.fetchSessions(),e.sessions.start(e.splitView)}))()}fetchSessions(){var e=this;return(0,h.Z)((function*(){try{yield e.sessions.load(),e.logView()}catch(e){A.OQ.showErrorModalDefault(e,"core.errorloadingcontent",!0)}}))()}reloadSessions(){var e=this;return(0,h.Z)((function*(){const t=yield A.OQ.showModalLoading();try{yield e.sessions.reload()}catch(e){A.OQ.showErrorModalDefault(e,"core.errorloadingcontent",!0)}finally{t.dismiss()}}))()}refreshSessions(e){var t=this;return(0,h.Z)((function*(){try{t.sessions.getSource().setDirty(!0),yield t.sessions.getSource().invalidateCache(),yield t.fetchSessions()}finally{e.complete()}}))()}showMoreUsers(e,t){e.allsessionusers&&(e.sessionusers=e.allsessionusers),t.stopPropagation()}ngOnDestroy(){this.sessions.destroy()}}return(e=AddonModChatSessionsPage).ɵfac=function AddonModChatSessionsPage_Factory(t){return new(t||e)},e.ɵcmp=d.Xpm({type:e,selectors:[["page-addon-mod-chat-sessions"]],viewQuery:function AddonModChatSessionsPage_Query(e,t){if(1&e&&d.Gf(Y.A,5),2&e){let e;d.iGM(e=d.CRH())&&(t.splitView=e.first)}},decls:22,vars:20,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[3,"groupInfo","selected","courseId","selectedChange"],[3,"ngModel","ngModelChange","ionChange"],["button","",3,"addon-mod-chat-session-show-more","click",4,"ngFor","ngForOf"],["icon","far-comments",3,"message",4,"ngIf"],["button","",3,"click"],[1,"ion-text-wrap"],[1,"item-heading"],[4,"ngIf"],[4,"ngFor","ngForOf"],["fill","clear","expand","block",3,"click",4,"ngIf"],["fill","clear","expand","block",3,"click"],["icon","far-comments",3,"message"]],template:function AddonModChatSessionsPage_Template(e,t){1&e&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d._UZ(3,"ion-back-button",1),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"ion-title")(6,"h1"),d._uU(7),d.ALo(8,"translate"),d.qZA()()()(),d.TgZ(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),d.NdJ("ionRefresh",(function AddonModChatSessionsPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshSessions(e.target)})),d._UZ(12,"ion-refresher-content",3),d.ALo(13,"translate"),d.qZA(),d.TgZ(14,"core-loading",4)(15,"core-group-selector",5),d.NdJ("selectedChange",(function AddonModChatSessionsPage_Template_core_group_selector_selectedChange_15_listener(e){return t.groupId=e}))("selectedChange",(function AddonModChatSessionsPage_Template_core_group_selector_selectedChange_15_listener(){return t.reloadSessions()})),d.qZA(),d.TgZ(16,"ion-item")(17,"ion-toggle",6),d.NdJ("ngModelChange",(function AddonModChatSessionsPage_Template_ion_toggle_ngModelChange_17_listener(e){return t.showAll=e}))("ionChange",(function AddonModChatSessionsPage_Template_ion_toggle_ionChange_17_listener(){return t.reloadSessions()})),d._uU(18),d.ALo(19,"translate"),d.qZA()(),d.YNc(20,AddonModChatSessionsPage_ion_card_20_Template,10,9,"ion-card",7)(21,AddonModChatSessionsPage_core_empty_box_21_Template,2,3,"core-empty-box",8),d.qZA()()()),2&e&&(d.xp6(3),d.Q6J("text",d.lcZ(4,12,"core.back")),d.xp6(4),d.Oqu(d.lcZ(8,14,"addon.mod_chat.chatreport")),d.xp6(4),d.Q6J("disabled",!t.sessions.loaded),d.xp6(),d.s9C("pullingText",d.lcZ(13,16,"core.pulltorefresh")),d.xp6(2),d.Q6J("hideUntil",t.sessions.loaded),d.xp6(),d.Q6J("groupInfo",t.groupInfo)("selected",t.groupId)("courseId",t.courseId),d.xp6(2),d.Q6J("ngModel",t.showAll),d.xp6(),d.hij(" ",d.lcZ(19,18,"addon.mod_chat.showincompletesessions")," "),d.xp6(2),d.Q6J("ngForOf",t.sessions.items),d.xp6(),d.Q6J("ngIf",t.sessions.empty))},dependencies:[S.sg,S.O5,U.z,W.Q,q.r,Y.A,g.t,O.O,j.JJ,j.On,_.YG,_.Sm,_.PM,_.FN,_.W2,_.Gu,_.Ie,_.Q$,_.nJ,_.Wo,_.wd,_.ho,_.sr,_.w,_.oU,H.a,L.o,m.X$],encapsulation:2}),AddonModChatSessionsPage})();var B=o(84095);const z=[{path:":courseId/:cmId",component:u},{path:":courseId/:cmId/chat",component:k,canDeactivate:[B.Y]}],X=[...z,{path:":courseId/:cmId/sessions",component:K},{path:":courseId/:cmId/sessions/:sessionStart/:sessionEnd",component:E}],ee=[...z,{path:":courseId/:cmId/sessions",component:K,children:[{path:":sessionStart/:sessionEnd",component:E}]}],te=[...(0,F.Vr)(X,(()=>D.X4.isMobile)),...(0,F.Vr)(ee,(()=>D.X4.isTablet))];let oe=(()=>{var e;class AddonModChatLazyModule{}return(e=AddonModChatLazyModule).ɵfac=function AddonModChatLazyModule_Factory(t){return new(t||e)},e.ɵmod=d.oAB({type:e}),e.ɵinj=d.cJS({imports:[n.Bz.forChild(te),s.L,a.k]}),AddonModChatLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&d.kYT(oe,{declarations:[u,k,K,E],imports:[n.Bz,s.L,a.k]}))}}]);