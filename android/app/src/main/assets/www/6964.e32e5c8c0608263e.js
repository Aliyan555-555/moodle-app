"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6964],{96964:(e,t,n)=>{n.r(t),n.d(t,{CoreettingsSiteLazyModule:()=>Q});var i=n(19212),r=n(67643),o=n(13386),s=n(23966),a=n(38049),l=n(49671),c=n(98370),g=n(53564),_=n(43555),d=n(30242),u=n(1389),h=n(25233),f=n(23939),p=n(13010),m=n(81370),C=n(10727),S=n(18005),P=n(5973),Z=n(54129),y=n(38697);class CoreSettingsHandlersSource extends Z.H{constructor(){super(...arguments),this.handlers=[]}loadPageItems(){var e=this;return(0,l.Z)((function*(){return e.handlers=y.o.getHandlers(),{items:e.handlers.filter((e=>"page"in e))}}))()}getItemPath(e){return e.page}getItemQueryParams(e){return e.params||{}}}var b=n(96814),x=n(61341),T=n(66931),w=n(86700),A=n(29657),O=n(22068),I=n(56223),k=n(31903),v=n(89515);function CoreSitePreferencesPage_ion_item_17_ion_icon_2_Template(e,t){if(1&e&&i._UZ(0,"ion-icon",16),2&e){const e=i.oxw().$implicit;i.Q6J("name",e.icon)}}function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"ion-toggle",17),i.NdJ("ngModelChange",(function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template_ion_toggle_ngModelChange_0_listener(t){i.CHM(e);const n=i.oxw().$implicit;return i.KtG(n.toggleChecked=t)}))("ionChange",(function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template_ion_toggle_ionChange_0_listener(t){i.CHM(e);const n=i.oxw().$implicit;return i.KtG(n.toggle(t.detail.checked))})),i.qZA()}if(2&e){const e=i.oxw().$implicit;i.Q6J("ngModel",e.toggleChecked)}}function CoreSitePreferencesPage_ion_item_17_Template(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"ion-item",13),i.NdJ("click",(function CoreSitePreferencesPage_ion_item_17_Template_ion_item_click_0_listener(){const t=i.CHM(e).$implicit,n=i.oxw();return i.KtG(!t.toggle&&n.handlers.select(t))})),i.ALo(1,"translate"),i.YNc(2,CoreSitePreferencesPage_ion_item_17_ion_icon_2_Template,1,1,"ion-icon",14),i.TgZ(3,"ion-label")(4,"p",8),i._uU(5),i.ALo(6,"translate"),i.qZA()(),i.YNc(7,CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template,1,1,"ion-toggle",15),i.qZA()}if(2&e){const e=t.$implicit,n=i.oxw();i.Q6J("ngClass",e.class)("button",!e.toggle)("detail",!e.toggle),i.uIk("aria-label",i.lcZ(1,8,e.title))("aria-current",n.handlers.getItemAriaCurrent(e)),i.xp6(2),i.Q6J("ngIf",e.icon),i.xp6(3),i.Oqu(i.lcZ(6,10,e.title)),i.xp6(2),i.Q6J("ngIf",e.toggle)}}function CoreSitePreferencesPage_ion_item_31_ng_container_3_Template(e,t){1&e&&(i.ynx(0),i._uU(1),i.ALo(2,"translate"),i.BQk()),2&e&&(i.xp6(),i.hij(" ",i.lcZ(2,1,"core.settings.connectwifitosync"),""))}function CoreSitePreferencesPage_ion_item_31_ng_container_4_Template(e,t){1&e&&(i.ynx(0),i._uU(1),i.ALo(2,"translate"),i.BQk()),2&e&&(i.xp6(),i.Oqu(i.lcZ(2,1,"core.settings.connecttosync")))}function CoreSitePreferencesPage_ion_item_31_Template(e,t){if(1&e&&(i.TgZ(0,"ion-item",18),i._UZ(1,"ion-icon",19),i.TgZ(2,"ion-label"),i.YNc(3,CoreSitePreferencesPage_ion_item_31_ng_container_3_Template,3,3,"ng-container",20)(4,CoreSitePreferencesPage_ion_item_31_ng_container_4_Template,3,3,"ng-container",20),i.qZA()()),2&e){const e=i.oxw();i.xp6(3),i.Q6J("ngIf",e.isOnline&&e.dataSaver&&e.limitedConnection),i.xp6(),i.Q6J("ngIf",!e.isOnline)}}let J=(()=>{var e;class CoreSitePreferencesPage{get handlerItems(){return this.handlers.getSource().handlers}constructor(){this.dataSaver=!1,this.limitedConnection=!1,this.isOnline=!0,this.isDestroyed=!1,this.siteId=g.m9.getCurrentSiteId();const e=h.p.getOrCreateSource(CoreSettingsHandlersSource,[]);this.handlers=new u.a(e,CoreSitePreferencesPage),this.sitesObserver=c.R.on(c.R.SITE_UPDATED,(()=>{this.refreshData()}),this.siteId),this.isOnline=m.AS.isOnline(),this.limitedConnection=this.isOnline&&m.AS.isNetworkAccessLimited(),this.networkObserver=m.AS.onChange().subscribe((()=>{C.R0.run((()=>{this.isOnline=m.AS.isOnline(),this.limitedConnection=this.isOnline&&m.AS.isNetworkAccessLimited()}))}))}ngAfterViewInit(){var e=this;return(0,l.Z)((function*(){e.dataSaver=yield P.b.get(S.i.SETTINGS_SYNC_ONLY_ON_WIFI,!0);const t=_.b.getRouteParam("page");try{yield e.fetchData()}finally{const n=t?e.handlers.items.find((e=>e.page==t)):void 0;n?(e.handlers.watchSplitViewOutlet(e.splitView),yield e.handlers.select(n)):yield e.handlers.start(e.splitView)}}))()}fetchData(){var e=this;return(0,l.Z)((function*(){yield e.handlers.load()}))()}synchronize(){var e=this;return(0,l.Z)((function*(){try{yield f.f.synchronizeSite(!1,e.siteId)}catch(t){if(e.isDestroyed)return;p.OQ.showErrorModalDefault(t,"core.settings.sitesyncfailed",!0)}}))()}isSynchronizing(){return!!f.f.getSiteSyncPromise(this.siteId)}refreshData(e){this.handlers.getSource().setDirty(!0),this.fetchData().finally((()=>{null==e||e.complete()}))}ngOnDestroy(){this.isDestroyed=!0,this.sitesObserver.off(),this.networkObserver.unsubscribe(),this.handlers.destroy()}}return(e=CoreSitePreferencesPage).ɵfac=function CoreSitePreferencesPage_Factory(t){return new(t||e)},e.ɵcmp=i.Xpm({type:e,selectors:[["page-core-site-preferences"]],viewQuery:function CoreSitePreferencesPage_Query(e,t){if(1&e&&i.Gf(d.A,5),2&e){let e;i.iGM(e=i.CRH())&&(t.splitView=e.first)}},decls:32,vars:24,consts:[["slot","start"],[3,"text"],["slot","end"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","core-settings-handler",3,"ngClass","button","detail","click",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],[1,"item-heading"],["slot","end",3,"loading"],["fill","clear",3,"disabled","click"],["name","fas-rotate","slot","icon-only","aria-hidden","true"],["class","core-warning-item ion-text-wrap",4,"ngIf"],[1,"core-settings-handler",3,"ngClass","button","detail","click"],["slot","start","aria-hidden","true",3,"name",4,"ngIf"],["slot","end",3,"ngModel","ngModelChange","ionChange",4,"ngIf"],["slot","start","aria-hidden","true",3,"name"],["slot","end",3,"ngModel","ngModelChange","ionChange"],[1,"core-warning-item","ion-text-wrap"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[4,"ngIf"]],template:function CoreSitePreferencesPage_Template(e,t){1&e&&(i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),i._UZ(3,"ion-back-button",1),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"ion-title")(6,"h1"),i._uU(7),i.ALo(8,"translate"),i.qZA()(),i._UZ(9,"ion-buttons",2),i.qZA()(),i.TgZ(10,"ion-content")(11,"core-split-view")(12,"ion-refresher",3),i.NdJ("ionRefresh",(function CoreSitePreferencesPage_Template_ion_refresher_ionRefresh_12_listener(e){return t.refreshData(e.target)})),i._UZ(13,"ion-refresher-content",4),i.ALo(14,"translate"),i.qZA(),i.TgZ(15,"core-loading",5)(16,"ion-list"),i.YNc(17,CoreSitePreferencesPage_ion_item_17_Template,8,12,"ion-item",6),i.qZA(),i.TgZ(18,"ion-card")(19,"ion-item",7)(20,"ion-label")(21,"p",8),i._uU(22),i.ALo(23,"translate"),i.qZA(),i.TgZ(24,"p"),i._uU(25),i.ALo(26,"translate"),i.qZA()(),i.TgZ(27,"core-button-with-spinner",9)(28,"ion-button",10),i.NdJ("click",(function CoreSitePreferencesPage_Template_ion_button_click_28_listener(){return t.synchronize()})),i.ALo(29,"translate"),i._UZ(30,"ion-icon",11),i.qZA()()(),i.YNc(31,CoreSitePreferencesPage_ion_item_31_Template,5,2,"ion-item",12),i.qZA()()()()),2&e&&(i.xp6(3),i.Q6J("text",i.lcZ(4,12,"core.back")),i.xp6(4),i.Oqu(i.lcZ(8,14,"core.settings.preferences")),i.xp6(5),i.Q6J("disabled",!t.handlers.loaded),i.xp6(),i.s9C("pullingText",i.lcZ(14,16,"core.pulltorefresh")),i.xp6(2),i.Q6J("hideUntil",t.handlers.loaded),i.xp6(2),i.Q6J("ngForOf",t.handlerItems),i.xp6(5),i.Oqu(i.lcZ(23,18,"core.settings.synchronizenow")),i.xp6(3),i.hij(" ",i.lcZ(26,20,"core.settings.synchronizenowhelp")," "),i.xp6(2),i.Q6J("loading",t.isSynchronizing()),i.xp6(),i.Q6J("disabled",!t.isOnline||t.dataSaver&&t.limitedConnection),i.uIk("aria-label",i.lcZ(29,22,"core.settings.synchronizenow")),i.xp6(3),i.Q6J("ngIf",!t.isOnline||t.dataSaver&&t.limitedConnection))},dependencies:[b.mk,b.sg,b.O5,x.$,T.r,d.A,w.I,A.t,O.O,I.JJ,I.On,k.YG,k.Sm,k.PM,k.W2,k.Gu,k.gu,k.Ie,k.Q$,k.q_,k.nJ,k.Wo,k.wd,k.ho,k.sr,k.w,k.oU,v.X$],encapsulation:2}),CoreSitePreferencesPage})();var M=n(76038);function buildRoutes(e){const t=(0,M.e)(e),n=[{path:"",component:J},...t.siblings],i=[{path:"",component:J,children:t.siblings}];return[...(0,s.Vr)(n,(()=>a.X4.isMobile)),...(0,s.Vr)(i,(()=>a.X4.isTablet))]}let Q=(()=>{var e;class CoreettingsSiteLazyModule{}return(e=CoreettingsSiteLazyModule).ɵfac=function CoreettingsSiteLazyModule_Factory(t){return new(t||e)},e.ɵmod=i.oAB({type:e}),e.ɵinj=i.cJS({providers:[{provide:r.Z6,multi:!0,useFactory:buildRoutes,deps:[i.zs3]}],imports:[o.L,r.Bz]}),CoreettingsSiteLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&i.kYT(Q,{declarations:[J],imports:[o.L],exports:[r.Bz]}))}}]);