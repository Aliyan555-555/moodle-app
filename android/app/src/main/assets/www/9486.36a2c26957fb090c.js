"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9486],{9486:(e,n,t)=>{t.r(n),t.d(n,{AddonCompetencyLearningPlansLazyModule:()=>Y});var o=t(67643),a=t(23966),i=t(38049),c=t(13386),r=t(49671),l=t(13010),p=t(43555),s=t(71460),d=t(25233),_=t(54129),m=t(96092),g=t(71178),u=t(30855);class AddonCompetencyPlansSource extends _.H{static getSourceId(e){return e?String(e):"current-user"}constructor(e){super(),this.USER_ID=e}getItemPath(e){return`${e.id}/${m._1}`}getItemQueryParams(){return this.USER_ID?{userId:this.USER_ID}:{}}invalidateCache(){var e=this;return(0,r.Z)((function*(){yield g.M.invalidateLearningPlans(e.USER_ID)}))()}loadPageItems(){var e=this;return(0,r.Z)((function*(){const n=yield g.M.getLearningPlans(e.USER_ID);return n.forEach((e=>{switch(e.statusname=u.Y.getPlanStatusName(e.status),e.status){case g.g.STATUS_ACTIVE:e.statuscolor="success";break;case g.g.STATUS_COMPLETE:e.statuscolor="danger";break;default:e.statuscolor="warning"}})),{items:n}}))()}}var y=t(1389),f=t(53654),P=t(43468),x=t(88817),A=t(19212),Z=t(96814),h=t(66931),T=t(74176),C=t(80070),I=t(8947),L=t(5065),b=t(29657),w=t(31903),q=t(83369),Q=t(89515);function AddonCompetencyPlanPage_h1_6_Template(e,n){if(1&e&&(A.TgZ(0,"h1"),A._UZ(1,"core-format-text",7),A.qZA()),2&e){const e=A.oxw();A.xp6(),A.Q6J("text",e.plan.plan.name)("contextInstanceId",e.plan.plan.userid)}}function AddonCompetencyPlanPage_ion_card_12_Template(e,n){if(1&e&&(A.TgZ(0,"ion-card")(1,"ion-item",8)(2,"ion-label"),A._UZ(3,"core-user-avatar",9),A.TgZ(4,"p",10),A._uU(5),A.qZA()()()()),2&e){const e=A.oxw();A.xp6(3),A.Q6J("user",e.user),A.xp6(2),A.Oqu(e.user.fullname)}}function AddonCompetencyPlanPage_ion_card_13_ion_item_2_Template(e,n){if(1&e&&(A.TgZ(0,"ion-item",8)(1,"ion-label")(2,"p"),A._UZ(3,"core-format-text",7),A.qZA()()()),2&e){const e=A.oxw(2);A.xp6(3),A.Q6J("text",e.plan.plan.description)("contextInstanceId",e.plan.plan.userid)}}function AddonCompetencyPlanPage_ion_card_13_ion_item_10_Template(e,n){if(1&e&&(A.TgZ(0,"ion-item",8)(1,"ion-label")(2,"p",10),A._uU(3),A.ALo(4,"translate"),A.qZA(),A.TgZ(5,"p"),A._uU(6),A.ALo(7,"coreFormatDate"),A.qZA()()()),2&e){const e=A.oxw(2);A.xp6(3),A.Oqu(A.lcZ(4,2,"addon.competency.duedate")),A.xp6(3),A.Oqu(A.lcZ(7,4,1e3*e.plan.plan.duedate))}}function AddonCompetencyPlanPage_ion_card_13_ion_item_11_Template(e,n){if(1&e&&(A.TgZ(0,"ion-item",8)(1,"ion-label")(2,"p",10),A._uU(3),A.ALo(4,"translate"),A.qZA(),A.TgZ(5,"p"),A._UZ(6,"core-format-text",14),A.qZA()()()),2&e){const e=A.oxw(2);A.xp6(3),A.Oqu(A.lcZ(4,3,"addon.competency.template")),A.xp6(3),A.Q6J("text",e.plan.plan.template.shortname)("contextInstanceId",0)}}const _c0=(e,n)=>({x:e,y:n}),_c1=e=>({$a:e});function AddonCompetencyPlanPage_ion_card_13_Template(e,n){if(1&e&&(A.TgZ(0,"ion-card")(1,"ion-list"),A.YNc(2,AddonCompetencyPlanPage_ion_card_13_ion_item_2_Template,4,2,"ion-item",11),A.TgZ(3,"ion-item",8)(4,"ion-label")(5,"p",10),A._uU(6),A.ALo(7,"translate"),A.qZA(),A.TgZ(8,"p"),A._uU(9),A.qZA()()(),A.YNc(10,AddonCompetencyPlanPage_ion_card_13_ion_item_10_Template,8,6,"ion-item",11)(11,AddonCompetencyPlanPage_ion_card_13_ion_item_11_Template,7,5,"ion-item",11),A.TgZ(12,"ion-item",8)(13,"ion-label",12)(14,"p",10),A._uU(15),A.ALo(16,"translate"),A.qZA(),A.TgZ(17,"p"),A._uU(18),A.ALo(19,"translate"),A.qZA(),A._UZ(20,"core-progress-bar",13),A.qZA()()()()),2&e){const e=A.oxw();A.xp6(2),A.Q6J("ngIf",e.plan.plan.description),A.xp6(4),A.Oqu(A.lcZ(7,11,"addon.competency.status")),A.xp6(3),A.Oqu(e.plan.plan.statusname),A.xp6(),A.Q6J("ngIf",e.plan.plan.duedate>0),A.xp6(),A.Q6J("ngIf",e.plan.plan.template),A.xp6(2),A.MGl("id","addon-competency-plan-",e.plan.plan.id,"-progress"),A.xp6(2),A.Oqu(A.lcZ(16,13,"addon.competency.progress")),A.xp6(3),A.hij(" ",A.xi3(19,15,"addon.competency.xcompetenciesproficientoutofy",A.VKq(21,_c1,A.WLB(18,_c0,e.plan.proficientcompetencycount,e.plan.competencycount)))," "),A.xp6(2),A.MGl("ariaDescribedBy","addon-competency-plan-",e.plan.plan.id,"-progress"),A.Q6J("progress",e.plan.proficientcompetencypercentage)("text",e.plan.proficientcompetencypercentageformatted)}}function AddonCompetencyPlanPage_ion_card_14_ion_item_6_Template(e,n){1&e&&(A.TgZ(0,"ion-item",8)(1,"ion-label")(2,"p"),A._uU(3),A.ALo(4,"translate"),A.qZA()()()),2&e&&(A.xp6(3),A.Oqu(A.lcZ(4,1,"addon.competency.nocompetencies")))}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_6_Template(e,n){if(1&e&&(A.TgZ(0,"ion-badge",18),A._uU(1),A.qZA()),2&e){const e=A.oxw().$implicit;A.Q6J("color",e.usercompetencyplan.proficiency?"success":"danger"),A.xp6(),A.hij(" ",e.usercompetencyplan.gradename," ")}}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_7_Template(e,n){if(1&e&&(A.TgZ(0,"ion-badge",18),A._uU(1),A.qZA()),2&e){const e=A.oxw().$implicit;A.Q6J("color",e.usercompetency.proficiency?"success":"danger"),A.xp6(),A.hij(" ",e.usercompetency.gradename," ")}}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template(e,n){if(1&e){const e=A.EpF();A.TgZ(0,"ion-item",16),A.NdJ("click",(function AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template_ion_item_click_0_listener(){const n=A.CHM(e).$implicit,t=A.oxw(2);return A.KtG(t.competencies.select(n))})),A.TgZ(1,"ion-label")(2,"p",10),A._UZ(3,"core-format-text",7),A.TgZ(4,"em"),A._uU(5),A.qZA()()(),A.YNc(6,AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_6_Template,2,2,"ion-badge",17)(7,AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_7_Template,2,2,"ion-badge",17),A.qZA()}if(2&e){const e=n.$implicit,t=A.oxw(2);A.Q6J("detail",!0),A.uIk("aria-label",e.competency.shortname),A.xp6(3),A.Q6J("text",e.competency.shortname)("contextInstanceId",t.plan.plan.userid),A.xp6(2),A.Oqu(e.competency.idnumber),A.xp6(),A.Q6J("ngIf",e.usercompetencyplan),A.xp6(),A.Q6J("ngIf",!e.usercompetencyplan)}}function AddonCompetencyPlanPage_ion_card_14_Template(e,n){if(1&e&&(A.TgZ(0,"ion-card")(1,"ion-card-header",8)(2,"ion-card-title"),A._uU(3),A.ALo(4,"translate"),A.qZA()(),A.TgZ(5,"ion-list"),A.YNc(6,AddonCompetencyPlanPage_ion_card_14_ion_item_6_Template,5,3,"ion-item",11)(7,AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template,8,7,"ion-item",15),A.qZA()()),2&e){const e=A.oxw();A.xp6(3),A.Oqu(A.lcZ(4,3,"addon.competency.learningplancompetencies")),A.xp6(3),A.Q6J("ngIf",0===e.plan.competencycount),A.xp6(),A.Q6J("ngForOf",e.competencies.items)}}let J=(()=>{var e;class AddonCompetencyPlanPage{constructor(){this.logView=x.V.once((()=>this.performLogView()));try{const e=p.b.getRequiredRouteNumberParam("planId"),n=p.b.getRouteNumberParam("userId"),t=d.p.getOrCreateSource(AddonCompetencyPlansSource,[n]),o=d.p.getOrCreateSource(f.R,[e]);this.competencies=new y.a(o,AddonCompetencyPlanPage),this.plans=new s.t(t)}catch(e){return l.OQ.showErrorModal(e),p.b.back(),void 0}}get plan(){return this.competencies.getSource().plan}get user(){return this.competencies.getSource().user}ngOnInit(){var e=this;return(0,r.Z)((function*(){yield e.fetchLearningPlan(),yield e.plans.start(),yield e.competencies.start()}))()}ngOnDestroy(){this.plans.destroy(),this.competencies.destroy()}fetchLearningPlan(){var e=this;return(0,r.Z)((function*(){try{yield e.competencies.getSource().reload(),e.logView()}catch(e){l.OQ.showErrorModalDefault(e,"Error getting learning plan data.")}}))()}refreshLearningPlan(e){var n=this;return(0,r.Z)((function*(){yield n.competencies.getSource().invalidateCache(),n.fetchLearningPlan().finally((()=>{null==e||e.complete()}))}))()}performLogView(){if(!this.plan)return;const e=this.competencies.getSource().PLAN_ID;P.ke.logEvent({type:P.gM.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plan_page",name:this.plan.plan.name,data:{category:"competency",planid:e},url:`/admin/tool/lp/coursecompetencies.php?id=${e}`})}}return(e=AddonCompetencyPlanPage).ɵfac=function AddonCompetencyPlanPage_Factory(n){return new(n||e)},e.ɵcmp=A.Xpm({type:e,selectors:[["page-addon-competency-plan"]],decls:15,vars:13,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[1,"limited-width",3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["contextLevel","user",3,"text","contextInstanceId"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["class","ion-text-wrap",4,"ngIf"],[3,"id"],[3,"progress","text","ariaDescribedBy"],["contextLevel","system",3,"text","contextInstanceId"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"detail","click"],["slot","end",3,"color",4,"ngIf"],["slot","end",3,"color"]],template:function AddonCompetencyPlanPage_Template(e,n){1&e&&(A.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),A._UZ(3,"ion-back-button",1),A.ALo(4,"translate"),A.qZA(),A.TgZ(5,"ion-title"),A.YNc(6,AddonCompetencyPlanPage_h1_6_Template,2,2,"h1",2),A.qZA()()(),A.TgZ(7,"ion-content",3)(8,"ion-refresher",4),A.NdJ("ionRefresh",(function AddonCompetencyPlanPage_Template_ion_refresher_ionRefresh_8_listener(e){return n.refreshLearningPlan(e.target)})),A._UZ(9,"ion-refresher-content",5),A.ALo(10,"translate"),A.qZA(),A.TgZ(11,"core-loading",6),A.YNc(12,AddonCompetencyPlanPage_ion_card_12_Template,6,2,"ion-card",2)(13,AddonCompetencyPlanPage_ion_card_13_Template,21,23,"ion-card",2)(14,AddonCompetencyPlanPage_ion_card_14_Template,8,5,"ion-card",2),A.qZA()()),2&e&&(A.xp6(3),A.Q6J("text",A.lcZ(4,9,"core.back")),A.xp6(3),A.Q6J("ngIf",n.plan),A.xp6(),A.Q6J("core-swipe-navigation",n.plans),A.xp6(),A.Q6J("disabled",!n.competencies.loaded),A.xp6(),A.s9C("pullingText",A.lcZ(10,11,"core.pulltorefresh")),A.xp6(2),A.Q6J("hideUntil",n.competencies.loaded),A.xp6(),A.Q6J("ngIf",n.user),A.xp6(),A.Q6J("ngIf",n.plan),A.xp6(),A.Q6J("ngIf",n.plan))},dependencies:[Z.sg,Z.O5,h.r,T.j,C.X,I.r,L.g,b.t,w.yp,w.Sm,w.PM,w.Zi,w.Dq,w.W2,w.Gu,w.Ie,w.Q$,w.q_,w.nJ,w.Wo,w.wd,w.sr,w.oU,q.o,Q.X$],encapsulation:2}),AddonCompetencyPlanPage})();var U=t(30242),v=t(53564),S=t(10727),O=t(55126);function AddonCompetencyPlanListPage_core_empty_box_15_Template(e,n){1&e&&(A._UZ(0,"core-empty-box",7),A.ALo(1,"translate")),2&e&&A.Q6J("message",A.lcZ(1,1,"addon.competency.noplanswerecreated"))}function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_p_4_Template(e,n){if(1&e&&(A.TgZ(0,"p"),A._uU(1),A.ALo(2,"translate"),A.ALo(3,"coreFormatDate"),A.qZA()),2&e){const e=A.oxw().$implicit;A.xp6(),A.AsE(" ",A.lcZ(2,2,"addon.competency.duedate"),":  ",A.xi3(3,4,1e3*e.duedate,"strftimedatetimeshort")," ")}}function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template(e,n){if(1&e){const e=A.EpF();A.TgZ(0,"ion-item",10),A.NdJ("click",(function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template_ion_item_click_0_listener(){const n=A.CHM(e).$implicit,t=A.oxw(2);return A.KtG(t.plans.select(n))})),A.TgZ(1,"ion-label")(2,"p",11),A._UZ(3,"core-format-text",12),A.qZA(),A.YNc(4,AddonCompetencyPlanListPage_ion_list_16_ion_item_1_p_4_Template,4,7,"p",13),A.qZA(),A.TgZ(5,"ion-badge",14),A._uU(6),A.qZA()()}if(2&e){const e=n.$implicit,t=A.oxw(2);A.Q6J("detail",!0),A.uIk("aria-label",e.name)("aria-current",t.plans.getItemAriaCurrent(e)),A.xp6(3),A.Q6J("text",e.name)("contextInstanceId",e.userid),A.xp6(),A.Q6J("ngIf",e.duedate>0),A.xp6(),A.Q6J("color",e.statuscolor),A.xp6(),A.Oqu(e.statusname)}}function AddonCompetencyPlanListPage_ion_list_16_Template(e,n){if(1&e&&(A.TgZ(0,"ion-list",8),A.YNc(1,AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template,7,8,"ion-item",9),A.qZA()),2&e){const e=A.oxw();A.xp6(),A.Q6J("ngForOf",e.plans.items)}}let k=(()=>{var e;class AddonCompetencyPlanListPage{constructor(){var e;const n=null!==(e=p.b.getRouteNumberParam("userId"))&&void 0!==e?e:v.m9.getCurrentSiteUserId(),t=d.p.getOrCreateSource(AddonCompetencyPlansSource,[n]);this.plans=new y.a(t,AddonCompetencyPlanListPage),this.logView=x.V.once((0,r.Z)((function*(){P.ke.logEvent({type:P.gM.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plans_page",name:S.vN.instant("addon.competency.userplans"),data:{userid:n},url:`/admin/tool/lp/plans.php?userid=${n}`})})))}ngAfterViewInit(){var e=this;return(0,r.Z)((function*(){yield e.fetchLearningPlans(),e.plans.start(e.splitView)}))()}fetchLearningPlans(){var e=this;return(0,r.Z)((function*(){try{yield e.plans.load(),e.logView()}catch(e){l.OQ.showErrorModalDefault(e,"Error getting learning plans data.")}}))()}refreshLearningPlans(e){var n=this;return(0,r.Z)((function*(){yield n.plans.getSource().invalidateCache(),n.plans.getSource().setDirty(!0),n.fetchLearningPlans().finally((()=>{null==e||e.complete()}))}))()}ngOnDestroy(){this.plans.destroy()}}return(e=AddonCompetencyPlanListPage).ɵfac=function AddonCompetencyPlanListPage_Factory(n){return new(n||e)},e.ɵcmp=A.Xpm({type:e,selectors:[["page-addon-competency-planlist"]],viewQuery:function AddonCompetencyPlanListPage_Query(e,n){if(1&e&&A.Gf(U.A,5),2&e){let e;A.iGM(e=A.CRH())&&(n.splitView=e.first)}},decls:17,vars:13,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-route",3,"message",4,"ngIf"],["class","ion-no-margin",4,"ngIf"],["icon","fas-route",3,"message"],[1,"ion-no-margin"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"detail","click"],[1,"item-heading"],["contextLevel","user",3,"text","contextInstanceId"],[4,"ngIf"],["slot","end",1,"ion-text-wrap",3,"color"]],template:function AddonCompetencyPlanListPage_Template(e,n){1&e&&(A.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),A._UZ(3,"ion-back-button",1),A.ALo(4,"translate"),A.qZA(),A.TgZ(5,"ion-title")(6,"h1"),A._uU(7),A.ALo(8,"translate"),A.qZA()()()(),A.TgZ(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),A.NdJ("ionRefresh",(function AddonCompetencyPlanListPage_Template_ion_refresher_ionRefresh_11_listener(e){return n.refreshLearningPlans(e.target)})),A._UZ(12,"ion-refresher-content",3),A.ALo(13,"translate"),A.qZA(),A.TgZ(14,"core-loading",4),A.YNc(15,AddonCompetencyPlanListPage_core_empty_box_15_Template,2,3,"core-empty-box",5)(16,AddonCompetencyPlanListPage_ion_list_16_Template,2,1,"ion-list",6),A.qZA()()()),2&e&&(A.xp6(3),A.Q6J("text",A.lcZ(4,7,"core.back")),A.xp6(4),A.Oqu(A.lcZ(8,9,"addon.competency.userplans")),A.xp6(4),A.Q6J("disabled",!n.plans.loaded),A.xp6(),A.s9C("pullingText",A.lcZ(13,11,"core.pulltorefresh")),A.xp6(2),A.Q6J("hideUntil",n.plans.loaded),A.xp6(),A.Q6J("ngIf",n.plans.empty),A.xp6(),A.Q6J("ngIf",!n.plans.empty))},dependencies:[Z.sg,Z.O5,O.z,h.r,U.A,I.r,b.t,w.yp,w.Sm,w.W2,w.Gu,w.Ie,w.Q$,w.q_,w.nJ,w.Wo,w.wd,w.sr,w.oU,q.o,Q.X$],encapsulation:2}),AddonCompetencyPlanListPage})();var M=t(44854),$=t(99178),E=t(52733),N=t(51368),R=t(8103),V=t(42512);const D=[{path:"",component:k,children:[{path:`:planId/${m._1}`,component:J}]},{path:`:planId/${m._1}`,component:R.b,children:[{path:":competencyId",component:M.k}]}],F=[...(0,a.Vr)([{path:"",pathMatch:"full",component:k},{path:`:planId/${m._1}`,component:J},{path:`:planId/${m._1}/:competencyId`,component:M.k}],(()=>i.X4.isMobile)),...(0,a.Vr)(D,(()=>i.X4.isTablet)),{path:`:planId/${m._1}/:competencyId/${m.eC}`,component:$.d}];let Y=(()=>{var e;class AddonCompetencyLearningPlansLazyModule{}return(e=AddonCompetencyLearningPlansLazyModule).ɵfac=function AddonCompetencyLearningPlansLazyModule_Factory(n){return new(n||e)},e.ɵmod=A.oAB({type:e}),e.ɵinj=A.cJS({imports:[o.Bz.forChild(F),c.L,V.Q,E.K,N.$]}),AddonCompetencyLearningPlansLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&A.kYT(Y,{declarations:[J,k],imports:[o.Bz,c.L,V.Q,E.K,N.$]}))}}]);