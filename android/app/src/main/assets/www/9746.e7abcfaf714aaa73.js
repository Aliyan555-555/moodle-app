"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9746,5093,5398],{85093:(e,t,r)=>{r.d(t,{f:()=>CoreUserParticipantsSource});var i=r(49671),n=r(54129),a=r(45151);class CoreUserParticipantsSource extends n.H{static getSourceId(e,t=null){var r;return`participants-${e}-${t=null!==(r=t)&&void 0!==r?r:"__empty__"}`}constructor(e,t=null){super(),this.COURSE_ID=e,this.SEARCH_QUERY=t}getItemPath(e){return e.id.toString()}getItemQueryParams(){return{search:this.SEARCH_QUERY}}loadPageItems(e){var t=this;return(0,i.Z)((function*(){if(t.SEARCH_QUERY){const{participants:r,canLoadMore:i}=yield a.My.searchParticipants(t.COURSE_ID,t.SEARCH_QUERY,!0,e,a.UJ.PARTICIPANTS_LIST_LIMIT);return{items:r,hasMoreItems:i}}const{participants:r,canLoadMore:i}=yield a.My.getParticipants(t.COURSE_ID,e*a.UJ.PARTICIPANTS_LIST_LIMIT,a.UJ.PARTICIPANTS_LIST_LIMIT);return{items:r,hasMoreItems:i}}))()}getPageLength(){return a.UJ.PARTICIPANTS_LIST_LIMIT}}},19746:(e,t,r)=>{r.d(t,{V:()=>o});var i=r(13386),n=r(12591),a=r(74744),s=r(19212);let o=(()=>{var e;class CoreUserParticipantsPageModule{}return(e=CoreUserParticipantsPageModule).ɵfac=function CoreUserParticipantsPageModule_Factory(t){return new(t||e)},e.ɵmod=s.oAB({type:e}),e.ɵinj=s.cJS({imports:[i.L,a.w]}),CoreUserParticipantsPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&s.kYT(o,{declarations:[n.P],imports:[i.L,a.w]}))},12591:(e,t,r)=>{r.d(t,{P:()=>A});var i=r(49671),n=r(29540),a=r(13010),s=r(43555),o=r(1389),c=r(30242),_=r(45151),p=r(75803),l=r(85093),g=r(25233),u=r(43468),P=r(10727),f=r(19212),m=r(96814),h=r(55126),d=r(52133),C=r(66931),I=r(80070),U=r(8947),T=r(29657),y=r(31903),x=r(93268),Q=r(54490),Z=r(89515);function CoreUserParticipantsPage_core_empty_box_7_Template(e,t){1&e&&(f._UZ(0,"core-empty-box",8),f.ALo(1,"translate")),2&e&&f.Q6J("message",f.lcZ(1,1,"core.user.noparticipants"))}function CoreUserParticipantsPage_core_empty_box_8_Template(e,t){1&e&&(f._UZ(0,"core-empty-box",9),f.ALo(1,"translate")),2&e&&f.Q6J("message",f.lcZ(1,1,"core.noresults"))}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_3_ng_container_4_Template(e,t){if(1&e&&(f.ynx(0),f._uU(1),f.ALo(2,"coreTimeAgo"),f.BQk()),2&e){const e=f.oxw(3).$implicit;f.xp6(),f.hij("",f.lcZ(2,1,e.lastcourseaccess)," ")}}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_3_ng_container_5_Template(e,t){1&e&&(f.ynx(0),f._uU(1),f.ALo(2,"translate"),f.BQk()),2&e&&(f.xp6(),f.Oqu(f.lcZ(2,1,"core.never")))}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_3_Template(e,t){if(1&e&&(f.TgZ(0,"p")(1,"strong"),f._uU(2),f.ALo(3,"translate"),f.qZA(),f.YNc(4,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_3_ng_container_4_Template,3,3,"ng-container",6)(5,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_3_ng_container_5_Template,3,3,"ng-container",6),f.qZA()),2&e){const e=f.oxw(2).$implicit;f.xp6(2),f.hij("",f.lcZ(3,3,"core.user.lastcourseaccess"),": "),f.xp6(2),f.Q6J("ngIf",e.lastcourseaccess),f.xp6(),f.Q6J("ngIf",!e.lastcourseaccess)}}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_4_ng_container_4_Template(e,t){if(1&e&&(f.ynx(0),f._uU(1),f.ALo(2,"coreTimeAgo"),f.BQk()),2&e){const e=f.oxw(3).$implicit;f.xp6(),f.Oqu(f.lcZ(2,1,e.lastaccess))}}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_4_ng_container_5_Template(e,t){1&e&&(f.ynx(0),f._uU(1),f.ALo(2,"translate"),f.BQk()),2&e&&(f.xp6(),f.Oqu(f.lcZ(2,1,"core.never")))}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_4_Template(e,t){if(1&e&&(f.TgZ(0,"p")(1,"strong"),f._uU(2),f.ALo(3,"translate"),f.qZA(),f.YNc(4,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_4_ng_container_4_Template,3,3,"ng-container",6)(5,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_4_ng_container_5_Template,3,3,"ng-container",6),f.qZA()),2&e){const e=f.oxw(2).$implicit;f.xp6(2),f.hij("",f.lcZ(3,3,"core.lastaccess"),": "),f.xp6(2),f.Q6J("ngIf",e.lastaccess),f.xp6(),f.Q6J("ngIf",!e.lastaccess)}}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_Template(e,t){if(1&e&&(f.ynx(0),f.TgZ(1,"p",13),f._uU(2),f.qZA(),f.YNc(3,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_3_Template,6,5,"p",6)(4,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_p_4_Template,6,5,"p",6),f.BQk()),2&e){const e=f.oxw().$implicit;f.xp6(2),f.Oqu(e.fullname),f.xp6(),f.Q6J("ngIf",void 0!==e.lastcourseaccess),f.xp6(),f.Q6J("ngIf",void 0===e.lastcourseaccess&&void 0!==e.lastaccess)}}function CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_4_Template(e,t){if(1&e&&(f.ynx(0),f.TgZ(1,"p",13),f._UZ(2,"core-format-text",14),f.qZA(),f.BQk()),2&e){const e=f.oxw().$implicit,t=f.oxw(2);f.xp6(2),f.Q6J("text",e.fullname)("highlight",t.searchQuery)("filter",!1)}}function CoreUserParticipantsPage_ion_list_9_ion_item_1_Template(e,t){if(1&e){const e=f.EpF();f.TgZ(0,"ion-item",11),f.NdJ("click",(function CoreUserParticipantsPage_ion_list_9_ion_item_1_Template_ion_item_click_0_listener(){const t=f.CHM(e).$implicit,r=f.oxw(2);return f.KtG(r.participants.select(t))})),f._UZ(1,"core-user-avatar",12),f.TgZ(2,"ion-label"),f.YNc(3,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_3_Template,5,3,"ng-container",6)(4,CoreUserParticipantsPage_ion_list_9_ion_item_1_ng_container_4_Template,3,3,"ng-container",6),f.qZA()()}if(2&e){const e=t.$implicit,r=f.oxw(2);f.Q6J("detail",!0),f.uIk("aria-current",r.participants.getItemAriaCurrent(e))("aria-label",e.fullname),f.xp6(),f.Q6J("user",e)("linkProfile",!1)("checkOnline",!0),f.xp6(2),f.Q6J("ngIf",!r.searchQuery),f.xp6(),f.Q6J("ngIf",r.searchQuery)}}function CoreUserParticipantsPage_ion_list_9_Template(e,t){if(1&e&&(f.TgZ(0,"ion-list"),f.YNc(1,CoreUserParticipantsPage_ion_list_9_ion_item_1_Template,5,8,"ion-item",10),f.qZA()),2&e){const e=f.oxw();f.xp6(),f.Q6J("ngForOf",e.participants.items)}}let A=(()=>{var e;class CoreUserParticipantsPage{constructor(){this.searchQuery=null,this.searchInProgress=!1,this.searchEnabled=!1,this.fetchMoreParticipantsFailed=!1;try{this.courseId=s.b.getRequiredRouteNumberParam("courseId"),this.participants=new CoreUserParticipantsManager(g.p.getOrCreateSource(l.f,[this.courseId]),CoreUserParticipantsPage)}catch(e){return a.OQ.showErrorModal(e),s.b.back(),void 0}}ngOnInit(){var e=this;return(0,i.Z)((function*(){e.searchEnabled=yield _.My.canSearchParticipantsInSite()}))()}ngAfterViewInit(){var e=this;return(0,i.Z)((function*(){yield e.fetchInitialParticipants(),yield e.participants.start(e.splitView)}))()}ionViewDidEnter(){var e=this;return(0,i.Z)((function*(){yield e.participants.start()}))()}ngOnDestroy(){this.participants.destroy()}clearSearch(){var e=this;return(0,i.Z)((function*(){if(null===e.searchQuery)return;const t=g.p.getOrCreateSource(l.f,[e.courseId]);e.searchQuery=null,e.searchInProgress=!1,e.participants.setSource(t),yield e.fetchInitialParticipants()}))()}search(e){var t=this;return(0,i.Z)((function*(){n.z.closeKeyboard();const r=g.p.getOrCreateSource(l.f,[t.courseId,e]);t.searchInProgress=!0,t.searchQuery=e,t.participants.setSource(r),yield t.fetchInitialParticipants(),t.searchInProgress=!1}))()}refreshParticipants(e){var t=this;return(0,i.Z)((function*(){yield p.Tr.ignoreErrors(_.My.invalidateParticipantsList(t.courseId)),yield p.Tr.ignoreErrors(t.fetchParticipants(!0)),null==e||e.complete()}))()}fetchMoreParticipants(e){var t=this;return(0,i.Z)((function*(){try{yield t.fetchParticipants(!1)}catch(e){a.OQ.showErrorModalDefault(e,"Error loading more participants"),t.fetchMoreParticipantsFailed=!0}e()}))()}fetchInitialParticipants(){var e=this;return(0,i.Z)((function*(){try{yield e.fetchParticipants(!0)}catch(t){a.OQ.showErrorModalDefault(t,"Error loading participants"),e.participants.reset()}}))()}fetchParticipants(e){var t=this;return(0,i.Z)((function*(){e?yield t.participants.reload():yield t.participants.load(),t.fetchMoreParticipantsFailed=!1}))()}}return(e=CoreUserParticipantsPage).ɵfac=function CoreUserParticipantsPage_Factory(t){return new(t||e)},e.ɵcmp=f.Xpm({type:e,selectors:[["page-core-user-participants"]],viewQuery:function CoreUserParticipantsPage_Query(e,t){if(1&e&&f.Gf(c.A,5),2&e){let e;f.iGM(e=f.CRH())&&(t.splitView=e.first)}},decls:11,vars:13,consts:[["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],["autocorrect","off","searchArea","CoreUserParticipants",3,"disabled","spellcheck","lengthCheck","onSubmit","onClear"],[3,"hideUntil"],["icon","far-user",3,"message",4,"ngIf"],["icon","fas-magnifying-glass",3,"message",4,"ngIf"],[4,"ngIf"],[3,"enabled","error","action"],["icon","far-user",3,"message"],["icon","fas-magnifying-glass",3,"message"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"detail","click"],["slot","start",3,"user","linkProfile","checkOnline"],[1,"item-heading"],[3,"text","highlight","filter"]],template:function CoreUserParticipantsPage_Template(e,t){1&e&&(f.TgZ(0,"ion-content")(1,"core-split-view")(2,"ion-refresher",0),f.NdJ("ionRefresh",(function CoreUserParticipantsPage_Template_ion_refresher_ionRefresh_2_listener(e){return t.refreshParticipants(e.target)})),f._UZ(3,"ion-refresher-content",1),f.ALo(4,"translate"),f.qZA(),f.TgZ(5,"core-search-box",2),f.NdJ("onSubmit",(function CoreUserParticipantsPage_Template_core_search_box_onSubmit_5_listener(e){return t.search(e)}))("onClear",(function CoreUserParticipantsPage_Template_core_search_box_onClear_5_listener(){return t.clearSearch()})),f.qZA(),f.TgZ(6,"core-loading",3),f.YNc(7,CoreUserParticipantsPage_core_empty_box_7_Template,2,3,"core-empty-box",4)(8,CoreUserParticipantsPage_core_empty_box_8_Template,2,3,"core-empty-box",5)(9,CoreUserParticipantsPage_ion_list_9_Template,2,1,"ion-list",6),f.TgZ(10,"core-infinite-loading",7),f.NdJ("action",(function CoreUserParticipantsPage_Template_core_infinite_loading_action_10_listener(e){return t.fetchMoreParticipants(e)})),f.qZA()()()()),2&e&&(f.xp6(2),f.Q6J("disabled",!t.participants.loaded||t.searchInProgress),f.xp6(),f.s9C("pullingText",f.lcZ(4,11,"core.pulltorefresh")),f.xp6(2),f.Q6J("disabled",t.searchInProgress)("spellcheck",!1)("lengthCheck",1),f.xp6(),f.Q6J("hideUntil",t.participants.loaded),f.xp6(),f.Q6J("ngIf",t.participants.empty&&!t.searchInProgress&&!t.searchQuery),f.xp6(),f.Q6J("ngIf",t.participants.empty&&!t.searchInProgress&&t.searchQuery),f.xp6(),f.Q6J("ngIf",!t.participants.empty),f.xp6(),f.Q6J("enabled",t.participants.loaded&&!t.participants.completed)("error",t.fetchMoreParticipantsFailed))},dependencies:[m.sg,m.O5,h.z,d.n,C.r,c.A,I.X,U.r,T.t,y.W2,y.Ie,y.Q$,y.q_,y.nJ,y.Wo,x.L,Q.e,Z.X$],encapsulation:2}),CoreUserParticipantsPage})();class CoreUserParticipantsManager extends o.a{logActivity(){var e=this;return(0,i.Z)((function*(){yield p.Tr.ignoreErrors(_.My.logParticipantsView(e.getSource().COURSE_ID)),u.ke.logEvent({type:u.gM.VIEW_ITEM_LIST,ws:"core_user_view_user_list",name:P.vN.instant("core.user.participants"),data:{courseid:e.getSource().COURSE_ID,category:"user"},url:`/user/index.php?id=${e.getSource().COURSE_ID}`})}))()}}}}]);