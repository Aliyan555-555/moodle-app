"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7137],{87137:(e,t,n)=>{n.r(t),n.d(t,{AddonModFeedbackLazyModule:()=>se});var o=n(67643),a=n(13386),i=n(53606),d=n(98712),r=n(43555),c=n(4107),_=n(19212),s=n(8947),l=n(60067),m=n(29657),g=n(31903),p=n(89515);let u=(()=>{var e;class AddonModFeedbackIndexPage extends d.S{ngOnInit(){super.ngOnInit(),this.selectedTab=r.b.getRouteParam("tab"),this.selectedGroup=r.b.getRouteNumberParam("group")}}return(e=AddonModFeedbackIndexPage).ɵfac=(()=>{let t;return function AddonModFeedbackIndexPage_Factory(n){return(t||(t=_.n5z(e)))(n||e)}})(),e.ɵcmp=_.Xpm({type:e,selectors:[["page-addon-mod-feedback-index"]],viewQuery:function AddonModFeedbackIndexPage_Query(e,t){if(1&e&&_.Gf(c.C,5),2&e){let e;_.iGM(e=_.CRH())&&(t.activityComponent=e.first)}},features:[_.qOj],decls:14,vars:14,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","group","tab","dataRetrieved"]],template:function AddonModFeedbackIndexPage_Template(e,t){1&e&&(_.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),_._UZ(3,"ion-back-button",2),_.ALo(4,"translate"),_.qZA(),_.TgZ(5,"ion-title")(6,"h1"),_._UZ(7,"core-format-text",3),_.qZA()(),_._UZ(8,"ion-buttons",4),_.qZA()(),_.TgZ(9,"ion-content",5)(10,"ion-refresher",6),_.NdJ("ionRefresh",(function AddonModFeedbackIndexPage_Template_ion_refresher_ionRefresh_10_listener(e){return null==t.activityComponent?null:t.activityComponent.doRefresh(e.target)})),_._UZ(11,"ion-refresher-content",7),_.ALo(12,"translate"),_.qZA(),_.TgZ(13,"addon-mod-feedback-index",8),_.NdJ("dataRetrieved",(function AddonModFeedbackIndexPage_Template_addon_mod_feedback_index_dataRetrieved_13_listener(e){return t.updateData(e)})),_.qZA()()),2&e&&(_.xp6(3),_.Q6J("text",_.lcZ(4,10,"core.back")),_.xp6(4),_.Q6J("text",t.title)("contextInstanceId",t.module.id)("courseId",t.courseId),_.xp6(3),_.Q6J("disabled",null==t.activityComponent?null:t.activityComponent.showLoading),_.xp6(),_.s9C("pullingText",_.lcZ(12,12,"core.pulltorefresh")),_.xp6(2),_.Q6J("module",t.module)("courseId",t.courseId)("group",t.selectedGroup)("tab",t.selectedTab))},dependencies:[s.r,l.e,m.t,g.Sm,g.W2,g.Gu,g.nJ,g.Wo,g.wd,g.sr,g.oU,c.C,p.X$],encapsulation:2}),AddonModFeedbackIndexPage})();var f=n(49671),b=n(25233),A=n(1389),k=n(90284),h=n(30242),I=n(13010),x=n(75803),F=n(54129),M=n(95800),T=n(65703),P=n(86576);class AddonModFeedbackAttemptsSource extends F.H{constructor(e,t){super(),this.COURSE_ID=e,this.CM_ID=t}getItemPath(e){return e.id.toString()}getItemQueryParams(){return{groupId:this.selectedGroup}}getPagesLoaded(){if(!this.identifiable||!this.anonymous)return 0;const e=this.getPageLength();return Math.ceil(Math.max(this.anonymous.length,this.identifiable.length)/e)}isIdentifiableAttempt(e){return"fullname"in e}isAnonymousAttempt(e){return"number"in e}invalidateCache(){var e=this;return(0,f.Z)((function*(){yield Promise.all([M.t.invalidateActivityGroupInfo(e.CM_ID),e.feedback&&T.p.invalidateResponsesAnalysisData(e.feedback.id)])}))()}loadFeedback(){var e=this;return(0,f.Z)((function*(){e.feedback=yield T.p.getFeedback(e.COURSE_ID,e.CM_ID),e.groupInfo=yield M.t.getActivityGroupInfo(e.CM_ID),e.selectedGroup=M.t.validateGroupId(e.selectedGroup,e.groupInfo)}))()}getPageLength(){return T.P.PER_PAGE}loadPageItems(e){var t=this;return(0,f.Z)((function*(){if(!t.feedback)throw new Error("Can't load attempts without feeback");const n=yield P.S.getResponsesAnalysis(t.feedback.id,{page:e,groupId:t.selectedGroup,cmId:t.CM_ID});0===e&&(t.identifiableTotal=n.totalattempts,t.anonymousTotal=n.totalanonattempts);const o=t.getPageLength()*(e+1);return{items:[...0===e||n.totalattempts>T.P.PER_PAGE?n.attempts:[],...0===e||n.totalanonattempts>T.P.PER_PAGE?n.anonattempts:[]],hasMoreItems:n.totalattempts>o||n.totalanonattempts>o}}))()}setItems(e,t){this.identifiable=e.filter(this.isIdentifiableAttempt),this.anonymous=e.filter(this.isAnonymousAttempt),super.setItems(this.identifiable.concat(this.anonymous),t)}}var Z=n(88817),v=n(43468),y=n(96814),w=n(72526),Q=n(52133),q=n(66931),J=n(80070),N=n(83369);function AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_p_5_Template(e,t){if(1&e&&(_.TgZ(0,"p"),_._uU(1),_.ALo(2,"coreFormatDate"),_.qZA()),2&e){const e=_.oxw().$implicit;_.xp6(),_.Oqu(_.lcZ(2,1,1e3*e.timemodified))}}function AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-item",10),_.NdJ("click",(function AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_Template_ion_item_click_0_listener(){const t=_.CHM(e).$implicit,n=_.oxw(2);return _.KtG(null==n.attempts?null:n.attempts.select(t))})),_._UZ(1,"core-user-avatar",11),_.TgZ(2,"ion-label")(3,"p",12),_._uU(4),_.qZA(),_.YNc(5,AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_p_5_Template,3,3,"p",7),_.qZA()()}if(2&e){const e=t.$implicit,n=_.oxw(2);_.Q6J("detail",!0),_.uIk("aria-current",null==n.attempts?null:n.attempts.getItemAriaCurrent(e)),_.xp6(),_.Q6J("user",e)("linkProfile",!1),_.xp6(3),_.Oqu(e.fullname),_.xp6(),_.Q6J("ngIf",e.timemodified)}}const _c0=e=>({$a:e});function AddonModFeedbackAttemptsPage_ng_container_17_Template(e,t){if(1&e&&(_.ynx(0),_.TgZ(1,"ion-item-divider")(2,"ion-label")(3,"h2"),_._uU(4),_.ALo(5,"translate"),_.qZA()()(),_.YNc(6,AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_Template,6,6,"ion-item",9),_.BQk()),2&e){const e=_.oxw();_.xp6(4),_.Oqu(_.xi3(5,2,"addon.mod_feedback.non_anonymous_entries",_.VKq(5,_c0,e.identifiableAttemptsTotal))),_.xp6(2),_.Q6J("ngForOf",e.identifiableAttempts)}}function AddonModFeedbackAttemptsPage_ng_container_18_ion_item_6_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-item",10),_.NdJ("click",(function AddonModFeedbackAttemptsPage_ng_container_18_ion_item_6_Template_ion_item_click_0_listener(){const t=_.CHM(e).$implicit,n=_.oxw(2);return _.KtG(null==n.attempts?null:n.attempts.select(t))})),_._UZ(1,"core-user-avatar",13),_.TgZ(2,"ion-label")(3,"p",12),_._uU(4),_.ALo(5,"translate"),_.qZA(),_.TgZ(6,"p"),_._uU(7),_.ALo(8,"translate"),_.qZA()()()}if(2&e){const e=t.$implicit,n=_.oxw(2);_.Q6J("detail",!0),_.uIk("aria-current",null==n.attempts?null:n.attempts.getItemAriaCurrent(e)),_.xp6(),_.Q6J("linkProfile",!1),_.xp6(3),_.Oqu(_.lcZ(5,6,"addon.mod_feedback.anonymous_user")),_.xp6(3),_.AsE("",_.lcZ(8,8,"addon.mod_feedback.response_nr"),": ",e.number,"")}}function AddonModFeedbackAttemptsPage_ng_container_18_Template(e,t){if(1&e&&(_.ynx(0),_.TgZ(1,"ion-item-divider")(2,"ion-label")(3,"h2"),_._uU(4),_.ALo(5,"translate"),_.qZA()()(),_.YNc(6,AddonModFeedbackAttemptsPage_ng_container_18_ion_item_6_Template,9,10,"ion-item",9),_.BQk()),2&e){const e=_.oxw();_.xp6(4),_.Oqu(_.xi3(5,2,"addon.mod_feedback.anonymous_entries",_.VKq(5,_c0,e.anonymousAttemptsTotal))),_.xp6(2),_.Q6J("ngForOf",e.anonymousAttempts)}}let O=(()=>{var e;class AddonModFeedbackAttemptsPage{constructor(e){this.route=e,this.fetchFailed=!1,this.promisedAttempts=new k.b,this.logView=Z.V.once((()=>{var e;const t=null===(e=this.attempts)||void 0===e?void 0:e.getSource();t&&t.feedback&&v.ke.logEvent({type:v.gM.VIEW_ITEM_LIST,ws:"mod_feedback_get_responses_analysis",name:t.feedback.name,data:{feedbackid:t.feedback.id,category:"feedback"},url:`/mod/feedback/show_entries.php?id=${t.CM_ID}`})}))}get attempts(){return this.promisedAttempts.value}get groupInfo(){var e;return null===(e=this.attempts)||void 0===e?void 0:e.getSource().groupInfo}get selectedGroup(){var e;return null===(e=this.attempts)||void 0===e?void 0:e.getSource().selectedGroup}set selectedGroup(e){this.attempts&&(this.attempts.getSource().selectedGroup=e,this.attempts.getSource().setDirty(!0))}get identifiableAttempts(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().identifiable)&&void 0!==e?e:[]}get identifiableAttemptsTotal(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().identifiableTotal)&&void 0!==e?e:0}get anonymousAttempts(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().anonymous)&&void 0!==e?e:[]}get anonymousAttemptsTotal(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().anonymousTotal)&&void 0!==e?e:0}ngAfterViewInit(){var e=this;return(0,f.Z)((function*(){try{e.courseId=r.b.getRequiredRouteNumberParam("courseId");const t=r.b.getRequiredRouteNumberParam("cmId"),n=b.p.getOrCreateSource(AddonModFeedbackAttemptsSource,[e.courseId,t]);n.selectedGroup=r.b.getRouteNumberParam("group")||0,e.promisedAttempts.resolve(new AddonModFeedbackAttemptsManager(n,e.route.component))}catch(e){return I.OQ.showErrorModal(e),r.b.back(),void 0}const t=yield e.promisedAttempts;try{e.fetchFailed=!1,yield t.getSource().loadFeedback(),yield t.load(),e.logView()}catch(t){e.fetchFailed=!0,I.OQ.showErrorModalDefault(t,"core.course.errorgetmodule",!0)}yield t.start(e.splitView)}))()}ngOnDestroy(){var e;null===(e=this.attempts)||void 0===e||e.destroy()}fetchMoreAttempts(e){var t=this;return(0,f.Z)((function*(){const n=yield t.promisedAttempts;try{t.fetchFailed=!1,yield n.load()}catch(e){t.fetchFailed=!0,I.OQ.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{e&&e()}}))()}refreshFeedback(e){var t=this;return(0,f.Z)((function*(){const n=yield t.promisedAttempts;try{t.fetchFailed=!1,yield x.Tr.ignoreErrors(n.getSource().invalidateCache()),yield n.getSource().loadFeedback(),yield n.reload()}catch(e){t.fetchFailed=!0,I.OQ.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{e.complete()}}))()}reloadAttempts(){var e=this;return(0,f.Z)((function*(){const t=yield e.promisedAttempts;yield t.reload()}))()}}return(e=AddonModFeedbackAttemptsPage).ɵfac=function AddonModFeedbackAttemptsPage_Factory(t){return new(t||e)(_.Y36(o.gz))},e.ɵcmp=_.Xpm({type:e,selectors:[["page-addon-mod-feedback-attempts"]],viewQuery:function AddonModFeedbackAttemptsPage_Query(e,t){if(1&e&&_.Gf(h.A,5),2&e){let e;_.iGM(e=_.CRH())&&(t.splitView=e.first)}},decls:20,vars:18,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-no-margin"],[3,"groupInfo","selected","courseId","selectedChange"],[4,"ngIf"],[3,"enabled","error","action"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"detail","click"],["slot","start",3,"user","linkProfile"],[1,"item-heading"],["slot","start",3,"linkProfile"]],template:function AddonModFeedbackAttemptsPage_Template(e,t){1&e&&(_.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_._UZ(3,"ion-back-button",1),_.ALo(4,"translate"),_.qZA(),_.TgZ(5,"ion-title")(6,"h1"),_._uU(7),_.ALo(8,"translate"),_.qZA()()()(),_.TgZ(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),_.NdJ("ionRefresh",(function AddonModFeedbackAttemptsPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshFeedback(e.target)})),_._UZ(12,"ion-refresher-content",3),_.ALo(13,"translate"),_.qZA(),_.TgZ(14,"core-loading",4)(15,"ion-list",5)(16,"core-group-selector",6),_.NdJ("selectedChange",(function AddonModFeedbackAttemptsPage_Template_core_group_selector_selectedChange_16_listener(e){return t.selectedGroup=e}))("selectedChange",(function AddonModFeedbackAttemptsPage_Template_core_group_selector_selectedChange_16_listener(){return t.reloadAttempts()})),_.qZA(),_.YNc(17,AddonModFeedbackAttemptsPage_ng_container_17_Template,7,7,"ng-container",7)(18,AddonModFeedbackAttemptsPage_ng_container_18_Template,7,7,"ng-container",7),_.TgZ(19,"core-infinite-loading",8),_.NdJ("action",(function AddonModFeedbackAttemptsPage_Template_core_infinite_loading_action_19_listener(e){return t.fetchMoreAttempts(e)})),_.qZA()()()()()),2&e&&(_.xp6(3),_.Q6J("text",_.lcZ(4,12,"core.back")),_.xp6(4),_.Oqu(_.lcZ(8,14,"addon.mod_feedback.responses")),_.xp6(4),_.Q6J("disabled",!t.attempts||!t.attempts.loaded),_.xp6(),_.s9C("pullingText",_.lcZ(13,16,"core.pulltorefresh")),_.xp6(2),_.Q6J("hideUntil",t.attempts&&t.attempts.loaded),_.xp6(2),_.Q6J("groupInfo",t.groupInfo)("selected",t.selectedGroup)("courseId",t.courseId),_.xp6(),_.Q6J("ngIf",t.identifiableAttemptsTotal>0),_.xp6(),_.Q6J("ngIf",t.identifiableAttemptsTotal===t.identifiableAttempts.length&&t.anonymousAttemptsTotal>0),_.xp6(),_.Q6J("enabled",t.attempts&&t.attempts.loaded&&!t.attempts.completed)("error",t.fetchFailed))},dependencies:[y.sg,y.O5,w.Q,Q.n,q.r,h.A,J.X,m.t,g.Sm,g.W2,g.Gu,g.Ie,g.rH,g.Q$,g.q_,g.nJ,g.Wo,g.wd,g.sr,g.oU,N.o,p.X$],encapsulation:2}),AddonModFeedbackAttemptsPage})();class AddonModFeedbackAttemptsManager extends A.a{}var C=n(23966),R=n(38049),U=n(71460),E=n(34749),L=n(80571),S=n(76025),G=n(97037),$=n(5065);function AddonModFeedbackAttemptPage_h1_6_Template(e,t){if(1&e&&(_.TgZ(0,"h1"),_._uU(1),_.qZA()),2&e){const e=_.oxw();_.xp6(),_.Oqu(e.attempt.fullname)}}function AddonModFeedbackAttemptPage_h1_7_Template(e,t){1&e&&(_.TgZ(0,"h1"),_._uU(1),_.ALo(2,"translate"),_.qZA()),2&e&&(_.xp6(),_.Oqu(_.lcZ(2,1,"addon.mod_feedback.anonymous_user")))}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template(e,t){if(1&e&&(_.TgZ(0,"p"),_._uU(1),_.ALo(2,"coreFormatDate"),_.qZA()),2&e){const e=_.oxw(3);_.xp6(),_.Oqu(_.lcZ(2,1,1e3*e.attempt.timemodified))}}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template(e,t){if(1&e&&(_.TgZ(0,"ion-item",9),_.ALo(1,"translate"),_._UZ(2,"core-user-avatar",10),_.TgZ(3,"ion-label")(4,"h2"),_._uU(5),_.qZA(),_.YNc(6,AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template,3,3,"p",2),_.qZA()()),2&e){const e=_.oxw(2);_.Q6J("userId",e.attempt.userid)("courseId",e.attempt.courseid),_.uIk("aria-label",_.lcZ(1,7,"core.user.viewprofile")),_.xp6(2),_.Q6J("user",e.attempt)("linkProfile",!1),_.xp6(3),_.Oqu(e.attempt.fullname),_.xp6(),_.Q6J("ngIf",e.attempt.timemodified)}}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template(e,t){if(1&e&&(_.TgZ(0,"ion-item",11),_._UZ(1,"core-user-avatar",12),_.TgZ(2,"ion-label")(3,"h2"),_._uU(4),_.ALo(5,"translate"),_.qZA(),_.TgZ(6,"p"),_._uU(7),_.ALo(8,"translate"),_.qZA()()()),2&e){const e=_.oxw(2);_.xp6(),_.Q6J("linkProfile",!1),_.xp6(3),_.Oqu(_.lcZ(5,4,"addon.mod_feedback.anonymous_user")),_.xp6(3),_.AsE("",_.lcZ(8,6,"addon.mod_feedback.response_nr"),": ",e.anonAttempt.number,"")}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template(e,t){1&e&&_._UZ(0,"core-spacer")}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template(e,t){if(1&e&&(_.TgZ(0,"span"),_._uU(1),_.qZA()),2&e){const e=_.oxw(3).$implicit;_.xp6(),_.hij("",e.itemnumber,". ")}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template(e,t){if(1&e&&(_.TgZ(0,"p",17),_.YNc(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template,2,1,"span",2),_._UZ(2,"core-format-text",18),_.qZA()),2&e){const e=_.oxw(2).$implicit,t=_.oxw(3);_.Q6J("core-mark-required",e.required),_.xp6(),_.Q6J("ngIf",t.feedback.autonumbering&&e.itemnumber),_.xp6(),_.Q6J("component",t.component)("componentId",t.cmId)("text",e.name)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template(e,t){if(1&e&&(_.TgZ(0,"p"),_._UZ(1,"core-format-text",18),_.qZA()),2&e){const e=_.oxw(2).$implicit,t=_.oxw(3);_.xp6(),_.Q6J("component",t.component)("componentId",t.cmId)("text",e.submittedValue)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template(e,t){if(1&e&&(_.TgZ(0,"ion-item",15)(1,"ion-label"),_.YNc(2,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template,3,7,"p",16)(3,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template,2,5,"p",2),_.qZA()()),2&e){const e=_.oxw().$implicit;_.Q6J("color",e.dependitem>0?"light":""),_.xp6(2),_.Q6J("ngIf",e.name),_.xp6(),_.Q6J("ngIf",e.submittedValue)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template(e,t){if(1&e&&(_.ynx(0),_.YNc(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template,1,0,"core-spacer",2)(2,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template,4,3,"ion-item",14),_.BQk()),2&e){const e=t.$implicit;_.xp6(),_.Q6J("ngIf","pagebreak"===e.typ),_.xp6(),_.Q6J("ngIf","pagebreak"!==e.typ)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template(e,t){if(1&e&&(_.ynx(0),_.YNc(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template,3,2,"ng-container",13),_.BQk()),2&e){const e=_.oxw(2);_.xp6(),_.Q6J("ngForOf",e.items)}}function AddonModFeedbackAttemptPage_ion_list_10_Template(e,t){if(1&e&&(_.TgZ(0,"ion-list",6),_.YNc(1,AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template,7,9,"ion-item",7)(2,AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template,9,8,"ion-item",8)(3,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template,2,1,"ng-container",2),_.qZA()),2&e){const e=_.oxw();_.xp6(),_.Q6J("ngIf",e.attempt),_.xp6(),_.Q6J("ngIf",e.anonAttempt),_.xp6(),_.Q6J("ngIf",e.items&&e.items.length)}}let D=(()=>{var e;class AddonModFeedbackAttemptPage{constructor(){this.items=[],this.component=T.P.COMPONENT,this.loaded=!1,this.cmId=r.b.getRequiredRouteNumberParam("cmId"),this.courseId=r.b.getRequiredRouteNumberParam("courseId"),this.attemptId=r.b.getRequiredRouteNumberParam("attemptId"),this.groupId=r.b.getRouteNumberParam("groupId");const e=b.p.getOrCreateSource(AddonModFeedbackAttemptsSource,[this.courseId,this.cmId]);this.attempts=new AddonModFeedbackAttemptsSwipeManager(e),this.logView=Z.V.once((()=>{this.feedback&&v.ke.logEvent({type:v.gM.VIEW_ITEM,ws:"mod_feedback_get_responses_analysis",name:this.feedback.name,data:{id:this.attemptId,feedbackid:this.feedback.id,category:"feedback"},url:`/mod/feedback/show_entries.php?id=${this.cmId}`+(this.attempt?`userid=${this.attempt.userid}`:"")+`&showcompleted=${this.attemptId}`})}))}ngOnInit(){var e=this;return(0,f.Z)((function*(){try{yield e.attempts.start()}catch(e){return I.OQ.showErrorModal(e),r.b.back(),void 0}e.fetchData()}))()}ngOnDestroy(){this.attempts.destroy()}fetchData(){var e=this;return(0,f.Z)((function*(){try{e.feedback=yield T.p.getFeedback(e.courseId,e.cmId);const t=yield T.p.getAttempt(e.feedback.id,e.attemptId,{cmId:e.cmId,groupId:e.groupId});e.isAnonAttempt(t)?(e.anonAttempt=t,delete e.attempt):(e.attempt=(yield P.S.addImageProfile([t]))[0],delete e.anonAttempt);const n=yield T.p.getItems(e.feedback.id,{cmId:e.cmId});e.items=n.items.map((e=>{const n=P.S.getItemForm(e,!0);if(!n)return;const o=n;if("label"==e.typ)o.submittedValue=E._1.replacePluginfileUrls(e.presentation,e.itemfiles);else for(const n in t.responses)if(t.responses[n].id==e.id){o.submittedValue=t.responses[n].printval;break}return o})).filter((e=>e)),e.logView()}catch(e){I.OQ.showErrorModalDefault(e,"core.course.errorgetmodule",!0),r.b.back()}finally{e.loaded=!0}}))()}isAnonAttempt(e){return!("fullname"in e)}}return(e=AddonModFeedbackAttemptPage).ɵfac=function AddonModFeedbackAttemptPage_Factory(t){return new(t||e)},e.ɵcmp=_.Xpm({type:e,selectors:[["page-addon-mod-feedback-attempt"]],decls:11,vars:8,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[3,"core-swipe-navigation"],[3,"hideUntil"],["class","ion-no-margin",4,"ngIf"],[1,"ion-no-margin"],["class","ion-text-wrap","core-user-link","",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],["core-user-link","",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","linkProfile"],[1,"ion-text-wrap"],["slot","start",3,"linkProfile"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",3,"color",4,"ngIf"],[1,"ion-text-wrap",3,"color"],["class","item-heading",3,"core-mark-required",4,"ngIf"],[1,"item-heading",3,"core-mark-required"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","courseId"]],template:function AddonModFeedbackAttemptPage_Template(e,t){1&e&&(_.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_._UZ(3,"ion-back-button",1),_.ALo(4,"translate"),_.qZA(),_.TgZ(5,"ion-title"),_.YNc(6,AddonModFeedbackAttemptPage_h1_6_Template,2,1,"h1",2)(7,AddonModFeedbackAttemptPage_h1_7_Template,3,3,"h1",2),_.qZA()()(),_.TgZ(8,"ion-content",3)(9,"core-loading",4),_.YNc(10,AddonModFeedbackAttemptPage_ion_list_10_Template,4,3,"ion-list",5),_.qZA()()),2&e&&(_.xp6(3),_.Q6J("text",_.lcZ(4,6,"core.back")),_.xp6(3),_.Q6J("ngIf",t.attempt),_.xp6(),_.Q6J("ngIf",t.anonAttempt),_.xp6(),_.Q6J("core-swipe-navigation",t.attempts),_.xp6(),_.Q6J("hideUntil",t.loaded),_.xp6(),_.Q6J("ngIf",t.attempt||t.anonAttempt))},dependencies:[y.sg,y.O5,q.r,L.O,J.X,S.w,s.r,G.j,$.g,m.t,g.Sm,g.W2,g.Gu,g.Ie,g.Q$,g.q_,g.wd,g.sr,g.oU,N.o,p.X$],encapsulation:2}),AddonModFeedbackAttemptPage})();class AddonModFeedbackAttemptsSwipeManager extends U.t{getSelectedItemPathFromRoute(e){return(e instanceof o.De?e:e.snapshot).params.attemptId}}var Y=n(73180),V=n(81370),B=n(53564),K=n(10727),W=n(98370),j=n(77740),H=n(54771),X=n(35832),z=n(86700),ee=n(19289),te=n(22068),ne=n(56223);function AddonModFeedbackFormPage_ng_container_10_p_7_Template(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1),_.ALo(2,"translate"),_.qZA()),2&e&&(_.xp6(),_.Oqu(_.lcZ(2,1,"addon.mod_feedback.anonymous")))}function AddonModFeedbackFormPage_ng_container_10_p_8_Template(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1),_.ALo(2,"translate"),_.qZA()),2&e&&(_.xp6(),_.Oqu(_.lcZ(2,1,"addon.mod_feedback.non_anonymous")))}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_core_spacer_1_Template(e,t){1&e&&_._UZ(0,"core-spacer")}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_ng_container_1_Template(e,t){1&e&&_.GkF(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_p_2_Template(e,t){if(1&e&&(_.TgZ(0,"p"),_._UZ(1,"core-format-text",20),_.qZA()),2&e){const e=_.oxw(3).$implicit,t=_.oxw(2);_.xp6(),_.Q6J("component",t.component)("componentId",t.cmId)("text",e.presentation)("contextInstanceId",t.cmId)("wsNotFiltered",!0)("courseId",t.courseId)}}const form_c0=e=>({item:e});function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_Template(e,t){if(1&e&&(_.TgZ(0,"ion-label"),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_ng_container_1_Template,1,0,"ng-container",19)(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_p_2_Template,2,6,"p",5),_.qZA()),2&e){const e=_.oxw(2).$implicit;_.oxw(2);const t=_.MAs(14);_.xp6(),_.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",_.VKq(3,form_c0,e)),_.xp6(),_.Q6J("ngIf","label"===e.templateName)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_ng_container_1_Template(e,t){1&e&&_.GkF(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-input",21),_.NdJ("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_Template_ion_input_ngModelChange_0_listener(t){_.CHM(e);const n=_.oxw(2).$implicit;return _.KtG(n.value=t)})),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_ng_container_1_Template,1,0,"ng-container",19),_.qZA()}if(2&e){const e=_.oxw(2).$implicit;_.oxw(2);const t=_.MAs(14);_.hYB("name","",e.typ,"_",e.id,""),_.s9C("maxlength",e.length),_.Q6J("ngModel",e.value)("required",e.required),_.xp6(),_.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",_.VKq(7,form_c0,e))}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ng_container_2_Template(e,t){1&e&&_.GkF(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_span_3_Template(e,t){1&e&&(_.TgZ(0,"span"),_._uU(1,", "),_.qZA())}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_Template(e,t){if(1&e&&(_.TgZ(0,"ion-text",24),_._uU(1),_.ALo(2,"translate"),_.YNc(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_span_3_Template,2,0,"span",5),_._uU(4),_.qZA()),2&e){const e=_.oxw(3).$implicit;_.xp6(),_.AsE(" ",_.lcZ(2,4,"addon.mod_feedback.numberoutofrange")," [",e.rangefrom," "),_.xp6(2),_.Q6J("ngIf",e.rangefrom&&e.rangeto),_.xp6(),_.hij("",e.rangeto,"] ")}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_Template(e,t){if(1&e){const e=_.EpF();_.ynx(0),_.TgZ(1,"ion-input",22),_.NdJ("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_Template_ion_input_ngModelChange_1_listener(t){_.CHM(e);const n=_.oxw(2).$implicit;return _.KtG(n.value=t)})),_.YNc(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ng_container_2_Template,1,0,"ng-container",19),_.qZA(),_.YNc(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_Template,5,6,"ion-text",23),_.BQk()}if(2&e){const e=_.oxw(2).$implicit;_.oxw(2);const t=_.MAs(14);_.xp6(),_.hYB("name","",e.typ,"_",e.id,""),_.Q6J("ngModel",e.value)("required",e.required),_.xp6(),_.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",_.VKq(7,form_c0,e)),_.xp6(),_.Q6J("ngIf",e.hasError)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_ng_container_1_Template(e,t){1&e&&_.GkF(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-textarea",25),_.NdJ("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_Template_ion_textarea_ngModelChange_0_listener(t){_.CHM(e);const n=_.oxw(2).$implicit;return _.KtG(n.value=t)})),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_ng_container_1_Template,1,0,"ng-container",19),_.qZA()}if(2&e){const e=_.oxw(2).$implicit;_.oxw(2);const t=_.MAs(14);_.hYB("name","",e.typ,"_",e.id,""),_.Q6J("required",e.required)("ngModel",e.value),_.xp6(),_.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",_.VKq(6,form_c0,e))}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ng_container_2_Template(e,t){1&e&&_.GkF(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ion_select_option_3_Template(e,t){if(1&e&&(_.TgZ(0,"ion-select-option",28),_._UZ(1,"core-format-text",20),_.qZA()),2&e){const e=t.$implicit,n=_.oxw(5);_.Q6J("value",e.value),_.xp6(),_.Q6J("component",n.component)("componentId",n.cmId)("text",e.label)("contextInstanceId",n.cmId)("wsNotFiltered",!0)("courseId",n.courseId)}}const _c1=e=>({header:e});function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-select",26),_.NdJ("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_Template_ion_select_ngModelChange_0_listener(t){_.CHM(e);const n=_.oxw(2).$implicit;return _.KtG(n.value=t)})),_.ALo(1,"translate"),_.YNc(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ng_container_2_Template,1,0,"ng-container",19)(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ion_select_option_3_Template,2,7,"ion-select-option",27),_.qZA()}if(2&e){const e=_.oxw(2).$implicit;_.oxw(2);const t=_.MAs(14);_.hYB("name","",e.typ,"_",e.id,""),_.Q6J("required",e.required)("ngModel",e.value)("cancelText",_.lcZ(1,9,"core.cancel"))("interfaceOptions",_.VKq(11,_c1,e.name)),_.xp6(2),_.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",_.VKq(13,form_c0,e)),_.xp6(),_.Q6J("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_ion_item_1_Template(e,t){if(1&e&&(_.TgZ(0,"ion-item",10)(1,"ion-radio",28),_._UZ(2,"core-format-text",20),_.qZA()()),2&e){const e=t.$implicit,n=_.oxw(5);_.xp6(),_.Q6J("value",e.value),_.xp6(),_.Q6J("component",n.component)("componentId",n.cmId)("text",e.label)("contextInstanceId",n.cmId)("wsNotFiltered",!0)("courseId",n.courseId)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-radio-group",29),_.NdJ("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_Template_ion_radio_group_ngModelChange_0_listener(t){_.CHM(e);const n=_.oxw(2).$implicit;return _.KtG(n.value=t)})),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_ion_item_1_Template,3,7,"ion-item",30),_.qZA()}if(2&e){const e=_.oxw(2).$implicit;_.hYB("name","",e.typ,"_",e.id,""),_.Q6J("ngModel",e.value)("required",e.required),_.xp6(),_.Q6J("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_ion_item_1_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-item")(1,"ion-checkbox",31),_.NdJ("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_ion_item_1_Template_ion_checkbox_ngModelChange_1_listener(t){const n=_.CHM(e);return _.KtG(n.$implicit.checked=t)})),_._UZ(2,"core-format-text",20),_.qZA()()}if(2&e){const e=t.$implicit,n=_.oxw(3).$implicit,o=_.oxw(2);_.xp6(),_.hYB("name","",n.typ,"_",n.id,""),_.Q6J("required",n.required)("ngModel",e.checked),_.xp6(),_.Q6J("component",o.component)("componentId",o.cmId)("text",e.label)("contextInstanceId",o.cmId)("wsNotFiltered",!0)("courseId",o.courseId)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_Template(e,t){if(1&e&&(_.ynx(0),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_ion_item_1_Template,3,10,"ion-item",12),_.BQk()),2&e){const e=_.oxw(2).$implicit;_.xp6(),_.Q6J("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_core_recaptcha_1_Template(e,t){if(1&e&&_._UZ(0,"core-recaptcha",34),2&e){const e=_.oxw(3).$implicit;_.Q6J("publicKey",e.captcha.recaptchapublickey)("model",e)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_div_2_Template(e,t){1&e&&(_.TgZ(0,"div",35)(1,"ion-item"),_._UZ(2,"ion-icon",36),_.TgZ(3,"ion-label"),_._uU(4),_.ALo(5,"translate"),_.qZA()()()),2&e&&(_.xp6(4),_.Oqu(_.lcZ(5,1,"addon.mod_feedback.captchaofflinewarning")))}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_Template(e,t){if(1&e&&(_.ynx(0),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_core_recaptcha_1_Template,1,2,"core-recaptcha",32)(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_div_2_Template,6,3,"div",33),_.BQk()),2&e){const e=_.oxw(2).$implicit,t=_.oxw(2);_.xp6(),_.Q6J("ngIf",!t.preview&&!t.offline),_.xp6(),_.Q6J("ngIf",!t.preview&&(!e.captcha||t.offline))}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_Template(e,t){if(1&e&&(_.ynx(0),_.TgZ(1,"ion-item",14),_.YNc(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_Template,3,5,"ion-label",5)(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_Template,2,9,"ion-input",15)(4,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_Template,4,9,"ng-container",5)(5,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_Template,2,8,"ion-textarea",16)(6,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_Template,4,15,"ion-select",17),_.qZA(),_.YNc(7,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_Template,2,5,"ion-radio-group",18)(8,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_Template,2,1,"ng-container",5)(9,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_Template,3,2,"ng-container",5),_.BQk()),2&e){const e=_.oxw().$implicit;_.xp6(),_.ekj("core-danger-item",e.isEmpty||e.hasError),_.Q6J("color",e.dependitem>0?"light":""),_.xp6(),_.Q6J("ngIf",!e.slottedLabel),_.xp6(),_.Q6J("ngIf","textfield"===e.templateName),_.xp6(),_.Q6J("ngIf","numeric"===e.templateName),_.xp6(),_.Q6J("ngIf","textarea"===e.templateName),_.xp6(),_.Q6J("ngIf","multichoice-d"===e.templateName),_.xp6(),_.Q6J("ngIf","multichoice-r"===e.templateName),_.xp6(),_.Q6J("ngIf","multichoice-c"===e.templateName),_.xp6(),_.Q6J("ngIf","captcha"===e.templateName)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_Template(e,t){if(1&e&&(_.ynx(0),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_core_spacer_1_Template,1,0,"core-spacer",5)(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_Template,10,11,"ng-container",5),_.BQk()),2&e){const e=t.$implicit;_.xp6(),_.Q6J("ngIf","pagebreak"===e.typ),_.xp6(),_.Q6J("ngIf","pagebreak"!==e.typ)}}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-col")(1,"ion-button",38),_.NdJ("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template_ion_button_click_1_listener(){_.CHM(e);const t=_.oxw(3);return _.KtG(t.gotoPage(!0))})),_._UZ(2,"ion-icon",39),_._uU(3),_.ALo(4,"translate"),_.qZA()()}2&e&&(_.xp6(3),_.hij(" ",_.lcZ(4,1,"core.previous")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-col")(1,"ion-button",40),_.NdJ("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template_ion_button_click_1_listener(){_.CHM(e);const t=_.oxw(3);return _.KtG(t.gotoPage(!1))})),_._uU(2),_.ALo(3,"translate"),_._UZ(4,"ion-icon",41),_.qZA()()}2&e&&(_.xp6(2),_.hij(" ",_.lcZ(3,1,"core.next")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-col")(1,"ion-button",40),_.NdJ("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template_ion_button_click_1_listener(){_.CHM(e);const t=_.oxw(3);return _.KtG(t.gotoPage(!1))})),_._uU(2),_.ALo(3,"translate"),_.qZA()()}2&e&&(_.xp6(2),_.hij(" ",_.lcZ(3,1,"core.submit")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_Template(e,t){if(1&e&&(_.TgZ(0,"ion-row",37),_.YNc(1,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template,5,3,"ion-col",5)(2,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template,5,3,"ion-col",5)(3,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template,4,3,"ion-col",5),_.qZA()),2&e){const e=_.oxw(2);_.xp6(),_.Q6J("ngIf",e.hasPrevPage),_.xp6(),_.Q6J("ngIf",e.hasNextPage),_.xp6(),_.Q6J("ngIf",!e.hasNextPage)}}function AddonModFeedbackFormPage_ng_container_10_Template(e,t){if(1&e&&(_.ynx(0),_.TgZ(1,"ion-list",9)(2,"ion-item",10)(3,"ion-label")(4,"p",11),_._uU(5),_.ALo(6,"translate"),_.qZA(),_.YNc(7,AddonModFeedbackFormPage_ng_container_10_p_7_Template,3,3,"p",5)(8,AddonModFeedbackFormPage_ng_container_10_p_8_Template,3,3,"p",5),_.qZA()(),_.YNc(9,AddonModFeedbackFormPage_ng_container_10_ng_container_9_Template,3,2,"ng-container",12)(10,AddonModFeedbackFormPage_ng_container_10_ion_row_10_Template,4,3,"ion-row",13),_.qZA(),_.BQk()),2&e){const e=_.oxw();_.xp6(5),_.Oqu(_.lcZ(6,5,"addon.mod_feedback.mode")),_.xp6(2),_.Q6J("ngIf",e.access.isanonymous),_.xp6(),_.Q6J("ngIf",!e.access.isanonymous),_.xp6(),_.Q6J("ngForOf",e.items),_.xp6(),_.Q6J("ngIf",!e.preview)}}function AddonModFeedbackFormPage_ion_card_11_p_4_Template(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1),_.ALo(2,"translate"),_.qZA()),2&e&&(_.xp6(),_.hij(" ",_.lcZ(2,1,"addon.mod_feedback.this_feedback_is_already_submitted")," "))}function AddonModFeedbackFormPage_ion_card_11_p_5_Template(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1),_.ALo(2,"translate"),_.qZA()),2&e&&(_.xp6(),_.hij(" ",_.lcZ(2,1,"addon.mod_feedback.feedback_submitted_offline")," "))}function AddonModFeedbackFormPage_ion_card_11_core_format_text_6_Template(e,t){if(1&e&&_._UZ(0,"core-format-text",45),2&e){const e=_.oxw(2);_.Q6J("component",e.component)("text",e.completionPageContents)("contextInstanceId",e.cmId)("courseId",e.courseId)}}function AddonModFeedbackFormPage_ion_card_11_Template(e,t){if(1&e&&(_.TgZ(0,"ion-card",42)(1,"ion-item",10),_._UZ(2,"ion-icon",43),_.TgZ(3,"ion-label"),_.YNc(4,AddonModFeedbackFormPage_ion_card_11_p_4_Template,3,3,"p",5)(5,AddonModFeedbackFormPage_ion_card_11_p_5_Template,3,3,"p",5)(6,AddonModFeedbackFormPage_ion_card_11_core_format_text_6_Template,1,4,"core-format-text",44),_.qZA()()()),2&e){const e=_.oxw();_.xp6(4),_.Q6J("ngIf",!e.completionPageContents&&!e.completedOffline),_.xp6(),_.Q6J("ngIf",!e.completionPageContents&&e.completedOffline),_.xp6(),_.Q6J("ngIf",e.completionPageContents)}}function AddonModFeedbackFormPage_div_12_ion_button_2_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"ion-button",50),_.NdJ("click",(function AddonModFeedbackFormPage_div_12_ion_button_2_Template_ion_button_click_0_listener(){_.CHM(e);const t=_.oxw(2);return _.KtG(t.showAnalysis())})),_._UZ(1,"ion-icon",51),_._uU(2),_.ALo(3,"translate"),_.qZA()}2&e&&(_.xp6(2),_.hij(" ",_.lcZ(3,1,"addon.mod_feedback.completed_feedbacks")," "))}function AddonModFeedbackFormPage_div_12_ng_container_4_Template(e,t){1&e&&(_.ynx(0),_._uU(1),_.ALo(2,"translate"),_.BQk()),2&e&&(_.xp6(),_.Oqu(_.lcZ(2,1,"core.continue")))}function AddonModFeedbackFormPage_div_12_ng_container_5_Template(e,t){1&e&&(_.ynx(0),_._uU(1),_.ALo(2,"translate"),_.BQk()),2&e&&(_.xp6(),_.Oqu(_.lcZ(2,1,"core.course.nextactivity")))}function AddonModFeedbackFormPage_div_12_Template(e,t){if(1&e){const e=_.EpF();_.TgZ(0,"div",46)(1,"div",47),_.YNc(2,AddonModFeedbackFormPage_div_12_ion_button_2_Template,4,3,"ion-button",48),_.TgZ(3,"ion-button",49),_.NdJ("click",(function AddonModFeedbackFormPage_div_12_Template_ion_button_click_3_listener(){_.CHM(e);const t=_.oxw();return _.KtG(t.continue())})),_.YNc(4,AddonModFeedbackFormPage_div_12_ng_container_4_Template,3,3,"ng-container",5)(5,AddonModFeedbackFormPage_div_12_ng_container_5_Template,3,3,"ng-container",5),_.qZA()()()}if(2&e){const e=_.oxw();_.xp6(2),_.Q6J("ngIf",e.access.canviewanalysis),_.xp6(2),_.Q6J("ngIf",!e.siteAfterSubmit),_.xp6(),_.Q6J("ngIf",e.siteAfterSubmit)}}function AddonModFeedbackFormPage_ng_template_13_p_0_span_1_Template(e,t){if(1&e&&(_.TgZ(0,"span"),_._uU(1),_.qZA()),2&e){const e=_.oxw(2).item;_.xp6(),_.hij("",e.itemnumber,". ")}}function AddonModFeedbackFormPage_ng_template_13_p_0_span_3_Template(e,t){if(1&e&&(_.TgZ(0,"span",56),_._uU(1),_.qZA()),2&e){const e=_.oxw(2).item;_.xp6(),_.Oqu(e.postfix)}}function AddonModFeedbackFormPage_ng_template_13_p_0_Template(e,t){if(1&e&&(_.TgZ(0,"p",53),_.YNc(1,AddonModFeedbackFormPage_ng_template_13_p_0_span_1_Template,2,1,"span",5),_._UZ(2,"core-format-text",54),_.YNc(3,AddonModFeedbackFormPage_ng_template_13_p_0_span_3_Template,2,1,"span",55),_.qZA()),2&e){const e=_.oxw().item,t=_.oxw();_.Q6J("core-mark-required",e.required)("slot",e.slottedLabel?"label":void 0),_.xp6(),_.Q6J("ngIf",t.feedback.autonumbering&&e.itemnumber),_.xp6(),_.Q6J("component",t.component)("componentId",t.cmId)("text",e.name)("contextInstanceId",t.cmId)("courseId",t.courseId)("wsNotFiltered",!0),_.xp6(),_.Q6J("ngIf",e.postfix)}}function AddonModFeedbackFormPage_ng_template_13_Template(e,t){if(1&e&&_.YNc(0,AddonModFeedbackFormPage_ng_template_13_p_0_Template,4,10,"p",52),2&e){_.Q6J("ngIf",t.item.name)}}let oe=(()=>{var e;class AddonModFeedbackFormPage{constructor(){this.forceLeave=!1,this.preview=!1,this.fromIndex=!1,this.component=T.P.COMPONENT,this.offline=!1,this.feedbackLoaded=!1,this.items=[],this.hasPrevPage=!1,this.hasNextPage=!1,this.completed=!1,this.completedOffline=!1,this.currentSite=B.m9.getRequiredCurrentSite(),this.onlineObserver=V.AS.onChange().subscribe((()=>{K.R0.run((()=>{this.offline=!V.AS.isOnline()}))}))}ngOnInit(){var e=this;return(0,f.Z)((function*(){try{e.cmId=r.b.getRequiredRouteNumberParam("cmId"),e.courseId=r.b.getRequiredRouteNumberParam("courseId"),e.currentPage=r.b.getRouteNumberParam("page"),e.title=r.b.getRouteParam("title"),e.preview=!!r.b.getRouteBooleanParam("preview"),e.fromIndex=!!r.b.getRouteBooleanParam("fromIndex")}catch(e){return I.OQ.showErrorModal(e),r.b.back(),void 0}if(yield e.fetchData(),!e.access||e.access.isempty&&!e.access.canedititems&&!e.access.canviewreports)return I.OQ.showErrorModal(K.vN.instant("core.nopermissiontoaccesspage")),r.b.back(),void 0;if(e.feedback)try{yield T.p.logView(e.feedback.id,!0),Y.FO.checkModuleCompletion(e.courseId,e.module.completiondata)}catch{}}))()}ionViewDidEnter(){this.forceLeave=!1}canLeave(){var e=this;return(0,f.Z)((function*(){if(e.forceLeave)return!0;if(!e.preview){const t=P.S.getPageItemsResponses(e.items);e.items&&!e.completed&&e.originalData&&(x.Tr.basicLeftCompare(t,e.originalData,3)||(yield I.OQ.showConfirm(K.vN.instant("core.confirmcanceledit"))))}return!0}))()}fetchData(){var e=this;return(0,f.Z)((function*(){try{e.module=yield Y.FO.getModule(e.cmId,e.courseId,void 0,!0,!1,e.currentSite.getId()),e.offline=!V.AS.isOnline();const n={cmId:e.cmId,readingStrategy:e.offline?1:2,siteId:e.currentSite.getId()};e.feedback=yield T.p.getFeedback(e.courseId,e.cmId),e.title=e.feedback.name||e.title,yield e.fetchAccessData(n);let o=0;var t;if(e.preview||!e.access.cansubmit||e.access.isempty)e.preview=!0;else o=null!==(t=e.currentPage)&&void 0!==t?t:yield e.fetchResumePage(n);yield e.fetchFeedbackPageData(o)}catch(t){I.OQ.showErrorModalDefault(t,"core.course.errorgetmodule",!0),e.forceLeave=!0,r.b.back()}finally{e.feedbackLoaded=!0}}))()}fetchAccessData(e){var t=this;return(0,f.Z)((function*(){try{t.access=yield T.p.getFeedbackAccessInformation(t.feedback.id,e)}catch(n){if(t.offline||x.Tr.isWebServiceError(n))throw n;t.offline=!0,e.readingStrategy=1,t.access=yield T.p.getFeedbackAccessInformation(t.feedback.id,e)}}))()}fetchResumePage(e){var t=this;return(0,f.Z)((function*(){try{return yield T.p.getResumePage(t.feedback.id,e)}catch(n){if(t.offline||x.Tr.isWebServiceError(n))throw n;return t.offline=!0,e.readingStrategy=1,T.p.getResumePage(t.feedback.id,e)}}))()}fetchFeedbackPageData(e=0){var t=this;return(0,f.Z)((function*(){t.items=[];const n=yield t.fetchPageItems(e);if(t.items=n.items.map((e=>P.S.getItemForm(e,t.preview))).filter((e=>e)),!t.preview){const e=x.Tr.clone(t.items);t.originalData=P.S.getPageItemsResponses(e)}t.analyticsLogEvent()}))()}fetchPageItems(e){var t=this;return(0,f.Z)((function*(){const n={cmId:t.cmId,readingStrategy:t.offline?1:2,siteId:t.currentSite.getId()};if(t.preview){const e=yield T.p.getItems(t.feedback.id,n);return{items:e.items,warnings:e.warnings,hasnextpage:!1,hasprevpage:!1}}let o;t.currentPage=e;try{o=yield T.p.getPageItemsWithValues(t.feedback.id,e,n)}catch(a){if(t.offline||x.Tr.isWebServiceError(a))throw a;t.offline=!0,n.readingStrategy=1,o=yield T.p.getPageItemsWithValues(t.feedback.id,e,n)}return t.hasPrevPage=!!o.hasprevpage,t.hasNextPage=!!o.hasnextpage,o}))()}gotoPage(e){var t=this;return(0,f.Z)((function*(){var n;null===(n=t.content)||void 0===n||n.scrollToTop(),t.feedbackLoaded=!1;const o=P.S.getPageItemsResponses(t.items),a=t.items.some((e=>e.isEmpty||e.hasError));try{yield x.Tr.ignoreErrors(j.q.syncFeedback(t.feedback.id));const n=yield T.p.processPage(t.feedback.id,t.currentPage,o,{goPrevious:e,formHasErrors:a,courseId:t.courseId,cmId:t.cmId});n.completed?(t.items=[],t.completed=!0,t.completedOffline=!!n.offline,t.completionPageContents=n.completionpagecontents,t.siteAfterSubmit=n.siteaftersubmit,W.R.trigger(W.R.ACTIVITY_DATA_SENT,{module:"feedback"}),yield Promise.all([T.p.invalidateFeedbackAccessInformationData(t.feedback.id),T.p.invalidateResumePageData(t.feedback.id)]),W.R.trigger(T.P.FORM_SUBMITTED,{feedbackId:t.feedback.id,tab:"overview",offline:t.completedOffline}),yield t.fetchAccessData({cmId:t.cmId,readingStrategy:t.offline?1:2,siteId:t.currentSite.getId()})):"number"!=typeof n.jumpto||n.jumpto==t.currentPage||(yield T.p.invalidateResumePageData(t.feedback.id),W.R.trigger(T.P.FORM_SUBMITTED,{feedbackId:t.feedback.id,tab:"overview",offline:t.completedOffline}),yield t.fetchFeedbackPageData(n.jumpto))}catch(e){I.OQ.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{t.feedbackLoaded=!0}}))()}showAnalysis(){if(this.fromIndex)return W.R.trigger(T.P.FORM_SUBMITTED,{feedbackId:this.feedback.id,tab:"analysis",offline:this.completedOffline}),r.b.back(),void 0;r.b.navigateToSitePath(H.d.PAGE_NAME+`/${this.courseId}/${this.cmId}`,{params:{module:this.module,tab:"analysis"}})}continue(){var e=this;return(0,f.Z)((function*(){if(!e.siteAfterSubmit)return r.b.back();const t=yield I.OQ.showModalLoading();try{yield B.m9.visitLink(e.siteAfterSubmit,{siteId:e.currentSite.id})}finally{t.dismiss()}}))()}analyticsLogEvent(){if(!this.feedback)return;if(this.preview)return v.ke.logEvent({type:v.gM.VIEW_ITEM,ws:"mod_feedback_get_items",name:this.feedback.name,data:{id:this.feedback.id,category:"feedback"},url:`/mod/feedback/print.php?id=${this.cmId}&courseid=${this.courseId}`}),void 0;let e="/mod/feedback/complete.php";this.completed||(e+=`?id=${this.cmId}`+(this.currentPage?`&gopage=${this.currentPage}`:"")+`&courseid=${this.courseId}`),v.ke.logEvent({type:v.gM.VIEW_ITEM,ws:this.completed?"mod_feedback_get_feedback_access_information":"mod_feedback_get_page_items",name:this.feedback.name,data:{id:this.feedback.id,category:"feedback",page:this.currentPage},url:e})}ngOnDestroy(){this.onlineObserver.unsubscribe()}}return(e=AddonModFeedbackFormPage).ɵfac=function AddonModFeedbackFormPage_Factory(t){return new(t||e)},e.ɵcmp=_.Xpm({type:e,selectors:[["page-addon-mod-feedback-form"]],viewQuery:function AddonModFeedbackFormPage_Query(e,t){if(1&e&&_.Gf(g.W2,5),2&e){let e;_.iGM(e=_.CRH())&&(t.content=e.first)}},decls:15,vars:10,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"limited-width"],[1,"has-spacer",3,"hideUntil"],[4,"ngIf"],["class","core-success-card",4,"ngIf"],["collapsible-footer","","slot","fixed","appearOnBottom","",4,"ngIf"],["label",""],[1,"ion-no-margin","has-spacer"],[1,"ion-text-wrap"],[1,"item-heading"],[4,"ngFor","ngForOf"],["class","ion-align-items-center spacer-top",4,"ngIf"],[1,"ion-text-wrap","addon-mod_feedback-item",3,"color"],["labelPlacement","stacked","type","text","autocorrect","off",3,"ngModel","name","maxlength","required","ngModelChange",4,"ngIf"],["labelPlacement","stacked",3,"required","name","ngModel","ngModelChange",4,"ngIf"],["labelPlacement","stacked","interface","action-sheet",3,"required","name","ngModel","cancelText","interfaceOptions","ngModelChange",4,"ngIf"],[3,"ngModel","required","name","ngModelChange",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","wsNotFiltered","courseId"],["labelPlacement","stacked","type","text","autocorrect","off",3,"ngModel","name","maxlength","required","ngModelChange"],["labelPlacement","stacked","type","number",3,"ngModel","name","required","ngModelChange"],["color","danger","class","addon-mod_feedback-item-error",4,"ngIf"],["color","danger",1,"addon-mod_feedback-item-error"],["labelPlacement","stacked",3,"required","name","ngModel","ngModelChange"],["labelPlacement","stacked","interface","action-sheet",3,"required","name","ngModel","cancelText","interfaceOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngModel","required","name","ngModelChange"],["class","ion-text-wrap",4,"ngFor","ngForOf"],["value","option.value",3,"required","name","ngModel","ngModelChange"],["modelValueName","value",3,"publicKey","model",4,"ngIf"],["class","core-warning-card",4,"ngIf"],["modelValueName","value",3,"publicKey","model"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[1,"ion-align-items-center","spacer-top"],["expand","block","fill","outline",1,"ion-text-wrap",3,"click"],["name","fas-chevron-left","slot","start","aria-hidden","true"],["expand","block",1,"ion-text-wrap",3,"click"],["name","fas-chevron-right","slot","end","aria-hidden","true"],[1,"core-success-card"],["name","fas-check","slot","start","aria-hidden","true"],["componentId","componentId","contextLevel","module",3,"component","text","contextInstanceId","courseId",4,"ngIf"],["componentId","componentId","contextLevel","module",3,"component","text","contextInstanceId","courseId"],["collapsible-footer","","slot","fixed","appearOnBottom",""],[1,"list-item-limited-width","adaptable-buttons-row"],["expand","block","fill","outline","class","ion-text-wrap ion-margin",3,"click",4,"ngIf"],["expand","block",1,"ion-text-wrap","ion-margin",3,"click"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin",3,"click"],["name","fas-chart-bar","slot","start","aria-hidden","true"],[3,"core-mark-required","slot",4,"ngIf"],[3,"core-mark-required","slot"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","courseId","wsNotFiltered"],["class","addon-mod_feedback-postfix",4,"ngIf"],[1,"addon-mod_feedback-postfix"]],template:function AddonModFeedbackFormPage_Template(e,t){1&e&&(_.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_._UZ(3,"ion-back-button",1),_.ALo(4,"translate"),_.qZA(),_.TgZ(5,"ion-title")(6,"h1"),_._UZ(7,"core-format-text",2),_.qZA()()()(),_.TgZ(8,"ion-content",3)(9,"core-loading",4),_.YNc(10,AddonModFeedbackFormPage_ng_container_10_Template,11,7,"ng-container",5)(11,AddonModFeedbackFormPage_ion_card_11_Template,7,3,"ion-card",6)(12,AddonModFeedbackFormPage_div_12_Template,6,3,"div",7),_.qZA()(),_.YNc(13,AddonModFeedbackFormPage_ng_template_13_Template,1,1,"ng-template",null,8,_.W1O)),2&e&&(_.xp6(3),_.Q6J("text",_.lcZ(4,8,"core.back")),_.xp6(4),_.Q6J("text",t.title)("contextInstanceId",t.cmId)("courseId",t.courseId),_.xp6(2),_.Q6J("hideUntil",t.feedbackLoaded),_.xp6(),_.Q6J("ngIf",t.items&&t.items.length),_.xp6(),_.Q6J("ngIf",t.completed),_.xp6(),_.Q6J("ngIf",t.feedbackLoaded&&t.completed))},dependencies:[y.sg,y.O5,y.tP,q.r,L.O,X.u,S.w,z.I,s.r,ee.u,m.t,te.O,ne.JJ,ne.Q7,ne.nD,ne.On,g.YG,g.Sm,g.PM,g.nz,g.wI,g.W2,g.Gu,g.gu,g.pK,g.Ie,g.Q$,g.q_,g.B7,g.se,g.Nd,g.t9,g.n0,g.yW,g.g2,g.wd,g.sr,g.w,g.as,g.U5,g.QI,g.j9,g.oU,p.X$],styles:["[_nghost-%COMP%]   .addon-mod_feedback-item[_ngcontent-%COMP%]   ion-label.label-stacked[_ngcontent-%COMP%]{margin:11px 0 10px;transform:none}[_nghost-%COMP%]   .addon-mod_feedback-item-error[_ngcontent-%COMP%]{padding-top:5px;padding-bottom:8px}"]}),AddonModFeedbackFormPage})();var ae=n(84095);function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template(e,t){1&e&&(_.TgZ(0,"ion-badge",15),_._uU(1),_.ALo(2,"translate"),_.qZA()),2&e&&(_.xp6(),_.hij(" ",_.lcZ(2,1,"addon.mod_feedback.started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template(e,t){1&e&&(_.TgZ(0,"ion-badge",16),_._uU(1),_.ALo(2,"translate"),_.qZA()),2&e&&(_.xp6(),_.hij(" ",_.lcZ(2,1,"addon.mod_feedback.not_started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template(e,t){if(1&e&&(_.TgZ(0,"ion-item",10),_._UZ(1,"core-user-avatar",11),_.TgZ(2,"ion-label")(3,"p",12),_._uU(4),_.qZA(),_.TgZ(5,"p"),_.YNc(6,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template,3,3,"ion-badge",13)(7,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template,3,3,"ion-badge",14),_.qZA()()()),2&e){const e=t.$implicit;_.xp6(),_.Q6J("user",e),_.xp6(3),_.Oqu(e.fullname),_.xp6(2),_.Q6J("ngIf",e.started),_.xp6(),_.Q6J("ngIf",!e.started)}}function AddonModFeedbackNonRespondentsPage_ng_container_21_Template(e,t){if(1&e&&(_.ynx(0),_.YNc(1,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template,8,4,"ion-item",9),_.BQk()),2&e){const e=_.oxw();_.xp6(),_.Q6J("ngForOf",e.users)}}const nonrespondents_c0=e=>({$a:e});let ie=(()=>{var e;class AddonModFeedbackNonRespondentsPage{constructor(){this.page=0,this.users=[],this.total=0,this.canLoadMore=!1,this.loaded=!1,this.loadMoreError=!1,this.logView=Z.V.once((()=>{this.feedback&&v.ke.logEvent({type:v.gM.VIEW_ITEM_LIST,ws:"mod_feedback_get_non_respondents",name:this.feedback.name,data:{feedbackid:this.feedback.id,category:"feedback"},url:`/mod/feedback/show_nonrespondents.php?id=${this.cmId}&courseid=${this.courseId}`})}))}ngOnInit(){try{this.cmId=r.b.getRequiredRouteNumberParam("cmId"),this.courseId=r.b.getRequiredRouteNumberParam("courseId"),this.selectedGroup=r.b.getRouteNumberParam("group")||0}catch(e){return I.OQ.showErrorModal(e),r.b.back(),void 0}this.fetchData()}fetchData(e=!1){var t=this;return(0,f.Z)((function*(){t.page=0,t.total=0,t.users=[];try{t.feedback=yield T.p.getFeedback(t.courseId,t.cmId),t.groupInfo=yield M.t.getActivityGroupInfo(t.cmId),t.selectedGroup=M.t.validateGroupId(t.selectedGroup,t.groupInfo),yield t.loadGroupUsers(t.selectedGroup),t.logView()}catch(t){I.OQ.showErrorModalDefault(t,"core.course.errorgetmodule",!0),e||r.b.back()}}))()}loadGroupUsers(e){var t=this;return(0,f.Z)((function*(){t.loadMoreError=!1,void 0===e?t.page++:(t.selectedGroup=e,t.page=0,t.total=0,t.users=[],t.loaded=!1);try{const e=yield P.S.getNonRespondents(t.feedback.id,{groupId:t.selectedGroup,page:t.page,cmId:t.cmId});t.total=e.total,t.users.length<e.total&&(t.users=t.users.concat(e.users)),t.canLoadMore=t.users.length<e.total}catch(e){throw t.loadMoreError=!0,e}finally{t.loaded=!0}}))()}loadAttempts(e,t){var n=this;return(0,f.Z)((function*(){try{yield n.loadGroupUsers(e)}catch(e){I.OQ.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{t&&t()}}))()}refreshFeedback(e){var t=this;return(0,f.Z)((function*(){try{const e=[];e.push(M.t.invalidateActivityGroupInfo(t.cmId)),t.feedback&&e.push(T.p.invalidateNonRespondentsData(t.feedback.id)),yield x.Tr.ignoreErrors(Promise.all(e)),yield t.fetchData(!0)}finally{e.complete()}}))()}}return(e=AddonModFeedbackNonRespondentsPage).ɵfac=function AddonModFeedbackNonRespondentsPage_Factory(t){return new(t||e)},e.ɵcmp=_.Xpm({type:e,selectors:[["page-addon-mod-feedback-nonrespondents"]],decls:23,vars:23,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-no-margin"],[3,"groupInfo","selected","courseId","selectedChange"],[4,"ngIf"],[3,"enabled","error","action"],["class","ion-text-wrap",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["color","success",4,"ngIf"],["color","danger",4,"ngIf"],["color","success"],["color","danger"]],template:function AddonModFeedbackNonRespondentsPage_Template(e,t){1&e&&(_.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_._UZ(3,"ion-back-button",1),_.ALo(4,"translate"),_.qZA(),_.TgZ(5,"ion-title")(6,"h1"),_._uU(7),_.ALo(8,"translate"),_.qZA()()()(),_.TgZ(9,"ion-content")(10,"ion-refresher",2),_.NdJ("ionRefresh",(function AddonModFeedbackNonRespondentsPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshFeedback(e.target)})),_._UZ(11,"ion-refresher-content",3),_.ALo(12,"translate"),_.qZA(),_.TgZ(13,"core-loading",4)(14,"ion-list",5)(15,"core-group-selector",6),_.NdJ("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(e){return t.selectedGroup=e}))("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(){return t.loadAttempts(t.selectedGroup)})),_.qZA(),_.TgZ(16,"ion-item-divider")(17,"ion-label")(18,"h2"),_._uU(19),_.ALo(20,"translate"),_.qZA()()(),_.YNc(21,AddonModFeedbackNonRespondentsPage_ng_container_21_Template,2,1,"ng-container",7),_.TgZ(22,"core-infinite-loading",8),_.NdJ("action",(function AddonModFeedbackNonRespondentsPage_Template_core_infinite_loading_action_22_listener(e){return t.loadAttempts(void 0,e)})),_.qZA()()()()),2&e&&(_.xp6(3),_.Q6J("text",_.lcZ(4,12,"core.back")),_.xp6(4),_.Oqu(_.lcZ(8,14,"addon.mod_feedback.responses")),_.xp6(3),_.Q6J("disabled",!t.loaded),_.xp6(),_.s9C("pullingText",_.lcZ(12,16,"core.pulltorefresh")),_.xp6(2),_.Q6J("hideUntil",t.loaded),_.xp6(2),_.Q6J("groupInfo",t.groupInfo)("selected",t.selectedGroup)("courseId",t.courseId),_.xp6(4),_.Oqu(_.xi3(20,18,"addon.mod_feedback.non_respondents_students",_.VKq(21,nonrespondents_c0,t.total))),_.xp6(2),_.Q6J("ngIf",t.total>0),_.xp6(),_.Q6J("enabled",t.canLoadMore)("error",t.loadMoreError))},dependencies:[y.sg,y.O5,w.Q,Q.n,q.r,J.X,m.t,g.yp,g.Sm,g.W2,g.Gu,g.Ie,g.rH,g.Q$,g.q_,g.nJ,g.Wo,g.wd,g.sr,g.oU,p.X$],encapsulation:2}),AddonModFeedbackNonRespondentsPage})();const de=[{path:":courseId/:cmId",component:u},{path:":courseId/:cmId/form",component:oe,canDeactivate:[ae.Y]},{path:":courseId/:cmId/nonrespondents",component:ie}],re=[...de,{path:":courseId/:cmId/attempts",component:O},{path:":courseId/:cmId/attempts/:attemptId",component:D}],ce=[...de,{path:":courseId/:cmId/attempts",component:O,children:[{path:":attemptId",component:D}]}],_e=[...(0,C.Vr)(re,(()=>R.X4.isMobile)),...(0,C.Vr)(ce,(()=>R.X4.isTablet))];let se=(()=>{var e;class AddonModFeedbackLazyModule{}return(e=AddonModFeedbackLazyModule).ɵfac=function AddonModFeedbackLazyModule_Factory(t){return new(t||e)},e.ɵmod=_.oAB({type:e}),e.ɵinj=_.cJS({imports:[o.Bz.forChild(_e),a.L,i._]}),AddonModFeedbackLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&_.kYT(se,{declarations:[O,oe,u,ie,D],imports:[o.Bz,a.L,i._]}))},71460:(e,t,n)=>{n.d(t,{t:()=>CoreSwipeNavigationItemsManager});var o=n(49671),a=n(67643),i=n(43555),d=n(22594);class CoreSwipeNavigationItemsManager extends d.A{start(){var e=this;return(0,o.Z)((function*(){e.updateSelectedItem()}))()}navigateToNextItem(){var e=this;return(0,o.Z)((function*(){yield e.navigateToItemBy(1,"forward")}))()}navigateToPreviousItem(){var e=this;return(0,o.Z)((function*(){yield e.navigateToItemBy(-1,"back")}))()}hasNextItem(){var e=this;return(0,o.Z)((function*(){return!!(yield e.getItemBy(1))}))()}hasPreviousItem(){var e=this;return(0,o.Z)((function*(){return!!(yield e.getItemBy(-1))}))()}getCurrentPageRoute(){return i.b.getCurrentRoute()}getSelectedItemPathFromRoute(e){const t=[];for(;e;){if(t.push(...(e instanceof a.De?e:e.snapshot).url),!e.firstChild)break;e=e.firstChild}return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,t){var n=this;return(0,o.Z)((function*(){const o=yield n.getItemBy(e);o&&(yield n.navigateToItem(o,{animationDirection:t,replace:!0}))}))()}getItemBy(e){var t=this;return(0,o.Z)((function*(){var n;const o=t.getSource().getItems(),a=null!==(n=t.selectedItem&&(null==o?void 0:o.indexOf(t.selectedItem)))&&void 0!==n?n:-1;if(-1===a||null===o)return null;const i=e>0?1:-1;let d=a,r=0;for(;r!==e;){if(d+=i,d<0)return null;if(d>=o.length)break;t.skipItemInSwipe(o[d])||(r+=i)}return r===e?o[d]:t.getSource().isCompleted()?null:(yield t.getSource().load(),t.getItemBy(e))}))()}skipItemInSwipe(e){return!1}}}}]);