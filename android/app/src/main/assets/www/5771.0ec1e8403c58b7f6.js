"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5771],{15771:(e,r,o)=>{o.r(r),o.d(r,{CoreSearchLazyModule:()=>J});var a=o(13386),t=o(19212),l=o(67643),c=o(49671),s=o(13010),n=o(59614),i=o(53564),u=o(75803),h=o(43468),_=o(10727),d=o(857),g=o(98370),p=o(24442),S=o(43555),b=o(93268),m=o(96814),f=o(55126),Z=o(52133),y=o(73946),C=o(86700),x=o(8947),T=o(29657),v=o(31903),G=o(22116),P=o(83431),A=o(89515);function CoreSearchGlobalSearchPage_h1_6_Template(e,r){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(),t.Oqu(t.lcZ(2,1,"core.search")))}function CoreSearchGlobalSearchPage_h1_7_Template(e,r){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(),t.Oqu(t.lcZ(2,1,"core.search.globalsearch")))}function CoreSearchGlobalSearchPage_ion_card_12_Template(e,r){if(1&e&&(t.TgZ(0,"ion-card",12)(1,"ion-item"),t._UZ(2,"ion-icon",13),t.TgZ(3,"ion-label"),t._UZ(4,"core-format-text",1),t.qZA()()()),2&e){const e=t.oxw();t.xp6(4),t.Q6J("text",e.searchBanner)}}function CoreSearchGlobalSearchPage_ion_list_16_core_search_global_search_result_1_Template(e,r){if(1&e){const e=t.EpF();t.TgZ(0,"core-search-global-search-result",15),t.NdJ("onClick",(function CoreSearchGlobalSearchPage_ion_list_16_core_search_global_search_result_1_Template_core_search_global_search_result_onClick_0_listener(){const r=t.CHM(e).$implicit,o=t.oxw(2);return t.KtG(o.visitResult(r))})),t.qZA()}if(2&e){t.Q6J("result",r.$implicit)}}function CoreSearchGlobalSearchPage_ion_list_16_Template(e,r){if(1&e&&(t.TgZ(0,"ion-list"),t.YNc(1,CoreSearchGlobalSearchPage_ion_list_16_core_search_global_search_result_1_Template,1,1,"core-search-global-search-result",14),t.qZA()),2&e){const e=t.oxw();t.xp6(),t.Q6J("ngForOf",e.resultsSource.getItems())}}function CoreSearchGlobalSearchPage_core_empty_box_18_p_1_Template(e,r){1&e&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(),t.Oqu(t.lcZ(2,1,"core.search.empty")))}const _c0=e=>({$a:e});function CoreSearchGlobalSearchPage_core_empty_box_18_ng_container_2_Template(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"p")(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"p")(6,"small"),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.BQk()),2&e){const e=t.oxw(2);t.xp6(3),t.Oqu(t.xi3(4,2,"core.search.noresults",t.VKq(7,_c0,e.resultsSource.getQuery()))),t.xp6(4),t.Oqu(t.lcZ(8,5,"core.search.noresultshelp"))}}function CoreSearchGlobalSearchPage_core_empty_box_18_Template(e,r){if(1&e&&(t.TgZ(0,"core-empty-box",16),t.YNc(1,CoreSearchGlobalSearchPage_core_empty_box_18_p_1_Template,3,3,"p",2)(2,CoreSearchGlobalSearchPage_core_empty_box_18_ng_container_2_Template,9,9,"ng-container",2),t.qZA()),2&e){const e=t.oxw();t.Q6J("dimmed",!e.resultsSource.isLoaded()),t.xp6(),t.Q6J("ngIf",!e.resultsSource.isLoaded()),t.xp6(),t.Q6J("ngIf",e.resultsSource.isLoaded())}}let Q=(()=>{var e;class CoreSearchGlobalSearchPage{constructor(){this.courseId=null,this.loadMoreError=null,this.searchBanner=null,this.resultsSource=new n.Y("",{})}ngOnInit(){var e,r,o;const a=i.m9.getRequiredCurrentSite(),t=null!==(e=null===(r=a.config)||void 0===r||null===(r=r.searchbanner)||void 0===r?void 0:r.trim())&&void 0!==e?e:"",l=S.b.getRouteNumberParam("courseId");u.Tr.isTrueOrOne(null===(o=a.config)||void 0===o?void 0:o.searchbannerenable)&&t.length>0&&(this.searchBanner=t),l&&(this.courseId=l,this.resultsSource.setFilters({courseIds:[l]})),this.filtersObserver=g.R.on(p.R6,(e=>this.resultsSource.setFilters(e)))}ngAfterViewInit(){const e=S.b.getRouteParam("query");e&&(this.searchBox&&(this.searchBox.searchText=e),this.search(e))}ngOnDestroy(){var e;null===(e=this.filtersObserver)||void 0===e||e.off()}search(e){var r=this;return(0,c.Z)((function*(){r.resultsSource.setQuery(e),r.resultsSource.hasEmptyQuery()||(yield s.OQ.showOperationModals("core.searching",!0,(0,c.Z)((function*(){yield r.resultsSource.reload(),yield u.Tr.ignoreErrors(p.HA.logViewResults(r.resultsSource.getQuery(),r.resultsSource.getFilters())),h.ke.logEvent({type:h.gM.VIEW_ITEM_LIST,ws:"core_search_view_results",name:_.vN.instant("core.search.globalsearch"),data:{query:e,filters:JSON.stringify(r.resultsSource.getFilters())},url:d.T.addParamsToUrl("/search/index.php",{q:e})})}))))}))()}clearSearch(){this.loadMoreError=null,this.resultsSource.setQuery(""),this.resultsSource.reset()}openFilters(){var e=this;return(0,c.Z)((function*(){const{CoreSearchGlobalSearchFiltersComponent:r}=yield o.e(1026).then(o.bind(o,11026));yield s.OQ.openSideModal({component:r,componentProps:{hideCourses:!!e.courseId,filters:e.resultsSource.getFilters()}}),!e.resultsSource.hasEmptyQuery()&&e.resultsSource.isDirty()&&(yield s.OQ.showOperationModals("core.searching",!0,(()=>e.resultsSource.reload())))}))()}visitResult(e){return(0,c.Z)((function*(){yield i.m9.visitLink(e.url)}))()}loadMoreResults(e){var r=this;return(0,c.Z)((function*(){try{var o;yield null===(o=r.resultsSource)||void 0===o?void 0:o.load()}catch(e){r.loadMoreError=s.OQ.getErrorMessage(e)}finally{e()}}))()}}return(e=CoreSearchGlobalSearchPage).ɵfac=function CoreSearchGlobalSearchPage_Factory(r){return new(r||e)},e.ɵcmp=t.Xpm({type:e,selectors:[["page-core-search-global-search"]],viewQuery:function CoreSearchGlobalSearchPage_Query(e,r){if(1&e&&t.Gf(b.L,5),2&e){let e;t.iGM(e=t.CRH())&&(r.searchBox=e.first)}},decls:23,vars:20,consts:[["slot","start"],[3,"text"],[4,"ngIf"],["slot","end"],[1,"limited-width"],["class","core-danger-card",4,"ngIf"],["searchArea","CoreSearchGlobalSearch",3,"placeholder","searchLabel","autoFocus","onSubmit","onClear"],[3,"enabled","error","action"],["icon","fas-magnifying-glass",3,"dimmed",4,"ngIf"],["slot","fixed","core-fab","","vertical","bottom","horizontal","end"],[3,"click"],["name","fas-filter","aria-hidden","true"],[1,"core-danger-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"result","onClick",4,"ngFor","ngForOf"],[3,"result","onClick"],["icon","fas-magnifying-glass",3,"dimmed"]],template:function CoreSearchGlobalSearchPage_Template(e,r){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ion-title"),t.YNc(6,CoreSearchGlobalSearchPage_h1_6_Template,3,3,"h1",2)(7,CoreSearchGlobalSearchPage_h1_7_Template,3,3,"h1",2),t.qZA(),t.TgZ(8,"ion-buttons",3),t._UZ(9,"core-user-menu-button"),t.qZA()()(),t.TgZ(10,"ion-content",4)(11,"div"),t.YNc(12,CoreSearchGlobalSearchPage_ion_card_12_Template,5,1,"ion-card",5),t.TgZ(13,"core-search-box",6),t.NdJ("onSubmit",(function CoreSearchGlobalSearchPage_Template_core_search_box_onSubmit_13_listener(e){return r.search(e)}))("onClear",(function CoreSearchGlobalSearchPage_Template_core_search_box_onClear_13_listener(){return r.clearSearch()})),t.ALo(14,"translate"),t.ALo(15,"translate"),t.qZA(),t.YNc(16,CoreSearchGlobalSearchPage_ion_list_16_Template,2,1,"ion-list",2),t.TgZ(17,"core-infinite-loading",7),t.NdJ("action",(function CoreSearchGlobalSearchPage_Template_core_infinite_loading_action_17_listener(e){return r.loadMoreResults(e)})),t.qZA(),t.YNc(18,CoreSearchGlobalSearchPage_core_empty_box_18_Template,3,3,"core-empty-box",8),t.TgZ(19,"ion-fab",9)(20,"ion-fab-button",10),t.NdJ("click",(function CoreSearchGlobalSearchPage_Template_ion_fab_button_click_20_listener(){return r.openFilters()})),t.ALo(21,"translate"),t._UZ(22,"ion-icon",11),t.qZA()()()()),2&e&&(t.xp6(3),t.Q6J("text",t.lcZ(4,12,"core.back")),t.xp6(3),t.Q6J("ngIf",r.courseId),t.xp6(),t.Q6J("ngIf",!r.courseId),t.xp6(5),t.Q6J("ngIf",r.searchBanner),t.xp6(),t.Q6J("placeholder",t.lcZ(14,14,"core.search"))("searchLabel",t.lcZ(15,16,"core.search"))("autoFocus",!0),t.xp6(3),t.Q6J("ngIf",r.resultsSource.isLoaded()),t.xp6(),t.Q6J("enabled",r.resultsSource.isLoaded()&&!r.resultsSource.isCompleted())("error",r.loadMoreError),t.xp6(),t.Q6J("ngIf",r.resultsSource.isEmpty()),t.xp6(2),t.uIk("aria-label",t.lcZ(21,18,"core.filter")))},dependencies:[m.sg,m.O5,f.z,Z.n,y.U,C.I,x.r,T.t,v.Sm,v.PM,v.W2,v.IJ,v.W4,v.Gu,v.gu,v.Ie,v.Q$,v.q_,v.wd,v.sr,v.oU,b.L,G.M,P.o,A.X$],encapsulation:2}),CoreSearchGlobalSearchPage})();var I=o(74744),L=o(56283),q=o(39716);function buildRoutes(e){return(0,q.o)(e,{component:Q})}let J=(()=>{var e;class CoreSearchLazyModule{}return(e=CoreSearchLazyModule).ɵfac=function CoreSearchLazyModule_Factory(r){return new(r||e)},e.ɵmod=t.oAB({type:e}),e.ɵinj=t.cJS({providers:[{provide:l.Z6,multi:!0,deps:[t.zs3],useFactory:buildRoutes}],imports:[a.L,I.w,L.g,l.Bz]}),CoreSearchLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&t.kYT(J,{declarations:[Q],imports:[a.L,I.w,L.g],exports:[l.Bz]}))}}]);