"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4392],{82167:(e,t,n)=>{n.d(t,{f:()=>AddonCompetencyCourseCompetenciesSource});var o=n(49671),c=n(54129),i=n(75803),r=n(71178),a=n(30855);class AddonCompetencyCourseCompetenciesSource extends c.H{static getSourceId(e,t){return`${e}-${t||"current-user"}`}constructor(e,t){super(),this.COURSE_ID=e,this.USER_ID=t}getItemPath(e){return String(e.competency.id)}load(){var _superprop_getLoad=()=>super.load,e=this;return(0,o.Z)((function*(){!e.dirty&&e.courseCompetencies||(yield e.loadCourseCompetencies()),yield _superprop_getLoad().call(e)}))()}invalidateCache(){var e=this;return(0,o.Z)((function*(){yield i.Tr.ignoreErrors(r.M.invalidateCourseCompetencies(e.COURSE_ID,e.USER_ID))}))()}loadPageItems(){var e=this;return(0,o.Z)((function*(){if(!e.courseCompetencies)throw new Error("Can't load competencies without course data");return{items:e.courseCompetencies.competencies}}))()}loadCourseCompetencies(){var e=this;return(0,o.Z)((function*(){[e.courseCompetencies,e.user]=yield Promise.all([r.M.getCourseCompetencies(e.COURSE_ID,e.USER_ID),a.Y.getProfile(e.USER_ID)])}))()}}},53654:(e,t,n)=>{n.d(t,{R:()=>AddonCompetencyPlanCompetenciesSource});var o=n(49671),c=n(54129),i=n(75803),r=n(71178),a=n(30855);class AddonCompetencyPlanCompetenciesSource extends c.H{constructor(e){super(),this.PLAN_ID=e}getItemPath(e){return String(e.competency.id)}load(){var _superprop_getLoad=()=>super.load,e=this;return(0,o.Z)((function*(){!e.dirty&&e.plan||(yield e.loadLearningPlan()),yield _superprop_getLoad().call(e)}))()}invalidateCache(){var e=this;return(0,o.Z)((function*(){yield i.Tr.ignoreErrors(r.M.invalidateLearningPlan(e.PLAN_ID))}))()}loadPageItems(){var e=this;return(0,o.Z)((function*(){if(!e.plan)throw new Error("Can't load competencies without plan!");return{items:e.plan.competencies}}))()}loadLearningPlan(){var e=this;return(0,o.Z)((function*(){e.plan=yield r.M.getLearningPlan(e.PLAN_ID),e.plan.plan.statusname=a.Y.getPlanStatusName(e.plan.plan.status),e.user=yield a.Y.getProfile(e.plan.plan.userid)}))()}}},42512:(e,t,n)=>{n.d(t,{Q:()=>r});var o=n(13386),c=n(8103),i=n(19212);let r=(()=>{var e;class AddonCompetencyCompetenciesPageModule{}return(e=AddonCompetencyCompetenciesPageModule).ɵfac=function AddonCompetencyCompetenciesPageModule_Factory(t){return new(t||e)},e.ɵmod=i.oAB({type:e}),e.ɵinj=i.cJS({imports:[o.L]}),AddonCompetencyCompetenciesPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&i.kYT(r,{declarations:[c.b],imports:[o.L]}))},8103:(e,t,n)=>{n.d(t,{b:()=>Z});var o=n(49671),c=n(13010),i=n(30242),r=n(10727),a=n(43555),p=n(31381),m=n(53654),d=n(82167),s=n(1389),_=n(25233),l=n(43468),u=n(53564),y=n(88817),g=n(19212),C=n(96814),f=n(66931),x=n(8947),I=n(29657),h=n(31903),A=n(89515);function AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_6_Template(e,t){if(1&e&&(g.TgZ(0,"ion-badge",10),g._uU(1),g.qZA()),2&e){const e=g.oxw().$implicit;g.Q6J("color",e.usercompetency.proficiency?"success":"danger"),g.xp6(),g.hij(" ",e.usercompetency.gradename," ")}}function AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_7_Template(e,t){if(1&e&&(g.TgZ(0,"ion-badge",10),g._uU(1),g.qZA()),2&e){const e=g.oxw().$implicit;g.Q6J("color",e.usercompetencycourse.proficiency?"success":"danger"),g.xp6(),g.hij(" ",e.usercompetencycourse.gradename," ")}}function AddonCompetencyCompetenciesPage_ion_item_15_Template(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"ion-item",7),g.NdJ("click",(function AddonCompetencyCompetenciesPage_ion_item_15_Template_ion_item_click_0_listener(){const t=g.CHM(e).$implicit,n=g.oxw();return g.KtG(n.competencies.select(t))})),g.TgZ(1,"ion-label")(2,"p",8),g._UZ(3,"core-format-text",2),g.TgZ(4,"em"),g._uU(5),g.qZA()()(),g.YNc(6,AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_6_Template,2,2,"ion-badge",9)(7,AddonCompetencyCompetenciesPage_ion_item_15_ion_badge_7_Template,2,2,"ion-badge",9),g.qZA()}if(2&e){const e=t.$implicit,n=g.oxw();g.Q6J("detail",!0),g.uIk("aria-label",e.competency.shortname)("aria-current",n.competencies.getItemAriaCurrent(e)),g.xp6(3),g.Q6J("text",e.competency.shortname)("contextLevel",n.contextLevel)("contextInstanceId",n.contextInstanceId),g.xp6(2),g.Oqu(e.competency.idnumber),g.xp6(),g.Q6J("ngIf",e.usercompetency),g.xp6(),g.Q6J("ngIf",e.usercompetencycourse)}}let Z=(()=>{var e;class AddonCompetencyCompetenciesPage{constructor(){this.title="";const e=a.b.getRouteNumberParam("planId");if(this.logView=y.V.once((()=>this.performLogView())),!e){const e=a.b.getRequiredRouteNumberParam("courseId"),t=a.b.getRouteNumberParam("userId"),n=_.p.getOrCreateSource(d.f,[e,t]);return this.competencies=new s.a(n,AddonCompetencyCompetenciesPage),void 0}const t=_.p.getOrCreateSource(m.R,[e]);this.competencies=new s.a(t,AddonCompetencyCompetenciesPage)}ngAfterViewInit(){var e=this;return(0,o.Z)((function*(){yield e.fetchCompetencies(),e.competencies.start(e.splitView)}))()}fetchCompetencies(){var e=this;return(0,o.Z)((function*(){try{const n=e.competencies.getSource();if(yield e.competencies.load(),n instanceof m.R){var t;if(!n.plan||n.plan&&n.plan.competencycount<=0)throw new p.G(r.vN.instant("addon.competency.errornocompetenciesfound"));e.title=n.plan.plan.name,e.contextLevel="user",e.contextInstanceId=(null===(t=n.user)||void 0===t?void 0:t.id)||n.plan.plan.userid}else e.title=r.vN.instant("addon.competency.coursecompetencies"),e.contextLevel="course",e.contextInstanceId=n.COURSE_ID;e.logView()}catch(e){c.OQ.showErrorModalDefault(e,"Error getting competencies data.")}}))()}refreshCompetencies(e){var t=this;return(0,o.Z)((function*(){yield t.competencies.getSource().invalidateCache(),t.competencies.getSource().setDirty(!0),t.fetchCompetencies().finally((()=>{null==e||e.complete()}))}))()}ngOnDestroy(){this.competencies.destroy()}performLogView(){const e=this.competencies.getSource();if(e instanceof m.R)return l.ke.logEvent({type:l.gM.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plan_page",name:this.title,data:{category:"competency",planid:e.PLAN_ID},url:`/admin/tool/lp/plan.php?id=${e.PLAN_ID}`}),void 0;e.USER_ID&&e.USER_ID!==u.m9.getCurrentSiteUserId()||l.ke.logEvent({type:l.gM.VIEW_ITEM_LIST,ws:"tool_lp_data_for_course_competencies_page",name:this.title,data:{category:"competency",courseid:e.COURSE_ID},url:`/admin/tool/lp/coursecompetencies.php?courseid=${e.COURSE_ID}`})}}return(e=AddonCompetencyCompetenciesPage).ɵfac=function AddonCompetencyCompetenciesPage_Factory(t){return new(t||e)},e.ɵcmp=g.Xpm({type:e,selectors:[["page-addon-competency-competencies"]],viewQuery:function AddonCompetencyCompetenciesPage_Query(e,t){if(1&e&&g.Gf(i.A,5),2&e){let e;g.iGM(e=g.CRH())&&(t.splitView=e.first)}},decls:16,vars:12,consts:[["slot","start"],[3,"text"],[3,"text","contextLevel","contextInstanceId"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"detail","click"],[1,"item-heading"],["slot","end",3,"color",4,"ngIf"],["slot","end",3,"color"]],template:function AddonCompetencyCompetenciesPage_Template(e,t){1&e&&(g.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),g._UZ(3,"ion-back-button",1),g.ALo(4,"translate"),g.qZA(),g.TgZ(5,"ion-title")(6,"h1"),g._UZ(7,"core-format-text",2),g.qZA()()()(),g.TgZ(8,"ion-content")(9,"core-split-view")(10,"ion-refresher",3),g.NdJ("ionRefresh",(function AddonCompetencyCompetenciesPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshCompetencies(e.target)})),g._UZ(11,"ion-refresher-content",4),g.ALo(12,"translate"),g.qZA(),g.TgZ(13,"core-loading",5)(14,"ion-list"),g.YNc(15,AddonCompetencyCompetenciesPage_ion_item_15_Template,8,9,"ion-item",6),g.qZA()()()()),2&e&&(g.xp6(3),g.Q6J("text",g.lcZ(4,8,"core.back")),g.xp6(4),g.Q6J("text",t.title)("contextLevel",t.contextLevel)("contextInstanceId",t.contextInstanceId),g.xp6(3),g.Q6J("disabled",!t.competencies.loaded),g.xp6(),g.s9C("pullingText",g.lcZ(12,10,"core.pulltorefresh")),g.xp6(2),g.Q6J("hideUntil",t.competencies.loaded),g.xp6(2),g.Q6J("ngForOf",t.competencies.items))},dependencies:[C.sg,C.O5,f.r,i.A,x.r,I.t,h.yp,h.Sm,h.W2,h.Gu,h.Ie,h.Q$,h.q_,h.nJ,h.Wo,h.wd,h.sr,h.oU,A.X$],encapsulation:2}),AddonCompetencyCompetenciesPage})()},52733:(e,t,n)=>{n.d(t,{K:()=>r});var o=n(13386),c=n(44854),i=n(19212);let r=(()=>{var e;class AddonCompetencyCompetencyPageModule{}return(e=AddonCompetencyCompetencyPageModule).ɵfac=function AddonCompetencyCompetencyPageModule_Factory(t){return new(t||e)},e.ɵmod=i.oAB({type:e}),e.ɵinj=i.cJS({imports:[o.L]}),AddonCompetencyCompetencyPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&i.kYT(r,{declarations:[c.k],imports:[o.L]}))},44854:(e,t,n)=>{n.d(t,{k:()=>J});var o=n(49671),c=n(30855),i=n(53564),r=n(13010),a=n(10727),p=n(71178),m=n(43555),d=n(75803),s=n(96092),_=n(71460),l=n(25233),u=n(53654),y=n(67643),g=n(82167),C=n(88817),f=n(43468),x=n(857),I=n(19212),h=n(96814),A=n(66931),Z=n(52028),v=n(80070),T=n(8947),P=n(21525),w=n(97037),b=n(5065),S=n(29657),L=n(31903),U=n(83369),q=n(89515);function AddonCompetencyCompetencyPage_h1_6_Template(e,t){if(1&e&&(I.TgZ(0,"h1"),I._UZ(1,"core-format-text",7),I.TgZ(2,"small"),I._uU(3),I.qZA()()),2&e){const e=I.oxw();I.xp6(),I.Q6J("text",e.competency.competency.competency.shortname)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId),I.xp6(2),I.Oqu(e.competency.competency.competency.idnumber)}}function AddonCompetencyCompetencyPage_ion_card_12_Template(e,t){if(1&e&&(I.TgZ(0,"ion-card")(1,"ion-item",8),I._UZ(2,"core-user-avatar",9),I.TgZ(3,"ion-label")(4,"p",10),I._uU(5),I.qZA()()()()),2&e){const e=I.oxw();I.xp6(2),I.Q6J("user",e.user),I.xp6(3),I.Oqu(e.user.fullname)}}function AddonCompetencyCompetencyPage_ion_card_13_ion_item_1_Template(e,t){if(1&e&&(I.TgZ(0,"ion-item",8)(1,"ion-label"),I._UZ(2,"core-format-text",7),I.qZA()()),2&e){const e=I.oxw(2);I.xp6(2),I.Q6J("text",e.competency.competency.competency.description)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId)}}function AddonCompetencyCompetencyPage_ion_card_13_a_8_Template(e,t){if(1&e&&(I.TgZ(0,"a",15),I._UZ(1,"core-format-text",7),I.qZA()),2&e){const e=I.oxw(2);I.Q6J("href",e.competencyFrameworkUrl,I.LSH),I.xp6(),I.Q6J("text",e.competency.competency.comppath.framework.name)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId)}}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_9_Template(e,t){if(1&e&&(I.ynx(0),I._UZ(1,"core-format-text",7),I.BQk()),2&e){const e=I.oxw(2);I.xp6(),I.Q6J("text",e.competency.competency.comppath.framework.name)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId)}}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_button_1_Template(e,t){if(1&e){const e=I.EpF();I.TgZ(0,"button",17),I.NdJ("click",(function AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_button_1_Template_button_click_0_listener(){I.CHM(e);const t=I.oxw().$implicit,n=I.oxw(2);return I.KtG(n.openCompetencySummary(t.id))})),I._UZ(1,"core-format-text",7),I.qZA()}if(2&e){const e=I.oxw().$implicit,t=I.oxw(2);I.xp6(),I.Q6J("text",e.name)("contextLevel",t.contextLevel)("contextInstanceId",t.contextInstanceId)}}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_ng_container_2_Template(e,t){if(1&e&&(I.ynx(0),I._UZ(1,"core-format-text",7),I.BQk()),2&e){const e=I.oxw().$implicit,t=I.oxw(2);I.xp6(),I.Q6J("text",e.name)("contextLevel",t.contextLevel)("contextInstanceId",t.contextInstanceId)}}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_ng_container_3_Template(e,t){1&e&&(I.ynx(0),I._uU(1," / "),I.BQk())}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_Template(e,t){if(1&e&&(I.ynx(0),I.YNc(1,AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_button_1_Template,2,3,"button",16)(2,AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_ng_container_2_Template,2,3,"ng-container",2)(3,AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_ng_container_3_Template,2,0,"ng-container",2),I.BQk()),2&e){const e=t.$implicit,n=I.oxw(2);I.xp6(),I.Q6J("ngIf",n.competency.competency.comppath.showlinks),I.xp6(),I.Q6J("ngIf",!n.competency.competency.comppath.showlinks),I.xp6(),I.Q6J("ngIf",!e.last)}}function AddonCompetencyCompetencyPage_ion_card_13_p_17_Template(e,t){1&e&&(I.TgZ(0,"p"),I._uU(1),I.ALo(2,"translate"),I.qZA()),2&e&&(I.xp6(),I.hij(" ",I.lcZ(2,1,"addon.competency.nocrossreferencedcompetencies")," "))}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_18_p_1_Template(e,t){if(1&e){const e=I.EpF();I.TgZ(0,"p")(1,"button",17),I.NdJ("click",(function AddonCompetencyCompetencyPage_ion_card_13_ng_container_18_p_1_Template_button_click_1_listener(){const t=I.CHM(e).$implicit,n=I.oxw(3);return I.KtG(n.openCompetencySummary(t.id))})),I._UZ(2,"core-format-text",7),I._uU(3),I.qZA()()}if(2&e){const e=t.$implicit,n=I.oxw(3);I.xp6(2),I.Q6J("text",e.shortname)("contextLevel",n.contextLevel)("contextInstanceId",n.contextInstanceId),I.xp6(),I.hij(" - ",e.idnumber," ")}}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_18_Template(e,t){if(1&e&&(I.ynx(0),I.YNc(1,AddonCompetencyCompetencyPage_ion_card_13_ng_container_18_p_1_Template,4,4,"p",14),I.BQk()),2&e){const e=I.oxw(2);I.xp6(),I.Q6J("ngForOf",e.competency.competency.relatedcompetencies)}}function AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_p_5_Template(e,t){1&e&&(I.TgZ(0,"p"),I._uU(1),I.ALo(2,"translate"),I.qZA()),2&e&&(I.xp6(),I.hij(" ",I.lcZ(2,1,"addon.competency.noactivities")," "))}function AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_ion_item_6_core_mod_icon_1_Template(e,t){if(1&e&&I._UZ(0,"core-mod-icon",22),2&e){const e=I.oxw().$implicit;I.Q6J("modicon",e.iconurl)("showAlt",!1)}}function AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_ion_item_6_Template(e,t){if(1&e&&(I.TgZ(0,"ion-item",19),I.YNc(1,AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_ion_item_6_core_mod_icon_1_Template,1,2,"core-mod-icon",20),I.TgZ(2,"ion-label"),I._UZ(3,"core-format-text",21),I.qZA()()),2&e){const e=t.$implicit,n=I.oxw(3);I.Q6J("href",e.url),I.uIk("aria-label",e.name),I.xp6(),I.Q6J("ngIf",e.iconurl),I.xp6(2),I.Q6J("text",e.name)("contextInstanceId",e.id)("courseId",n.courseId)}}function AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_Template(e,t){if(1&e&&(I.TgZ(0,"ion-item",8)(1,"ion-label")(2,"p",10),I._uU(3),I.ALo(4,"translate"),I.qZA(),I.YNc(5,AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_p_5_Template,3,3,"p",2)(6,AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_ion_item_6_Template,4,6,"ion-item",18),I.qZA()()),2&e){const e=I.oxw(2);I.xp6(3),I.Oqu(I.lcZ(4,3,"addon.competency.activities")),I.xp6(2),I.Q6J("ngIf",0===e.coursemodules.length),I.xp6(),I.Q6J("ngForOf",e.coursemodules)}}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_ion_item_1_Template(e,t){if(1&e&&(I.TgZ(0,"ion-item",8)(1,"ion-label")(2,"p",10),I._uU(3),I.ALo(4,"translate"),I.qZA(),I.TgZ(5,"p"),I._uU(6),I.qZA()()()),2&e){const e=I.oxw(3);I.xp6(3),I.Oqu(I.lcZ(4,2,"addon.competency.reviewstatus")),I.xp6(3),I.Oqu(e.competency.usercompetency.statusname)}}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_ion_badge_7_Template(e,t){1&e&&(I.TgZ(0,"ion-badge",26),I._uU(1),I.ALo(2,"translate"),I.qZA()),2&e&&(I.xp6(),I.hij(" ",I.lcZ(2,1,"core.yes")," "))}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_ion_badge_8_Template(e,t){1&e&&(I.TgZ(0,"ion-badge",27),I._uU(1),I.ALo(2,"translate"),I.qZA()),2&e&&(I.xp6(),I.hij(" ",I.lcZ(2,1,"core.no")," "))}function AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_Template(e,t){if(1&e&&(I.ynx(0),I.YNc(1,AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_ion_item_1_Template,7,4,"ion-item",11),I.TgZ(2,"ion-item",8)(3,"ion-label")(4,"p",10),I._uU(5),I.ALo(6,"translate"),I.qZA()(),I.YNc(7,AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_ion_badge_7_Template,3,3,"ion-badge",23)(8,AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_ion_badge_8_Template,3,3,"ion-badge",24),I.qZA(),I.TgZ(9,"ion-item",8)(10,"ion-label")(11,"p",10),I._uU(12),I.ALo(13,"translate"),I.qZA()(),I.TgZ(14,"ion-badge",25),I._uU(15),I.qZA()(),I.BQk()),2&e){const e=I.oxw(2);I.xp6(),I.Q6J("ngIf",e.competency.usercompetency&&e.competency.usercompetency.status),I.xp6(4),I.Oqu(I.lcZ(6,6,"addon.competency.proficient")),I.xp6(2),I.Q6J("ngIf",e.userCompetency.proficiency),I.xp6(),I.Q6J("ngIf",!e.userCompetency.proficiency),I.xp6(4),I.Oqu(I.lcZ(13,8,"addon.competency.rating")),I.xp6(3),I.Oqu(e.userCompetency.gradename)}}function AddonCompetencyCompetencyPage_ion_card_13_Template(e,t){if(1&e&&(I.TgZ(0,"ion-card"),I.YNc(1,AddonCompetencyCompetencyPage_ion_card_13_ion_item_1_Template,3,3,"ion-item",11),I.TgZ(2,"ion-item",12)(3,"ion-label")(4,"p",10),I._uU(5),I.ALo(6,"translate"),I.qZA(),I.TgZ(7,"p"),I.YNc(8,AddonCompetencyCompetencyPage_ion_card_13_a_8_Template,2,4,"a",13)(9,AddonCompetencyCompetencyPage_ion_card_13_ng_container_9_Template,2,3,"ng-container",2),I._uU(10,"  /  "),I.YNc(11,AddonCompetencyCompetencyPage_ion_card_13_ng_container_11_Template,4,3,"ng-container",14),I.qZA()()(),I.TgZ(12,"ion-item",8)(13,"ion-label")(14,"p",10),I._uU(15),I.ALo(16,"translate"),I.qZA(),I.YNc(17,AddonCompetencyCompetencyPage_ion_card_13_p_17_Template,3,3,"p",2)(18,AddonCompetencyCompetencyPage_ion_card_13_ng_container_18_Template,2,1,"ng-container",2),I.qZA()(),I.YNc(19,AddonCompetencyCompetencyPage_ion_card_13_ion_item_19_Template,7,5,"ion-item",11)(20,AddonCompetencyCompetencyPage_ion_card_13_ng_container_20_Template,16,10,"ng-container",2),I.qZA()),2&e){const e=I.oxw();I.xp6(),I.Q6J("ngIf",e.competency.competency.competency.description),I.xp6(4),I.Oqu(I.lcZ(6,10,"addon.competency.path")),I.xp6(3),I.Q6J("ngIf",e.competency.competency.comppath.showlinks),I.xp6(),I.Q6J("ngIf",!e.competency.competency.comppath.showlinks),I.xp6(2),I.Q6J("ngForOf",e.competency.competency.comppath.ancestors),I.xp6(4),I.Oqu(I.lcZ(16,12,"addon.competency.crossreferencedcompetencies")),I.xp6(2),I.Q6J("ngIf",!e.competency.competency.hasrelatedcompetencies),I.xp6(),I.Q6J("ngIf",e.competency.competency.hasrelatedcompetencies),I.xp6(),I.Q6J("ngIf",e.coursemodules),I.xp6(),I.Q6J("ngIf",e.userCompetency)}}function AddonCompetencyCompetencyPage_div_14_p_4_Template(e,t){1&e&&(I.TgZ(0,"p",28),I._uU(1),I.ALo(2,"translate"),I.qZA()),2&e&&(I.xp6(),I.hij(" ",I.lcZ(2,1,"addon.competency.noevidence")," "))}function AddonCompetencyCompetencyPage_div_14_ion_card_5_ion_item_1_Template(e,t){if(1&e&&(I.TgZ(0,"ion-item",33),I._UZ(1,"core-user-avatar",34),I.TgZ(2,"ion-label")(3,"p",10),I._uU(4),I.qZA(),I.TgZ(5,"p"),I._uU(6),I.ALo(7,"coreFormatDate"),I.qZA()()()),2&e){const e=I.oxw().$implicit,t=I.oxw(2);I.Q6J("userId",e.actionuser.id)("courseId",t.courseId),I.xp6(),I.Q6J("user",e.actionuser)("linkProfile",!1),I.xp6(3),I.Oqu(e.actionuser.fullname),I.xp6(2),I.Oqu(I.lcZ(7,6,1e3*e.timemodified))}}function AddonCompetencyCompetencyPage_div_14_ion_card_5_p_7_Template(e,t){if(1&e&&(I.TgZ(0,"p",35),I._uU(1),I.qZA()),2&e){const e=I.oxw().$implicit;I.xp6(),I.Oqu(e.description)}}function AddonCompetencyCompetencyPage_div_14_ion_card_5_blockquote_8_Template(e,t){if(1&e&&(I.TgZ(0,"blockquote"),I._uU(1),I.qZA()),2&e){const e=I.oxw().$implicit;I.xp6(),I.Oqu(e.note)}}function AddonCompetencyCompetencyPage_div_14_ion_card_5_Template(e,t){if(1&e&&(I.TgZ(0,"ion-card"),I.YNc(1,AddonCompetencyCompetencyPage_div_14_ion_card_5_ion_item_1_Template,8,8,"ion-item",30),I.TgZ(2,"ion-item",8)(3,"ion-label")(4,"p")(5,"ion-badge",31),I._uU(6),I.qZA()(),I.YNc(7,AddonCompetencyCompetencyPage_div_14_ion_card_5_p_7_Template,2,1,"p",32)(8,AddonCompetencyCompetencyPage_div_14_ion_card_5_blockquote_8_Template,2,1,"blockquote",2),I.qZA()()()),2&e){const e=t.$implicit;I.xp6(),I.Q6J("ngIf",e.actionuser),I.xp6(5),I.Oqu(e.gradename),I.xp6(),I.Q6J("ngIf",e.description),I.xp6(),I.Q6J("ngIf",e.note)}}function AddonCompetencyCompetencyPage_div_14_Template(e,t){if(1&e&&(I.TgZ(0,"div")(1,"h2",28),I._uU(2),I.ALo(3,"translate"),I.qZA(),I.YNc(4,AddonCompetencyCompetencyPage_div_14_p_4_Template,3,3,"p",29)(5,AddonCompetencyCompetencyPage_div_14_ion_card_5_Template,9,4,"ion-card",14),I.qZA()),2&e){const e=I.oxw();I.xp6(2),I.Oqu(I.lcZ(3,3,"addon.competency.evidence")),I.xp6(2),I.Q6J("ngIf",0===e.competency.evidence.length),I.xp6(),I.Q6J("ngForOf",e.competency.evidence)}}let J=(()=>{var e;class AddonCompetencyCompetencyPage{constructor(){this.competencyLoaded=!1,this.logView=C.V.once((()=>this.performLogView()));try{const e=m.b.getRouteNumberParam("planId");if(!e){const e=m.b.getRequiredRouteNumberParam("courseId"),t=m.b.getRouteNumberParam("userId"),n=l.p.getOrCreateSource(g.f,[e,t]);return this.competencies=new AddonCompetencyCompetenciesSwipeManager(n),void 0}const t=l.p.getOrCreateSource(u.R,[e]);this.competencies=new AddonCompetencyCompetenciesSwipeManager(t)}catch(e){return r.OQ.showErrorModal(e),m.b.back(),void 0}}get competencyFrameworkUrl(){if(!this.competency)return;const{pluginbaseurl:e,framework:t,pagecontextid:n}=this.competency.competency.comppath;return`${e}/competencies.php?competencyframeworkid=${t.id}&pagecontextid=${n}`}get courseId(){const e=this.competencies.getSource();if(e instanceof g.f)return e.COURSE_ID}ngOnInit(){var e=this;return(0,o.Z)((function*(){try{const t=e.competencies.getSource();yield t.reload(),yield e.competencies.start(),yield e.fetchCompetency()}finally{e.competencyLoaded=!0}}))()}ngOnDestroy(){this.competencies.destroy()}fetchCompetency(){var e=this;return(0,o.Z)((function*(){try{const t=e.competencies.getSource();e.competency=t instanceof u.R?yield e.fetchCompetencySummaryFromPlan(t):yield e.fetchCompetencySummaryFromCourse(t),e.competency.user.id!=i.m9.getCurrentSiteUserId()&&(e.user=e.competency.user),e.competency.evidence.forEach((e=>{if(e.descidentifier){e.description=a.vN.instant("addon.competency."+e.descidentifier,{$a:e.desca})}})),e.logView()}catch(e){r.OQ.showErrorModalDefault(e,"Error getting competency data.")}}))()}refreshCompetency(e){var t=this;return(0,o.Z)((function*(){const n=t.competencies.getSource();yield d.Tr.ignoreErrors(n instanceof u.R?p.M.invalidateCompetencyInPlan(n.PLAN_ID,t.requireCompetencyId()):p.M.invalidateCompetencyInCourse(n.COURSE_ID,t.requireCompetencyId(),n.USER_ID)),t.fetchCompetency().finally((()=>{null==e||e.complete()}))}))()}openCompetencySummary(e){m.b.navigate(`../${e}/${s.eC}`,{params:{contextLevel:this.contextLevel,contextInstanceId:this.contextInstanceId}})}requireCompetencyId(){const e=this.competencies.getSelectedItem();if(!e)throw new Error("Failed to get competency id from selected item");return e.competency.id}fetchCompetencySummaryFromPlan(e){var t=this;return(0,o.Z)((function*(){var n;const o=yield p.M.getCompetencyInPlan(e.PLAN_ID,t.requireCompetencyId());return t.planStatus=o.plan.status,o.usercompetencysummary.usercompetency&&(o.usercompetencysummary.usercompetency.statusname=c.Y.getCompetencyStatusName(o.usercompetencysummary.usercompetency.status)),t.contextLevel="user",t.contextInstanceId=(null===(n=e.user)||void 0===n?void 0:n.id)||o.usercompetencysummary.user.id,t.userCompetency=o.usercompetencysummary.usercompetencyplan||o.usercompetencysummary.usercompetency,o.usercompetencysummary}))()}fetchCompetencySummaryFromCourse(e){var t=this;return(0,o.Z)((function*(){const n=yield p.M.getCompetencyInCourse(e.COURSE_ID,t.requireCompetencyId(),e.USER_ID);return t.coursemodules=n.coursemodules,t.contextLevel="course",t.contextInstanceId=e.COURSE_ID,t.userCompetency=n.usercompetencysummary.usercompetencycourse||n.usercompetencysummary.usercompetency,n.usercompetencysummary}))()}performLogView(){var e=this;return(0,o.Z)((function*(){var t;if(!e.competency)return;const n=e.competencies.getSource(),o=e.requireCompetencyId(),c=e.competency.competency.competency.shortname,i=null===(t=n.user)||void 0===t?void 0:t.id;if(n instanceof u.R){if(!e.planStatus)return;yield d.Tr.ignoreErrors(p.M.logCompetencyInPlanView(n.PLAN_ID,o,e.planStatus,c,i));return f.ke.logEvent({type:f.gM.VIEW_ITEM,ws:e.planStatus===p.g.STATUS_COMPLETE?"core_competency_user_competency_plan_viewed":"core_competency_user_competency_viewed_in_plan",name:c,data:{id:o,category:"competency",planid:n.PLAN_ID,planstatus:e.planStatus,userid:i},url:x.T.addParamsToUrl("/admin/tool/lp/user_competency_in_plan.php",{planid:n.PLAN_ID,userid:i,competencyid:o})}),void 0}yield d.Tr.ignoreErrors(p.M.logCompetencyInCourseView(n.COURSE_ID,o,c,n.USER_ID)),f.ke.logEvent({type:f.gM.VIEW_ITEM,ws:"core_competency_user_competency_viewed_in_course",name:c,data:{id:o,category:"competency",courseid:n.COURSE_ID,userid:i},url:x.T.addParamsToUrl("/admin/tool/lp/user_competency_in_course.php",{courseid:n.COURSE_ID,competencyid:o,userid:i})})}))()}}return(e=AddonCompetencyCompetencyPage).ɵfac=function AddonCompetencyCompetencyPage_Factory(t){return new(t||e)},e.ɵcmp=I.Xpm({type:e,selectors:[["page-addon-competency-competency"]],decls:15,vars:13,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[1,"limited-width",3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[3,"text","contextLevel","contextInstanceId"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap","only-links"],["core-link","",3,"href",4,"ngIf"],[4,"ngFor","ngForOf"],["core-link","",3,"href"],["class","as-link",3,"click",4,"ngIf"],[1,"as-link",3,"click"],["class","ion-text-wrap","core-link","","capture","true",3,"href",4,"ngFor","ngForOf"],["core-link","","capture","true",1,"ion-text-wrap",3,"href"],["slot","start",3,"modicon","showAlt",4,"ngIf"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","start",3,"modicon","showAlt"],["slot","end","color","success",4,"ngIf"],["slot","end","color","danger",4,"ngIf"],["color","dark","slot","end"],["slot","end","color","success"],["slot","end","color","danger"],[1,"ion-margin-horizontal"],["class","ion-margin-horizontal",4,"ngIf"],["class","ion-text-wrap","core-user-link","",3,"userId","courseId",4,"ngIf"],["color","dark"],["class","ion-margin-top",4,"ngIf"],["core-user-link","",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","linkProfile"],[1,"ion-margin-top"]],template:function AddonCompetencyCompetencyPage_Template(e,t){1&e&&(I.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),I._UZ(3,"ion-back-button",1),I.ALo(4,"translate"),I.qZA(),I.TgZ(5,"ion-title"),I.YNc(6,AddonCompetencyCompetencyPage_h1_6_Template,4,4,"h1",2),I.qZA()()(),I.TgZ(7,"ion-content",3)(8,"ion-refresher",4),I.NdJ("ionRefresh",(function AddonCompetencyCompetencyPage_Template_ion_refresher_ionRefresh_8_listener(e){return t.refreshCompetency(e.target)})),I._UZ(9,"ion-refresher-content",5),I.ALo(10,"translate"),I.qZA(),I.TgZ(11,"core-loading",6),I.YNc(12,AddonCompetencyCompetencyPage_ion_card_12_Template,6,2,"ion-card",2)(13,AddonCompetencyCompetencyPage_ion_card_13_Template,21,14,"ion-card",2)(14,AddonCompetencyCompetencyPage_div_14_Template,6,5,"div",2),I.qZA()()),2&e&&(I.xp6(3),I.Q6J("text",I.lcZ(4,9,"core.back")),I.xp6(3),I.Q6J("ngIf",t.competency),I.xp6(),I.Q6J("core-swipe-navigation",t.competencies),I.xp6(),I.Q6J("disabled",!t.competencyLoaded),I.xp6(),I.s9C("pullingText",I.lcZ(10,11,"core.pulltorefresh")),I.xp6(2),I.Q6J("hideUntil",t.competencyLoaded),I.xp6(),I.Q6J("ngIf",t.user),I.xp6(),I.Q6J("ngIf",t.competency),I.xp6(),I.Q6J("ngIf",t.competency))},dependencies:[h.sg,h.O5,A.r,Z.o,v.X,T.r,P.y,w.j,b.g,S.t,L.yp,L.Sm,L.PM,L.W2,L.Gu,L.Ie,L.Q$,L.nJ,L.Wo,L.wd,L.sr,L.oU,U.o,q.X$],encapsulation:2}),AddonCompetencyCompetencyPage})();class AddonCompetencyCompetenciesSwipeManager extends _.t{getSelectedItemPathFromRoute(e){return(e instanceof y.De?e:e.snapshot).params.competencyId}}},51368:(e,t,n)=>{n.d(t,{$:()=>r});var o=n(13386),c=n(99178),i=n(19212);let r=(()=>{var e;class AddonCompetencyCompetencySummaryPageModule{}return(e=AddonCompetencyCompetencySummaryPageModule).ɵfac=function AddonCompetencyCompetencySummaryPageModule_Factory(t){return new(t||e)},e.ɵmod=i.oAB({type:e}),e.ɵinj=i.cJS({imports:[o.L]}),AddonCompetencyCompetencySummaryPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&i.kYT(r,{declarations:[c.d],imports:[o.L]}))},99178:(e,t,n)=>{n.d(t,{d:()=>f});var o=n(49671),c=n(71178),i=n(43555),r=n(13010),a=n(75803),p=n(96092),m=n(88817),d=n(43468),s=n(19212),_=n(96814),l=n(66931),u=n(8947),y=n(29657),g=n(31903),C=n(89515);function AddonCompetencyCompetencySummaryPage_h1_6_Template(e,t){if(1&e&&(s.TgZ(0,"h1"),s._UZ(1,"core-format-text",7),s.TgZ(2,"small"),s._uU(3),s.qZA()()),2&e){const e=s.oxw();s.xp6(),s.Q6J("text",e.competency.competency.shortname)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId),s.xp6(2),s.Oqu(e.competency.competency.idnumber)}}function AddonCompetencyCompetencySummaryPage_ion_card_12_ion_item_1_Template(e,t){if(1&e&&(s.TgZ(0,"ion-item",9)(1,"ion-label"),s._UZ(2,"core-format-text",7),s.qZA()()),2&e){const e=s.oxw(2);s.xp6(2),s.Q6J("text",e.competency.competency.description)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId)}}function AddonCompetencyCompetencySummaryPage_ion_card_12_ng_container_9_Template(e,t){if(1&e){const e=s.EpF();s.ynx(0),s._uU(1,"  /  "),s.TgZ(2,"button",12),s.NdJ("click",(function AddonCompetencyCompetencySummaryPage_ion_card_12_ng_container_9_Template_button_click_2_listener(){const t=s.CHM(e).$implicit,n=s.oxw(2);return s.KtG(n.openCompetencySummary(t.id))})),s._UZ(3,"core-format-text",7),s.qZA(),s.BQk()}if(2&e){const e=t.$implicit,n=s.oxw(2);s.xp6(3),s.Q6J("text",e.name)("contextLevel",n.contextLevel)("contextInstanceId",n.contextInstanceId)}}function AddonCompetencyCompetencySummaryPage_ion_card_12_Template(e,t){if(1&e&&(s.TgZ(0,"ion-card"),s.YNc(1,AddonCompetencyCompetencySummaryPage_ion_card_12_ion_item_1_Template,3,3,"ion-item",8),s.TgZ(2,"ion-item",9)(3,"ion-label")(4,"p",10),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"p"),s._UZ(8,"core-format-text",7),s.YNc(9,AddonCompetencyCompetencySummaryPage_ion_card_12_ng_container_9_Template,4,3,"ng-container",11),s.qZA()()()()),2&e){const e=s.oxw();s.xp6(),s.Q6J("ngIf",e.competency.competency.description),s.xp6(4),s.Oqu(s.lcZ(6,6,"addon.competency.path")),s.xp6(3),s.Q6J("text",e.competency.comppath.framework.name)("contextLevel",e.contextLevel)("contextInstanceId",e.contextInstanceId),s.xp6(),s.Q6J("ngForOf",e.competency.comppath.ancestors)}}let f=(()=>{var e;class AddonCompetencyCompetencySummaryPage{constructor(){var e=this;this.competencyLoaded=!1,this.logView=m.V.once((0,o.Z)((function*(){e.competency&&(yield a.Tr.ignoreErrors(c.M.logCompetencyView(e.competencyId,e.competency.competency.shortname)),d.ke.logEvent({type:d.gM.VIEW_ITEM_LIST,ws:"core_competency_competency_viewed",name:e.competency.competency.shortname,data:{competencyId:e.competencyId,category:"competency"},url:`/admin/tool/lp/user_competency.php?id=${e.competencyId}`}))})))}ngOnInit(){var e=this;return(0,o.Z)((function*(){try{e.competencyId=i.b.getRequiredRouteNumberParam("competencyId"),e.contextLevel=i.b.getRouteParam("contextLevel"),e.contextInstanceId=i.b.getRouteNumberParam("contextInstanceId")}catch(e){return r.OQ.showErrorModal(e),i.b.back(),void 0}try{yield e.fetchCompetency()}finally{e.competencyLoaded=!0}}))()}fetchCompetency(){var e=this;return(0,o.Z)((function*(){try{const n=yield c.M.getCompetencySummary(e.competencyId);var t;if(!e.contextLevel||void 0===e.contextInstanceId)e.contextLevel="user",e.contextInstanceId=null===(t=n.usercompetency)||void 0===t?void 0:t.userid;e.competency=n.competency,e.logView()}catch(e){r.OQ.showErrorModalDefault(e,"Error getting competency summary data.")}}))()}refreshCompetency(e){c.M.invalidateCompetencySummary(this.competencyId).finally((()=>{this.fetchCompetency().finally((()=>{null==e||e.complete()}))}))}openCompetencySummary(e){i.b.navigate(`../../${e}/${p.eC}`,{params:{contextLevel:this.contextLevel,contextInstanceId:this.contextInstanceId}})}}return(e=AddonCompetencyCompetencySummaryPage).ɵfac=function AddonCompetencyCompetencySummaryPage_Factory(t){return new(t||e)},e.ɵcmp=s.Xpm({type:e,selectors:[["page-addon-competency-competency-summary"]],decls:13,vars:10,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[3,"text","contextLevel","contextInstanceId"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],[1,"item-heading"],[4,"ngFor","ngForOf"],[1,"as-link",3,"click"]],template:function AddonCompetencyCompetencySummaryPage_Template(e,t){1&e&&(s.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),s._UZ(3,"ion-back-button",1),s.ALo(4,"translate"),s.qZA(),s.TgZ(5,"ion-title"),s.YNc(6,AddonCompetencyCompetencySummaryPage_h1_6_Template,4,4,"h1",2),s.qZA()()(),s.TgZ(7,"ion-content",3)(8,"ion-refresher",4),s.NdJ("ionRefresh",(function AddonCompetencyCompetencySummaryPage_Template_ion_refresher_ionRefresh_8_listener(e){return t.refreshCompetency(e.target)})),s._UZ(9,"ion-refresher-content",5),s.ALo(10,"translate"),s.qZA(),s.TgZ(11,"core-loading",6),s.YNc(12,AddonCompetencyCompetencySummaryPage_ion_card_12_Template,10,8,"ion-card",2),s.qZA()()),2&e&&(s.xp6(3),s.Q6J("text",s.lcZ(4,6,"core.back")),s.xp6(3),s.Q6J("ngIf",t.competency),s.xp6(2),s.Q6J("disabled",!t.competencyLoaded),s.xp6(),s.s9C("pullingText",s.lcZ(10,8,"core.pulltorefresh")),s.xp6(2),s.Q6J("hideUntil",t.competencyLoaded),s.xp6(),s.Q6J("ngIf",t.competency))},dependencies:[_.sg,_.O5,l.r,u.r,y.t,g.Sm,g.PM,g.W2,g.Gu,g.Ie,g.Q$,g.nJ,g.Wo,g.wd,g.sr,g.oU,C.X$],encapsulation:2}),AddonCompetencyCompetencySummaryPage})()},71460:(e,t,n)=>{n.d(t,{t:()=>CoreSwipeNavigationItemsManager});var o=n(49671),c=n(67643),i=n(43555),r=n(22594);class CoreSwipeNavigationItemsManager extends r.A{start(){var e=this;return(0,o.Z)((function*(){e.updateSelectedItem()}))()}navigateToNextItem(){var e=this;return(0,o.Z)((function*(){yield e.navigateToItemBy(1,"forward")}))()}navigateToPreviousItem(){var e=this;return(0,o.Z)((function*(){yield e.navigateToItemBy(-1,"back")}))()}hasNextItem(){var e=this;return(0,o.Z)((function*(){return!!(yield e.getItemBy(1))}))()}hasPreviousItem(){var e=this;return(0,o.Z)((function*(){return!!(yield e.getItemBy(-1))}))()}getCurrentPageRoute(){return i.b.getCurrentRoute()}getSelectedItemPathFromRoute(e){const t=[];for(;e;){if(t.push(...(e instanceof c.De?e:e.snapshot).url),!e.firstChild)break;e=e.firstChild}return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,t){var n=this;return(0,o.Z)((function*(){const o=yield n.getItemBy(e);o&&(yield n.navigateToItem(o,{animationDirection:t,replace:!0}))}))()}getItemBy(e){var t=this;return(0,o.Z)((function*(){var n;const o=t.getSource().getItems(),c=null!==(n=t.selectedItem&&(null==o?void 0:o.indexOf(t.selectedItem)))&&void 0!==n?n:-1;if(-1===c||null===o)return null;const i=e>0?1:-1;let r=c,a=0;for(;a!==e;){if(r+=i,r<0)return null;if(r>=o.length)break;t.skipItemInSwipe(o[r])||(a+=i)}return a===e?o[r]:t.getSource().isCompleted()?null:(yield t.getSource().load(),t.getItemBy(e))}))()}skipItemInSwipe(e){return!1}}}}]);